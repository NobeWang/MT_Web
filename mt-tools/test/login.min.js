var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function s(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,i=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(r){n=[6,r],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._eventDic={},e._notifyDic={},e._unpackDic={},e._unpackDynamic={},e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.onCreationComplete,e),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.addedToStage,e),e}return __extends(n,t),n.prototype.onCreationComplete=function(e){this.initComponent(),this.isSkinLoaded=!0,this.initListener(),this.initData(),this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreationComplete,this)},n.prototype.initUnpackRes=function(e){var t=this,n=e.numChildren;e instanceof eui.Component&&e.skin instanceof eui.Skin&&t.initStatesUnpackRes(e.skin,e);for(var r=0;n>r;r++){var o=e.getChildAt(r);if(o instanceof egret.DisplayObjectContainer)t.initUnpackRes(o);else if(o instanceof eui.Image){var i=o.source;if("string"==typeof i&&""!=i){var a=RES.getResourceInfo(i);a&&"unpack"==a.url.substr(0,6)&&t.addUnpackRef(i,o)}}}},n.prototype.initStatesUnpackRes=function(e,t){for(var n=this,r=e.currentState,o=0,i=e.states;o<i.length;o++){var a=i[o];if(a.name!=r)for(var s=0,l=a.overrides;s<l.length;s++){var c=l[s];if(c instanceof eui.SetProperty){if("source"==c.name){var u=c.value;if("string"==typeof u&&""!=u){var f=RES.getResourceInfo(u);if(f&&"unpack"==f.url.substr(0,6)){var p=t[c.target];p instanceof eui.Image&&n.addUnpackRef(u,p)}}}}else if(c instanceof eui.AddItems){var g=t[c.target];if(g||(g=e[c.target]),g instanceof eui.Image){var u=g.source;if("string"==typeof u&&""!=u){var f=RES.getResourceInfo(u);f&&"unpack"==f.url.substr(0,6)&&n.addUnpackRef(u,g)}}}}}},n.prototype.addUnpackRef=function(e,t){var n=this,r=n._unpackDic[e];r?r.push(t):n._unpackDic[e]=[t]},n.prototype.addedToStage=function(e){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},n.prototype.removeFromStage=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},n.prototype.initComponent=function(){},n.prototype.initData=function(){this.onStageResize();var t=this._unpackDic;for(var n in t){if(!RES.getRes(n)){var r=t[n];if(r)for(var o=0,i=r;o<i.length;o++){var a=i[o];a.source=null,a.source=n}}e.LoaderManager.instance.addGroupRef(n)}},Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),n.prototype.initListener=function(){},n.prototype.onStageResize=function(){},n.prototype.registerNotify=function(t,n,r){void 0===r&&(r=null),r=r?r:this,this._notifyDic[t]={callBack:n,thisObject:r},e.NotifyManager.registerNotify(t,n,r)},n.prototype.unRegisterNotify=function(t,n,r){void 0===r&&(r=null),r=r?r:this;var o=this._notifyDic[t];o&&o.callback==n&&o.thisObject==r&&delete this._notifyDic[t],e.NotifyManager.unRegisterNotify(t,n,r)},n.prototype.unRegisterAllNotify=function(){var t,n=this._notifyDic;for(var r in n)t=n[r],t&&e.NotifyManager.unRegisterNotify(r,t.callBack,t.thisObject),delete n[r];this._notifyDic={}},n.prototype.dispatch=function(t,n){void 0===n&&(n=null),e.NotifyManager.sendNotification(t,n)},n.prototype.addEvent=function(e,t,n,r){void 0===r&&(r=null),r=r?r:this;var o={};o.target=e,o.type=t,o.callBack=n,o.thisObject=r,e&&(e.addEventListener(t,n,r),this._eventDic[e.hashCode+t]=o)},n.prototype.addClickEvent=function(e,t,n){void 0===n&&(n=null);var r=this,o=r._eventDic,i=1,a=1;if(n=n?n:r,e instanceof eui.Group&&(e.touchChildren=!1),e instanceof egret.DisplayObject){if(0==e.anchorOffsetX&&0==e.anchorOffsetY){var s=e.width/2,l=e.height/2;e.anchorOffsetX=s,e.anchorOffsetY=l,e.x+=s,e.y+=l}i=e.scaleX,a=e.scaleY}var c={};c.target=e,c.scaleX=i,c.scaleY=a,c.type=egret.TouchEvent.TOUCH_BEGIN,c.thisObject=n,c.callFunc=r.onTouchBegin,c.thisCall=r,e&&(e.addEventListener(c.type,r.onTouchBegin,r),o[e.hashCode+c.type]=c);var u={};u.target=e,u.scaleX=i,u.scaleY=a,u.type=egret.TouchEvent.TOUCH_END,u.callBack=t,u.thisObject=n,u.callFunc=r.onTouchEnd,u.thisCall=r,e&&(e.addEventListener(u.type,r.onTouchEnd,r),o[e.hashCode+u.type]=u);var f={};f.target=e,f.scaleX=i,f.scaleY=a,f.type=egret.TouchEvent.TOUCH_TAP,f.callBack=t,f.thisObject=n,f.callFunc=r.onTouchEnd,f.thisCall=r,e&&(e.addEventListener(f.type,r.onTouchEnd,r),o[e.hashCode+f.type]=f);var p={};p.target=e,p.scaleX=i,p.scaleY=a,p.type=egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,p.thisObject=n,p.callFunc=r.onTouchReleaseOutSide,p.thisCall=r,e&&(e.addEventListener(p.type,r.onTouchReleaseOutSide,r),o[e.hashCode+p.type]=p);var g={};g.target=e,g.scaleX=i,g.scaleY=a,g.type=egret.TouchEvent.TOUCH_CANCEL,g.thisObject=n,g.callFunc=r.onTouchReleaseOutSide,g.thisCall=r,e&&(e.addEventListener(g.type,r.onTouchReleaseOutSide,r),o[e.hashCode+g.type]=p)},n.prototype.onTouchBegin=function(e){var t=e.target,n=t.hashCode,r=this._eventDic[n+e.type];this._touchBeginTaret=t,egret.Tween.removeTweens(t),egret.Tween.get(t).to({scaleX:.9*r.scaleX,scaleY:.9*r.scaleY},50),this.loadAndPlayEffect("SOUND_DIANJI")},n.prototype.onTouchEnd=function(e){var t=this,n=e.target,r=t._eventDic;if(t._touchBeginTaret==n){t._touchBeginTaret=null;var o=r[n.hashCode+e.type],i=o.scaleX,a=o.scaleY;egret.Tween.get(n).to({scaleX:i,scaleY:a},50).call(function(){for(var e in r){var t=r[e];t.target==n&&t.type==egret.TouchEvent.TOUCH_END&&t.callBack.call(t.thisObject,n)}},t)}},n.prototype.onTouchReleaseOutSide=function(e){var t=this;if(t._touchBeginTaret==e.target){t._touchBeginTaret=null;var n=t._eventDic[e.target.hashCode+e.type];n&&(e.target.scaleX=n.scaleX,e.target.scaleY=n.scaleY)}},n.prototype.removeAllEvent=function(){var e,t,n=this._eventDic;for(var r in n)e=n[r],t=e.target,null!=t&&(e.type!=egret.TouchEvent.TOUCH_TAP||t instanceof egret.Stage||(void 0!=e.scaleX&&(t.scaleX=e.scaleX),void 0!=e.scaleY&&(t.scaleY=e.scaleY)),t.removeEventListener(e.type,e.callBack,e.thisObject),t.removeEventListener(e.type,e.callFunc,e.thisCall)),delete n[r];this._eventDic={}},n.prototype.updateTitle=function(t,n){t||n>0?e.NotifyManager.sendNotification(e.NotifyConstLogin.UPDATE_MODULE_TITLE,{title:t,ruleId:n}):t||void 0!=n||e.NotifyManager.sendNotification(e.NotifyConstLogin.UPDATE_MODULE_TITLE,{ruleId:0})},n.prototype.loadAndPlayEffect=function(t,n,r){void 0===n&&(n=1),void 0===r&&(r=!1),e.SoundManager.getInstance().loadAndPlayEffect(t,n,r)},n.prototype.stopSoundEffect=function(t){e.SoundManager.getInstance().stopSoundEffect(t)},n.prototype.addUnpackRes=function(t){var n=this._unpackDynamic;if("string"==typeof t)n[t]||(n[t]=!0,e.LoaderManager.instance.addGroupRef(t));else for(var r=0,o=t;r<o.length;r++){var i=o[r];n[i]||(n[i]=!0,e.LoaderManager.instance.addGroupRef(i))}},n.prototype.destoryUnpackRes=function(){for(var t in this._unpackDic)e.LoaderManager.instance.destoryGroup(t);for(var t in this._unpackDynamic)e.LoaderManager.instance.destoryGroup(t);this._unpackDynamic={}},n.prototype.dispose=function(t){void 0===t&&(t=!1);var n=this;n.destoryUnpackRes(),n.removeAllEvent(),n.unRegisterAllNotify(),n._touchBeginTaret=null,n._data=null,n.parent&&n.parent.removeChild(n),e.ModuleManager.openPanelFromBattle&&(e.ModuleManager.openPanelFromBattle=!1)},n}(eui.Component);e.UIComponent=t,__reflect(t.prototype,"qmr.UIComponent")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.isClickHide=!0,e.isNeedMask=!1,e.isNeedAlpha0Mask=!1,e.isPopupEffect=!1,e.isCenter=!1,e.needAdaptStatusBar=!0,e._isShow=!1,e.offsetY=0,e}return __extends(n,t),Object.defineProperty(n.prototype,"groupName",{get:function(){return this._groupName},set:function(e){this._groupName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"qmrSkinName",{set:function(e){this._qmrSkinName=e},enumerable:!0,configurable:!0}),n.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.resetPos(),this.initUnpackRes(this)},n.prototype.updateGuide=function(){},n.prototype.resetPos=function(){(this.isPopupEffect||this.isCenter)&&(this.anchorOffsetX=this.width>>1,this.anchorOffsetY=(this.height>>1)+this.offsetY,this.x=e.StageUtil.stageWidth>>1,this.y=e.StageUtil.stageHeight>>1)},n.prototype.initListener=function(){var n=this;n.numChildren>0,n.registerNotify(e.StageUtil.STAGE_RESIZE,n.onStageResize,n),t.prototype.initListener.call(this)},n.prototype.getEffective=function(e,t){var n=this;return n._groupName&&e-n.useTime>=t?!1:!0},n.prototype.onPageBgCloseView=function(){this.hide()},n.prototype.addedToStage=function(e){t.prototype.addedToStage.call(this,e),egret.callLater(this.popupEffect,this)},n.prototype.onStageResize=function(t){var n=this;n.isPopupEffect||n.isCenter||(n.width=e.StageUtil.stageWidth,e.StageUtil.stageHeight>1400&&n.needAdaptStatusBar?(n.height=e.StageUtil.stageHeight-50,n.y=50):(n.height=e.StageUtil.stageHeight,n.y=0)),n.resetPos(),n.layout(),n.maskSprite&&n.maskSprite.onStageResize()},n.prototype.show=function(e){var t=this;t.data=e,t.isSkinLoaded?(t.initListener(),egret.callLater(t.initData,t)):t._qmrSkinName&&(t.skinName=t._qmrSkinName),t.isShow=!0},Object.defineProperty(n.prototype,"isShow",{get:function(){return this._isShow},set:function(e){this._isShow=e},enumerable:!0,configurable:!0}),n.prototype.layout=function(){},n.prototype.getComponentGlobalPoint=function(e){var t=this[e];return t?t.parent?t.parent.localToGlobal(t.x,t.y):t.localToGlobal(t.x,t.y):{x:0,y:0}},n.prototype.hide=function(){this.isPopupEffect?this.closeEffect():e.ModuleManager.hideModule(this)},n.prototype.popupEffect=function(){var t=this;if(t.isPopupEffect){t.alpha=.2,t.scaleX=.2,t.scaleY=.2;var n,r;t.openPos?(n=t.openPos.x,r=t.openPos.y):(n=e.StageUtil.stageWidth>>1,r=e.StageUtil.stageHeight>>1),egret.Tween.get(t).to({scaleX:1,scaleY:1,alpha:1,x:n,y:r},200,egret.Ease.backOut).call(t.doOpenOver,t)}},n.prototype.closeEffect=function(){var t=0,n=0;this._closePos?(t=this._closePos.x,n=this._closePos.y):(t=e.StageUtil.stageWidth>>1,n=e.StageUtil.stageHeight>>1),egret.Tween.get(this).to({scaleX:.3,scaleY:.3,alpha:0,x:t,y:n},180,egret.Ease.cubicOut).call(this.doCloseOver,this)},n.prototype.doOpenOver=function(){},n.prototype.doCloseOver=function(){e.ModuleManager.hideModule(this)},Object.defineProperty(n.prototype,"closePos",{get:function(){return this._closePos},set:function(e){this._closePos=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"openPos",{get:function(){return this._openPos},set:function(e){this._openPos=e},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){t.prototype.dispose.call(this),this.isShow=!1,this.title&&this.updateTitle("",0);var n=this.groupName;void 0!=n&&""!=n&&e.LoaderManager.instance.destoryGroup(n)},n.prototype.closeView=function(){e.ModuleManager.hideModule(this)},n}(e.UIComponent);e.SuperBaseModule=t,__reflect(t.prototype,"qmr.SuperBaseModule")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.ltServerDomain="xyws-sdk.dyhyyx.com",this.initGetOption(),this.initServerUrl()}return t.prototype.reqLogin=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.setLoadingStatus("验证账号..."),console.log("开始平台登录"),[4,this.login()];case 1:return t.sent(),console.log("平台登录完成"),e.PlatformConfig.platformId!=e.PlatformEnum.P_SLOGAME_DEBUG&&e.MarkPointManager.loginBeforeSetPoint(e.PointEnum.SDK_LOGIN),[2]}})})},t.prototype.getPullServerListUrl=function(){var t=this,n=e.PlatformConfig.isTSVersion?1:0,r=e.PlatformConfig.isTSVersion?t.tsServerListServer:t.serverListServer;return r+"?account="+e.GlobalConfig.account+"&ts="+n+"&sid="+e.PlatformConfig.platformId},t.prototype.getCheckAccountValidityUrl=function(t){return __awaiter(this,void 0,void 0,function(){var n,r,o,i,a,s,l,c,u;return __generator(this,function(f){return n=e.GlobalConfig.account,r=e.GlobalConfig.token,o=t/1e3|0,i=o+"",a=e.GlobalConfig.sid,s=0,l=e.Md5Util.getInstance().hex_md5(encodeURI(n)+a+r+i+e.GlobalConfig.loginKey),c=e.WebBrowerUtil.model||"none",u=e.GlobalConfig.uid,[2,this.loginServerUrl+"?account="+n+"&token="+r+"&time="+i+"&serverId="+a+"&unverifysvr="+s+"&sign="+l+"&clientVer="+e.GlobalConfig.appVersion+"&deviceUID="+c]})})},t.prototype.reqPay=function(t){var n=this,r=function(e){console.log("请求充值服生成订单号回包: "+JSON.stringify(e));var r=JSON.parse(e);n.orderResultData=r,r&&0==r.ret&&(n.orderId=r.orderId,console.log("请求充值服生成订单号成功:"+n.orderId),n.pay(t))},o=n.rechargeOrderIdServer+"?account="+e.GlobalConfig.uid+"&serverId="+e.GlobalConfig.sid;console.log("请求充值服生成订单号: "+o),e.HttpRequest.sendGet(o,r,n)},t.prototype.setLoadingProgress=function(e){},t.prototype.logout=function(){},t.prototype.reportRegister=function(){},t.prototype.reportLogin=function(){},t.prototype.reportUpLevel=function(){},t.prototype.reportFightPower=function(e){},t.prototype.shareGame=function(e,t,n){},t.prototype.onShareBack=function(){},t.prototype.share=function(){},t.prototype.addToDesk=function(){},t.prototype.reloadGame=function(t){window.location&&window.location.reload?window.location.reload():e.TipManagerCommon.getInstance().createCommonColorTip("请重启游戏")},t.prototype.setLoadingStatus=function(e){e=e||"";var t=window.showPreLoading;t&&t(e),e||this.firstLoadBgHide||!window.EgretSubPackageLoading||(this.firstLoadBgHide=!0,window.EgretSubPackageLoading.instance.removePreLoading())},t.prototype.chatDataPost=function(e,t,n,r,o,i,a){void 0===i&&(i=""),void 0===a&&(a=0)},t.prototype.initLoginServer=function(){this.loginServer=e.GlobalConfig.loginServer,this.updateLoginServer()},Object.defineProperty(t.prototype,"webSocketProtoco",{get:function(){return"https:"==this.httpProtoco?"wss":"ws"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"markPointPort",{get:function(){return"https:"==this.httpProtoco?2231:2230},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpProtoco",{get:function(){var e=window.location.protocol;return e?e:"https:"},enumerable:!0,configurable:!0}),t.prototype.updateLoginServer=function(){this.loginServerUrl=this.joinParamsURL(e.PlatformUrlConsont.LOGIN_URL,this.loginServer),this.rechargeOrderIdServer=this.joinParamsURL(e.PlatformUrlConsont.ORDER_URL,this.loginServer)},Object.defineProperty(t.prototype,"reqRoute",{get:function(){return"android"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appIdNum",{get:function(){return e.Int64Util.getNumber(e.PlatformConfig.appIdStr)},enumerable:!0,configurable:!0}),t.prototype.initServerUrl=function(){var t=this;t.serverListServer=t.joinParamsURL(e.PlatformUrlConsont.SVRLISTOP_URL),t.lastLoginServerReqUrl=t.joinParamsURL(e.PlatformUrlConsont.LASTLOGIN_URL),t.tsServerListServer=t.joinParamsURL(e.PlatformUrlConsont.SVRLISTOP_URL,e.PlatformConfig.ts_serverDomain),t.tsLastLoginServerReqUrl=t.joinParamsURL(e.PlatformUrlConsont.LASTLOGIN_URL,e.PlatformConfig.ts_serverDomain),t.dirtyWordCheckUrl=t.joinParamsURL(e.PlatformUrlConsont.WORD_URL),t.NoticeUrl=t.joinParamsURL(e.PlatformUrlConsont.NOTICE_URL,e.PlatformConfig.ossDoamin),t.verifyUrl=t.joinParamsURL(e.PlatformUrlConsont.VERIFY_URL),t.initMarkPointUrl()},t.prototype.initMarkPointUrl=function(){this.markPointUrl=this.httpProtoco+"//"+e.PlatformConfig.markPointDomain+":"+this.markPointPort,this.markPointUrlBeforeLogin=this.httpProtoco+"//"+e.PlatformConfig.markPointDomain+":"+this.markPointPort+"/before"},t.prototype.joinParamsURL=function(t,n){void 0===n&&(n="");var r=this,o=this.httpProtoco;""==n&&(n=e.PlatformConfig.serverDomain);var i=r.reqRoute,a=e.StringUtilsBase.getmsg(t,o,n,e.PlatformConfig.platformSign,i);return a},t}();e.BasePlatform=t,__reflect(t.prototype,"qmr.BasePlatform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var r=t.call(this)||this;return r._scale=1,r._offsetX=0,r._offsetY=0,r._effectWidth=0,r.callBack=e,r.thisObject=n,r.isDirLoad=!1,r.actList=[],r.isBody=!1,r.pixelHitTest=!0,r.offsetX=0,r.offsetY=0,r.curFrame=0,r}return __extends(n,t),n.prototype.setIsDirLoad=function(e){this.isDirLoad=e},n.prototype.getIsDirLoad=function(){return this.isDirLoad},n.prototype.setActs=function(e){this.actList=e.split(",")},n.prototype.containsAct=function(e){var t=this.actList;if(0==t.length)return!0;for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o==e)return!0}return!1},n.prototype.load=function(t,n,r){void 0===r&&(r=-1);var o=this,i=e.AnimateManager.getInstance();o.curFrame=0,("168_skill"==n||"168_skill2"==n)&&(n="168_idle"),o.animateData&&o.resName&&i.dispos(o.resName),o.resName=o.isGray?n+"_g":n;var a=i.getAnimalData(o.resName,o.isDirLoad?-1:r);if(a)o.animateData=a,o.callBack&&egret.callLater(o.callBack,o.thisObject,!0,n);else{"20100_idle"==n&&(t=e.PlatformConfig.useCdnRes?e.PlatformConfig.webUrl+"resourceLogin/animation/":"resourceLogin/animation/");var s=function(a){var s=function(e,t){if(e){var s=o.isGray?n+"_g":n;i.parseSpriteSheet(s,t,a,e,r),s==o.resName&&(o.animateData=i.getAnimalData(s,r)),o.callBack&&egret.callLater(o.callBack,o.thisObject,!1,n)}else o.reset()};if(a){var l=a.harf?"_f.png":".png",c=t+(o.isGray?n+"_g"+l:n+l),u=RES.getRes(c);u?(e.LoaderManager.instance.removeGroupRef(c),s(u,c)):e.ResManager.getRes(c,s,o,e.LoadPriority.IMMEDIATELY,RES.ResourceItem.TYPE_IMAGE)}else o.reset()};o.isBody&&(o.texture=RES.getRes("preloading_defaultBody_png"),o.x=-o.texture.textureWidth/2,o.y=-o.texture.textureHeight);var l=t+n+".json",c=RES.getRes(l);c?s(c):e.ResManager.getRes(l,s,o,e.LoadPriority.IMMEDIATELY,RES.ResourceItem.TYPE_JSON)}},n.prototype.reset=function(){this.animateData&&(this.texture=null,this.animateData=null),this.curFrame=0},n.prototype.render=function(e){this.curFrame=e;var t=this,n=t.animateData;if(null!=n){var r=t._scale,o=n.getOffset(e),i=n.getTextureByFrame(e);t.texture=i,o&&(t.x=o.x*r+t._offsetX,t.y=o.y*r+t._offsetY,n.halfTexture?(t.width=o.w,t.height=o.h):i&&(t.width=i.textureWidth,t.height=i.textureHeight)),t._effectWidth>0?n.halfTexture?t.scaleX=t._effectWidth/o.w:t.scaleX=t._effectWidth/i.textureWidth:t.scaleX=t.scaleY=r}},Object.defineProperty(n.prototype,"offsetX",{set:function(e){this._offsetX=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"offsetY",{set:function(e){this._offsetY=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scale",{set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"effectWidth",{get:function(){return this._effectWidth},set:function(e){this._effectWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"firstFrameHeight",{get:function(){var e=this.animateData;return e?e.getTextureByFrame(1).textureHeight:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalFrames",{get:function(){var e=this.animateData;return null!=e?e.totalFrames:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"frameRate",{get:function(){var e=this.animateData;return null!=e?e.frameRate:0},enumerable:!0,configurable:!0}),n.prototype.dispos=function(){var t=this;t.curFrame=0,t.parent&&(t.reset(),e.AnimateManager.getInstance().dispos(t.resName),t.parent.removeChild(t))},n}(egret.Bitmap);e.AnimateClip=t,__reflect(t.prototype,"qmr.AnimateClip")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(e){this.d=e}return e.prototype.merge=function(e,t){if(void 0===t&&(t=1),e&&e.hasOwnProperty("d")){var n=e.d;this.key||(this.key=e.key);var r=this.d;r||(r=new Object,this.d=r);for(var o in n){var i=n[o];"number"==typeof i?(r[o]||(r[o]=0),i||(i=0),r[o]=parseFloat(r[o])+i*t):"string"==typeof i?(r[o]||(r[o]=""),i||(i=""),r[o]=i):"boolean"==typeof i?(i||(i=!1),r[o]=i):r[o]=i}}},e.prototype.setRate=function(e){var t=this.d;for(var n in t){var r=t[n];"number"==typeof r&&(r*=e,t[n]=r)}},e}();e.BaseBean=t,__reflect(t.prototype,"qmr.BaseBean")}(qmr||(qmr={}));var qmr;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.qmrSkinName="LoginViewSkin",t}return __extends(t,e),t}(e.SuperBaseModule);e.LoginViewUI=t,__reflect(t.prototype,"qmr.LoginViewUI")}(qmr||(qmr={}));var qmr;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.qmrSkinName="ServerListViewSkin",t}return __extends(t,e),t}(e.SuperBaseModule);e.ServerListSelectUI=t,__reflect(t.prototype,"qmr.ServerListSelectUI")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.initListeners()}return t.prototype.initListeners=function(){},t.prototype.dispatch=function(t,n){void 0===n&&(n=null),e.NotifyManager.sendNotification(t,n)},t.prototype.registerNotify=function(t,n,r){e.NotifyManager.registerNotify(t,n,r)},t.prototype.unRegisterNotify=function(t,n,r){e.NotifyManager.unRegisterNotify(t,n,r)},t}();e.BaseNotify=t,__reflect(t.prototype,"qmr.BaseNotify")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.initListeners()}return t.prototype.initListeners=function(){},t.prototype.sendCmd=function(t,n,r){void 0===r&&(r=!1),e.Rpc.getInstance().sendCmd(t,n,r)},t.prototype.dispatch=function(t,n){void 0===n&&(n=null),e.NotifyManager.sendNotification(t,n)},t.prototype.registerNotify=function(t,n,r){e.NotifyManager.registerNotify(t,n,r)},t.prototype.unRegisterNotify=function(t,n,r){e.NotifyManager.unRegisterNotify(t,n,r)},t.prototype.rpc=function(t,n,r,o,i,a,s,l){void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=!1),e.Rpc.getInstance().rpcCMD(t,n,r,o,i,a,s,l)},t.prototype.addSocketListener=function(t,n,r,o){void 0===o&&(o=!1),e.Rpc.getInstance().addSocketListener(t,n,r,o)},t.prototype.removeSocketListener=function(t,n,r){e.Rpc.getInstance().removeSocketListener(t,n,r)},t.prototype.loadAndPlayEffect=function(t,n,r){void 0===n&&(n=1),void 0===r&&(r=!1),e.SoundManager.getInstance().loadAndPlayEffect(t,n,r)},t.prototype.checIsLock=function(e){if(!this._reqDic)return!1;var t=this._reqDic.has(e)?this._reqDic.get(e):0,n=egret.getTimer();return t>n},t.prototype.setReqLock=function(t,n){void 0===n&&(n=15e3),this._reqDic||(this._reqDic=new e.Dictionary);var r=egret.getTimer(),o=r+n;this._reqDic.set(t,o)},t.prototype.resetLock=function(){this._reqDic&&this._reqDic.clear()},t.prototype.removeAllListener=function(){this.resetLock()},t}();e.BaseController=t,__reflect(t.prototype,"qmr.BaseController")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this._values=[],this._keys=[]}return Object.defineProperty(e.prototype,"values",{get:function(){return this._values},set:function(e){this._values=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this._keys},set:function(e){this._keys=e},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){var n=this.indexOf(e);return n>=0?void(this._values[n]=t):(this._keys.push(e),void this._values.push(t))},e.prototype.setConf=function(e,t){this._keys.push(e),this._values.push(t)},e.prototype.indexOf=function(e){var t=this._keys.indexOf(e);return t>=0?t:(e=e instanceof String?Number(e):e instanceof Number?e.toString():e,this._keys.indexOf(e))},e.prototype.get=function(e){var t=this.indexOf(e);return 0>t?null:this._values[t]},e.prototype.has=function(e){var t=this.indexOf(e);return t>=0},Object.defineProperty(e.prototype,"length",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.indexOf(e);return t>=0?(this._keys.splice(t,1),this._values.splice(t,1),!0):!1},e.prototype.clear=function(){this._values.length=0,this._keys.length=0},e}();e.Dictionary=t,__reflect(t.prototype,"qmr.Dictionary")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(e,n,r,o){void 0===o&&(o="idle");var i=t.call(this)||this,a=i;return a.resourcePath=e,a.loadCallBack=n,a.loadThisObject=r,a.currentFrame=1,a.totalFrame=0,a.isStopped=!0,a.isDirLoaded=!1,a.isNoRendering=!1,a.passedTime=0,a.lastTime=0,a._timeScale=1,a.act=o,a.frameRate=30,a.eventDic={},a.actDic={},a.partDic={},a.partIdDic={},a.addEventListener(egret.Event.ADDED_TO_STAGE,a.addToStage,a),a.addEventListener(egret.Event.REMOVED_FROM_STAGE,a.removeToStage,a),i}return __extends(n,t),n.prototype.addToStage=function(){this.setIsStopped(!1),this.render()},n.prototype.removeToStage=function(){this.setIsStopped(!0)},Object.defineProperty(n.prototype,"isNoRendering",{get:function(){return this._isNoRendering},set:function(e){this._isNoRendering=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isGray",{get:function(){return this._isGray},set:function(e){this._isGray=e},enumerable:!0,configurable:!0}),n.prototype.setIsDirLoad=function(e){this.isDirLoaded=e;var t=this.partDic;for(var n in t){var r=t[n];r.setIsDirLoad(e)}},n.prototype.addPartAt=function(t,n,r,o,i,a,s){if(void 0===r&&(r=-1),void 0===o&&(o=1),void 0===i&&(i=!1),void 0===a&&(a=null),void 0===s&&(s=!0),n){var l=this;if(l.addPartTo(t,n,r,o,i,a),t==e.ActorPart.BODY&&s){var c=l.partDic[e.ActorPart.DEFAULT];c||(l.addPartTo(e.ActorPart.DEFAULT,168,r,o,i,a),c=l.partDic[e.ActorPart.DEFAULT],c.offsetY=-85)}}},n.prototype.addPartTo=function(t,n,r,o,i,a){void 0===r&&(r=-1),void 0===o&&(o=1),void 0===i&&(i=!1),void 0===a&&(a=null);var s=this,l=s.act,c=s.partDic[t];if(s.partIdDic[t]=n,s.dir=o,c){-1!=r?s.addChildAt(c,r):s.addChild(c),c.setIsDirLoad(i),c.containsAct(l)||(l=t==e.ActorPart.HORSE?e.Status.IDLE_RIDE:e.Status.IDLE);var u=e.ActorPartResourceDic.getInstance().partDic[t];c.isGray=s.isGray,c.load(u?u:s.resourcePath,n+"_"+l,e.DirUtil.getDir(o))}else{c=t==e.ActorPart.BODY?new e.AnimateClip(s.onLoaded,s):t==e.ActorPart.DEFAULT?new e.AnimateClip(s.onLoadedDefault,s):t==e.ActorPart.WING?new e.AnimateWing(s.onLoadedOther,s):new e.AnimateClip(s.onLoadedOther,s),-1!=r?s.addChildAt(c,r):s.addChild(c),c.containsAct(l)||(l=t==e.ActorPart.HORSE?e.Status.IDLE_RIDE:e.Status.IDLE),s.partDic[t]=c;var u=e.ActorPartResourceDic.getInstance().partDic[t];c.isGray=s.isGray,c.load(u?u:s.resourcePath,n+"_"+l,e.DirUtil.getDir(o))}},n.prototype.setPartVisible=function(e,t){var n=this.partDic[e];n.visible=t},n.prototype.removePart=function(e){var t=this.partDic[e];t&&(t.dispos(),delete this.partDic[e],delete this.partIdDic[e])},n.prototype.getPart=function(t){return void 0===t&&(t=e.ActorPart.BODY),this.partDic[t]},n.prototype.setPartActs=function(e,t){var n=this.partDic;for(var r in n)if(parseInt(r)==e){var o=n[e];o&&o.setActs(t)}t.indexOf(",")>-1?this.act=t.split(",")[0]:this.act=t},n.prototype.gotoAndPlay=function(t,n,r,o,i){void 0===r&&(r=null),void 0===o&&(o=null),void 0===i&&(i=!1);var a=this;if(a.loopCallBack=r,a.loopThisObject=o,i||a.act!=t){a.actDic[t]=!1,a.act=t,a.dir=n,a.currentFrame=1;var s=Math.abs(a.scaleX);5>=n?a.scaleX=s:a.scaleX=-s,a.act==e.Status.DEAD&&(n=-1);var l=a.partDic,c=a.partIdDic;a.setIsStopped(!0);for(var u in l){var f=l[u];if(f){var p=a.act;f.containsAct(p)||(p=parseInt(u)==e.ActorPart.HORSE?e.Status.IDLE_RIDE:e.Status.IDLE);var g=e.ActorPartResourceDic.getInstance().partDic[u],d=g?g:a.resourcePath;f.load(d,c[u]+"_"+p,e.DirUtil.getDir(n))}}}},n.prototype.clearCallBack=function(){this.loopCallBack=null},n.prototype.changeDir=function(t){var n=this;if(n.dir!=t){n.dir=t;var r=Math.abs(n.scaleX);5>=t?n.scaleX=r:n.scaleX=-r;var o=n.partDic,i=n.partIdDic;for(var a in o){var s=o[a];if(s){var l=n.act;s.containsAct(l)||(l=parseInt(a)==e.ActorPart.HORSE?e.Status.IDLE_RIDE:e.Status.IDLE);var c=e.ActorPartResourceDic.getInstance().partDic[a],u=c?c:n.resourcePath;s.load(u+i[a]+"/",i[a]+"_"+l,e.DirUtil.getDir(t))}}}},n.prototype.gotoAndStop=function(e){this.currentFrame=e,this.render(),this.setIsStopped(!0)},n.prototype.onLoadedDefault=function(t,n){var r=this,o=r.partDic[e.ActorPart.DEFAULT];o&&(r.totalFrame=o.totalFrames,r.frameRate=o.frameRate,r.setIsStopped(!1))},n.prototype.onLoadedOther=function(t){var n=this,r=n.partDic[e.ActorPart.DEFAULT];r&&(n.removePart(e.ActorPart.DEFAULT),n.totalFrame=1),t||n.changeDir(n.dir)},n.prototype.onLoaded=function(t,n){var r=this;if(r.removePart(e.ActorPart.DEFAULT),-1!=n.indexOf(r.act)){var o=r.partDic[e.ActorPart.BODY];o?(r.totalFrame=o.totalFrames,r.frameRate=o.frameRate):r.totalFrame=0,r.totalFrame>0?(r.actDic[r.act]=!0,1==r.totalFrame?r.gotoAndStop(1):r.setIsStopped(!1),r.loadCallBack&&r.loadCallBack.call(r.loadThisObject)):r.gotoAndPlay(r.act,r.dir)}},Object.defineProperty(n.prototype,"firstBodyFrameHeight",{get:function(){var t=this.partDic[e.ActorPart.BODY];return t?t.firstFrameHeight:0},enumerable:!0,configurable:!0}),n.prototype.registerFrameEvent=function(e,t,n){this.eventDic[e]={callBack:t,thisObject:n}},n.prototype.unRegisterFrameEvent=function(e){var t=this.eventDic;t[e]&&(t[e]=null,delete t[e])},n.prototype.clearFrameEvent=function(){var e=this.eventDic;for(var t in e)e[t]=null,delete e[t]},n.prototype.advanceTime=function(e){var t=this;if(t.isNoRendering)return t.gotoAndStop(1),!1;var n=e-t.lastTime;t.lastTime=e;var r=t.frameIntervalTime,o=t.passedTime+n;t.passedTime=o%r;var i=o/r;if(1>i)return!1;for(t.render();i>=1;)i--,t.currentFrame++,t.actDic[t.act]&&t.checkFrameEvent();return!1},n.prototype.checkFrameEvent=function(){var e=this.eventDic[this.currentFrame];e&&e.callBack&&e.callBack.call(e.thisObject)},n.prototype.render=function(){var e=this;if(e.totalFrame>0&&(e.currentFrame>e.totalFrame&&(e.currentFrame=1,e.loopCallBack&&e.loopCallBack.call(e.loopThisObject)),1==e.totalFrame||e.stage)){var t=e.partDic,n=e.currentFrame;for(var r in t){var o=t[r];o&&o.render(n)}}},Object.defineProperty(n.prototype,"frameRate",{set:function(e){e>60&&(e=60),this._frameRate=e,this.frameIntervalTime=1e3/(e*this._timeScale)},enumerable:!0,configurable:!0}),n.prototype.getTotalFrame=function(){return this.totalFrame},Object.defineProperty(n.prototype,"timeScale",{get:function(){return this._timeScale},set:function(e){0>=e&&(e=1),this._timeScale=e,this.frameIntervalTime=1e3/(this._frameRate*e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"act",{get:function(){return this._act},set:function(e){this._act=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"resourcePath",{get:function(){return this._resourcePath},set:function(e){this._resourcePath=e},enumerable:!0,configurable:!0}),n.prototype.setIsStopped=function(e){var t=this;t.isStopped!=e&&(t.isStopped=e,e?egret.stopTick(t.advanceTime,t):1==t.totalFrame||t.isNoRendering?t.gotoAndStop(1):(t.lastTime=egret.getTimer(),egret.startTick(t.advanceTime,t)))},n.prototype.getDir=function(){return this.dir},n.prototype.clear=function(){this.setIsStopped(!0),this.clearFrameEvent(),this.parent&&this.parent.removeChild(this)
},n.prototype.dispos=function(e){void 0===e&&(e=!0);var t=this;t.setIsStopped(!0),t.clearFrameEvent(),t.removeEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t.removeEventListener(egret.Event.REMOVED_FROM_STAGE,t.removeToStage,t);for(var n in t.partDic)t.removePart(n);t.parent&&e&&t.parent.removeChild(t)},n}(egret.DisplayObjectContainer);e.BaseActor=t,__reflect(t.prototype,"qmr.BaseActor")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.IDLE="idle",e.ATTACK="attack",e.ATTACK2="attack2",e.MOVE="move",e.FLY="move",e.DEAD="death",e.SKILL="skill",e.SKILL2="skill2",e.IDLE_RIDE="idle_ride",e.MOVE_RIDE="move_ride",e.ATTACK_RIDE="attack_ride",e.JUMP="fly",e.JUMP_ATTACK="jump_attack",e.STAND="stand",e.PICK="pick",e.UI_SHOW="ui_show",e.UI_SHOW1="ui_show_1",e.UI_IDLE="ui_idle",e}();e.Status=t,__reflect(t.prototype,"qmr.Status")}(qmr||(qmr={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){qmr.ResManager.getRes(e,t,n,qmr.LoadPriority.IMMEDIATELY,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var qmr;!function(e){var t=function(){function e(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.resJson=e,this.spriteSheet=t,this.autoHalfTexture=r,this.autoParseTexture=n,this.framesList=[]}return e.prototype.parseClip=function(e){var t=this,n=0,r=this.framesList;t._frameRate=parseInt(e.frameRate);for(var o=0,i=e.frames;o<i.length;o++){var a=i[o],s=parseInt(a.duration);isNaN(s)&&(s=1);for(var l=1;s>=l;l++)n+=1,r.push(a)}if(t.autoParseTexture)for(var c=t.spriteSheet,u=t.autoHalfTexture,f=0,p=r;f<p.length;f++){var g=p[f];if(!c.getTexture(g.res)){var d=t.resJson[g.res];u?c.createTexture(g.res,Math.ceil(d.x/2),Math.ceil(d.y/2),d.w>>1,d.h>>1):c.createTexture(g.res,d.x,d.y,d.w,d.h)}}t._totalFrames=t.framesList.length},e.prototype.parseClipByStartAndEnd=function(e,t,n){var r=this,o=0,i=r.framesList;r._frameRate=parseInt(e.frameRate);for(var a=0,s=e.frames;a<s.length;a++){var l=s[a],c=parseInt(l.duration);isNaN(c)&&(c=1);for(var u=1;c>=u;u++)o+=1,o>=t&&n>=o&&i.push(l)}r._totalFrames=i.length},e.prototype.getTextureByFrame=function(e){var t,n=this;if(!(e<=n.framesList.length))return null;t=n.framesList[e-1];var r=n.spriteSheet.getTexture(t.res);if(!r){var o=n.resJson[t.res];r=n.spriteSheet.createTexture(t.res,o.x,o.y,o.w,o.h)}return r},e.prototype.getOffset=function(e){var t,n=this.framesList;if(t=e<=n.length?n[e-1]:n[n.length-1],this.autoHalfTexture){var r=this.resJson[t.res],o=r.x%2?1:0,i=r.y%2?1:0;return{x:t.x+o,y:t.y+i,w:r.w>>1<<1,h:r.h>>1<<1}}return t},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfTexture",{get:function(){return this.autoHalfTexture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this._frameRate},enumerable:!0,configurable:!0}),e.prototype.dispos=function(){this.framesList.length=0,this.framesList=null},e}();e.AnimateData=t,__reflect(t.prototype,"qmr.AnimateData")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.maxAliveTime=1e4,this.animaDic={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.parseSpriteSheet=function(t,n,r,o,i,a){void 0===i&&(i=-1),void 0===a&&(a=!0);var s,l=new egret.SpriteSheet(o);for(var c in r.mc)if(null!=c&&0!=c.length){s=r.mc[c];break}if(s){var u=this.animaDic[t];u||(u={},this.animaDic[t]=u),u.url=n,u.sheet=l;var f=s.labels,p=r.harf;if(f&&f.length>1)for(var g=0,d=f;g<d.length;g++){var h=d[g],m=new e.AnimateData(r.res,l,a,p);m.parseClipByStartAndEnd(s,parseInt(h.frame),parseInt(h.end)),u[parseInt(h.name)]=m}else{var m=new e.AnimateData(r.res,l,a,p);m.parseClip(s),u.data=m}}},t.prototype.getAnimalData=function(e,t){var n=this.animaDic[e];if(!n)return null;var r=n.count;return r?r+=1:r=1,n.count=r,n.useTime=egret.getTimer(),t>0&&-1==e.indexOf("death")?n[t]:n.data},t.prototype.dispos=function(e){if("168_idle"!=e){var t=this.animaDic[e];if(t){var n=t.count;n?n-=1:n=0,0>=n&&(n=0),t.count=n}}},t.prototype.clear=function(t){var n=this.animaDic,r=this.maxAliveTime;for(var o in n){var i=n[o];if(0==i.count&&i.useTime&&t-i.useTime>r){i.sheet&&i.sheet.dispose();var a=RES.destroyRes(i.url);e.LogUtil.warn("AnimationManager.destroy url="+i.url+"  "+a),n[o]=null,delete n[o]}}},t}();e.AnimateManager=t,__reflect(t.prototype,"qmr.AnimateManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(e){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=null);var r=e.call(this,t,n)||this;return r._wingFrame=0,r._wingFrameIndex=0,r}return __extends(t,e),t.prototype.render=function(t){this._wingFrame!=t&&(this._wingFrame=t,this._wingFrameIndex++),t=1+this._wingFrameIndex%this.totalFrames,e.prototype.render.call(this,t)},t.prototype.reset=function(){e.prototype.reset.call(this),this._wingFrame=0,this._wingFrameIndex=0},t}(e.AnimateClip);e.AnimateWing=t,__reflect(t.prototype,"qmr.AnimateWing")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.currentFrame=1,n.totalFrame=0,n.isStopped=!0,n.passedTime=0,n.lastTime=0,n.frameRate=30,n.eventDic={},n._timeScale=1,n.mainClip=new e.AnimateClip(n.onLoaded,n),n.addChild(n.mainClip),n}return __extends(n,t),n.prototype.load=function(e,t,n,r,o){void 0===o&&(o=1),this.playeTimes=1,this.loopCallBack=n,this.thisObject=r,this.mainClip.load(e,t)},n.prototype.onLoaded=function(){this.totalFrame=this.mainClip.totalFrames,this.frameRate=this.mainClip.frameRate,this.currentFrame=1,this.render(),this.setIsStopped(!1),1==this.totalFrame&&this.gotoAndStop(1)},n.prototype.registerFrameEvent=function(e,t,n){this.eventDic[e]={callBack:t,thisObject:n}},n.prototype.unRegisterFrameEvent=function(e){this.eventDic[e]&&(this.eventDic[e]=null,delete this.eventDic[e])},n.prototype.advanceTime=function(e){var t=this,n=e-t.lastTime;t.lastTime=e;var r=t.frameIntervalTime,o=t.passedTime+n;t.passedTime=o%r;var i=o/r;if(1>i)return!1;for(t.render();i>=1;)i--,t.currentFrame++,t.checkFrameEvent();return!1},n.prototype.checkFrameEvent=function(){var e=this.eventDic[this.currentFrame];e&&e.callBack&&e.callBack.call(e.thisObject)},n.prototype.clearCallBack=function(){this.loopCallBack=null},n.prototype.render=function(){var e=this;return e.totalFrame>0&&e.currentFrame>e.totalFrame&&(e.loopCallBack&&e.loopCallBack.call(e.thisObject),e.currentFrame=1,1==e.playeTimes)?void e.setIsStopped(!0):void e.mainClip.render(e.currentFrame)},Object.defineProperty(n.prototype,"frameRate",{set:function(e){e>60&&(e=60),this._frameRate=e,this.frameIntervalTime=1e3/(e*this._timeScale)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeScale",{set:function(e){isNaN(this.frameRate)||(this._timeScale=e,this.frameIntervalTime=1e3/(this._frameRate*e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalFrames",{get:function(){return this.totalFrame},enumerable:!0,configurable:!0}),n.prototype.gotoAndStop=function(e){this.mainClip.render(e),this.setIsStopped(!0)},n.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?egret.stopTick(this.advanceTime,this):(this.lastTime=egret.getTimer(),egret.startTick(this.advanceTime,this)))},n.prototype.clear=function(){this.mainClip&&this.mainClip.reset()},n.prototype.dispos=function(){this.mainClip&&this.mainClip.dispos(),this.setIsStopped(!0);for(var e in this.eventDic)this.eventDic[e]=null,delete this.eventDic[e];this.parent&&this.parent.removeChild(this)},n}(egret.DisplayObjectContainer);e.MovieClip=t,__reflect(t.prototype,"qmr.MovieClip")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.iscompleted=!1,e.isSeted=!1,e.skinName="CommonTipSkin",e.touchEnabled=e.touchChildren=!1,e}return __extends(n,t),n.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.iscompleted=!0},n.prototype.initData=function(){t.prototype.initData.call(this),this.setTip()},n.prototype.onStageResize=function(){t.prototype.onStageResize.call(this),this.x=(e.StageUtil.stageWidth-640)/2},n.prototype.showTip=function(e){this.data=e,this.iscompleted&&this.setTip()},n.prototype.setTip=function(){this.data&&(this.isSeted||(this.x=(e.StageUtil.stageWidth-640)/2,this.isSeted=!0,this.alpha=1,this.data.color?(this.lbl_tipMsg.text=this.data.mess,this.lbl_tipMsg.textColor=this.data.color):this.lbl_tipMsg.textFlow=e.HtmlUtil.getHtmlString(this.data.mess),this.data.itemcfg&&e.ImageUtil.setItemIcon(this.img_icon,this.data.itemcfg.icon,this.data.itemcfg.page),this.y=e.StageUtil.stageHeight/2-this.height/2+this.data.yPos,this.common_g.width=this.lbl_tipMsg.width+200,egret.Tween.get(this).to({y:e.StageUtil.stageHeight/3+50+this.data.yPos},1500).to({y:e.StageUtil.stageHeight/3+this.data.yPos,alpha:0},800).call(this.dispose,this)))},n.prototype.dispose=function(){this.data=null,this.isSeted=!1,this.lbl_tipMsg.text="",this.img_icon.source=null,egret.Tween.removeTweens(this),t.prototype.dispose.call(this),e.TipManagerCommon.getInstance().recycleCommonTip(this)},n}(e.UIComponent);e.CommonTip=t,__reflect(t.prototype,"qmr.CommonTip")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.getCNValue=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.getBean(e.ConfigEnumBase.CLIENTCN),i=o.get(t);if(i){var a=i.value;return n&&n.length>0&&(n.unshift(a),a=e.StringUtils.getmsg.apply(e.StringUtils,n)),a}return""},t.getConf=function(e,t){var n,r=this.getBean(e);return r?n=r.get(t):null},t.getBean=function(t){var n=this.cfgDic.get(t);return n||(n=this.parseConfigFromZip(t),this.cfgDic.set(t,n),e.LogUtil.log("ConfigManagerBase.parseConfigFromZip:",t)),n},t.parseConfigFromZip=function(t){var n=this,r=new e.Dictionary,o=t.charAt(0).toLocaleUpperCase()+t.slice(1,t.length)+"Cfg",i=e[o],a=n.getZip(n.WHOLE_CONFIG_NAME);a||(a=n.getZip(n.BASE_CONFIG_NAME)),a||console.error("配置读取失败");var s=a.file(t+".json");s||e.LogUtil.warn("从zip中解析一张表 = "+t+" 异常，请查看配置是否提交？？");var l=JSON.parse(s.asText());return i&&(e.PlatformConfig.isShildTSV&&"Hero"==t&&e.TSHelper&&e.TSHelper.instance.handleHeroCfgJson(l),l.forEach(function(t){var o=new i(t);if(o.key){var a=n.getkey(o,t);r.setConf(a,o)}else e.LogUtil.warn("获取配置表的唯一key 错误了。。。"+o)})),r},t.getZip=function(t){this.zipDic||(this.zipDic=new e.Dictionary);var n=this.zipDic.get(t);if(!n){var r=RES.getRes(t);r&&(n=new JSZip(r),this.zipDic.set(t,n))}return n},t.getkey=function(e,t){if(e.key){var n=e.key.split("_"),r="",o=n.length;return 1==o?r=t[e.key]:n.forEach(function(e,n){r+=n!=o-1?t[e]+"_":t[e]}),r}},t.cfgDic=new e.Dictionary,t.WHOLE_CONFIG_NAME="config_bin",t.BASE_CONFIG_NAME="configbase_bin",t}();e.ConfigManagerBase=t,__reflect(t.prototype,"qmr.ConfigManagerBase")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.setup=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return e.WebBrowerUtil.initSysInfo(),[4,e.PlatformConfig.init()];case 1:return n.sent(),e.StageUtil.init(t),egret.ImageLoader.crossOrigin="anonymous",egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.registerVersionController(new e.VersionController),e.MessageIDLogin.init(),e.LayerManager.instance.setup(e.StageUtil.stage),e.ModuleManager.setupClass(),e.LoginController.instance,e.SystemController.instance,e.GameLifecycleManger.instance.init(),this.initLocalStorage(),[4,e.GameLoadManager.instance.loadBaseRes()];case 2:return n.sent(),[4,e.PlatformManager.instance.platform.reqLogin()];case 3:return n.sent(),[4,e.LoginManager.startCheck()];case 4:return n.sent(),[2]}})})},t.initLocalStorage=function(){var t="0"==egret.localStorage.getItem("bgSoundIsOpen"),n="0"==egret.localStorage.getItem("effectSoundIsOpen");console.log("背景音乐是否关闭："+t),console.log("音效是否关闭："+n),e.SoundManager.getInstance().isMusicSoundOpen=!t,e.SoundManager.getInstance().isEffectSoundOpen=!n},t}();e.EntryLogin=t,__reflect(t.prototype,"qmr.EntryLogin")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.PlayerName=!0,e.CodeCfg=!0,e.Music=!0,e.ClientCn=!0,e}();e.BaseConfigKeys=t,__reflect(t.prototype,"qmr.BaseConfigKeys")}(qmr||(qmr={}));var qmr;!function(e){var t=function(e){function t(t){var n=e.call(this,t)||this;return n.key="id",n}return __extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.d.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name_xing",{get:function(){return this.d.name_xing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name_ming_nan",{get:function(){return this.d.name_ming_nan},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name_ming_nv",{get:function(){return this.d.name_ming_nv},enumerable:!0,configurable:!0}),t}(e.BaseBean);e.PlayerNameCfg=t,__reflect(t.prototype,"qmr.PlayerNameCfg");var n=function(e){function t(t){var n=e.call(this,t)||this;return n.key="id",n}return __extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.d.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"msg",{get:function(){return this.d.msg},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.d.type},enumerable:!0,configurable:!0}),t}(e.BaseBean);e.CodeCfgCfg=n,__reflect(n.prototype,"qmr.CodeCfgCfg");var r=function(e){function t(t){var n=e.call(this,t)||this;return n.key="soundType",n}return __extends(t,e),Object.defineProperty(t.prototype,"soundType",{get:function(){return this.d.soundType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"soundName",{get:function(){return this.d.soundName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlaySameTime",{get:function(){return this.d.isPlaySameTime},enumerable:!0,configurable:!0}),t}(e.BaseBean);e.MusicCfg=r,__reflect(r.prototype,"qmr.MusicCfg");var o=function(e){function t(t){var n=e.call(this,t)||this;return n.key="id",n}return __extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.d.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.d.value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colerType",{get:function(){return this.d.colerType},enumerable:!0,configurable:!0}),t}(e.BaseBean);e.ClientCnCfg=o,__reflect(o.prototype,"qmr.ClientCnCfg")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.PLAYERNAME="PlayerName",e.CODECFG="CodeCfg",e.MUSIC="Music",e.CLIENTCN="ClientCn",e}();e.ConfigEnumBase=t,__reflect(t.prototype,"qmr.ConfigEnumBase")}(qmr||(qmr={}));var qmr;!function(e){var t;!function(e){e[e.Type_1=1]="Type_1",e[e.Type_2=2]="Type_2"}(t=e.BtnSkinType||(e.BtnSkinType={}));var n;!function(e){e[e.SYSTEM=1]="SYSTEM",e[e.WORLD=2]="WORLD",e[e.TEAM=3]="TEAM",e[e.SELF=4]="SELF",e[e.UNION=5]="UNION",e[e.CROSS=6]="CROSS"}(n=e.CHAT_CHANNELID||(e.CHAT_CHANNELID={}))}(qmr||(qmr={}));var qmr;!function(e){var t;!function(e){e[e.BG_MUSIC=1]="BG_MUSIC",e[e.EFFECT_MUSIC=2]="EFFECT_MUSIC"}(t=e.MusicType||(e.MusicType={}));var n;!function(e){e[e.ROLE_MALE=101]="ROLE_MALE",e[e.ROLE_FEMALE=102]="ROLE_FEMALE"}(n=e.WarriorRole||(e.WarriorRole={}));var r;!function(e){e[e.COLOR_G=9067563]="COLOR_G",e[e.COLOR_GREEN=632328]="COLOR_GREEN",e[e.COLOR_BLUE=2197196]="COLOR_BLUE",e[e.COLOR_VIOLET=16722152]="COLOR_VIOLET",e[e.COLOR_CADMIUM=15095046]="COLOR_CADMIUM",e[e.COLOR_RED=14489856]="COLOR_RED",e[e.COLOR_DIAMOND=4758466]="COLOR_DIAMOND"}(r=e.ColorQualityConst||(e.ColorQualityConst={}));var o;!function(e){e[e.TIEM=0]="TIEM",e[e.HERO=1]="HERO",e[e.EQUIP=2]="EQUIP"}(o=e.BagType||(e.BagType={}));var i;!function(e){e[e.small=0]="small",e[e.mid=1]="mid",e[e.big=2]="big",e[e.UI=3]="UI"}(i=e.ActorSizeType||(e.ActorSizeType={}))}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e}();e.NotifyConstBase=t,__reflect(t.prototype,"qmr.NotifyConstBase")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.S_ERROR_CODE="S_ERROR_CODE",e.S_USER_LOGIN="S_USER_LOGIN",e.S_USER_LOGIN_REPEAT="S_USER_LOGIN_REPEAT",e.S_LOGIN_OFFLINE_HANGUP_PUSH="S_LOGIN_OFFLINE_HANGUP_PUSH",e.S_USER_LOGOUT="S_USER_LOGOUT",e.TAB_VIEW_ADDPAGE="TAB_VIEW_ADDPAGE",e.TAB_VIEW_REMOVEPAGE="TAB_VIEW_REMOVEPAGE",e.TAB_VIEW_CHANGE_TAB="TAB_VIEW_CHANGE_TAB",e.UPDATE_OPEN_TITLE="UPDATE_OPEN_TITLE",e.UPDATE_MODULE_TITLE="UPDATE_MODULE_TITLE",e.OPEN_PANEL_LAYER="OPEN_PANEL_LAYER",e.CLOSE_PANEL_LAYER="CLOSE_PANEL_LAYER",e.OPEN_PANEL_VIEW="OPEN_PANEL_VIEW",e.CLOSE_PANEL_VIEW="CLOSE_PANEL_VIEW",e.SCNY_ONE_SERVER_TIME="SCNY_ONE_SERVER_TIME",e.CROSS_DAY="CROSS_DAY",e.CHANGE_MODEL_VIEW="SHOW_OR_HIDE_GUIDE",e.TO_HIDE_VIP_VIEW="TO_HIDE_VIP_VIEW",e.TO_REQUEST_SHARE_REWARD="TO_REQUEST_SHARE_REWARD",e}();e.NotifyConstLogin=t,__reflect(t.prototype,"qmr.NotifyConstLogin")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(e,t,n,r){this._id=0,this.setTo(e,t,n,r)}return e.prototype.setTo=function(t,n,r,o){return this._id=e._gid++,this.caller=t,this.method=n,this.args=r,this.once=o,this},e.prototype.run=function(){if(null==this.method)return null;var e=this._id,t=this.method.apply(this.caller,this.args);return this._id===e&&this.once&&this.recover(),t},e.prototype.runWith=function(e){if(null==this.method)return null;var t,n=this._id;return t=this.args?this.method.apply(this.caller,this.args.concat(e)):this.method.apply(this.caller,e),this._id===n&&this.once&&this.recover(),t},e.prototype.recover=function(){this._id>0&&(this._id=0,e._pool.push(this.clear()))},e.create=function(t,n,r,o){return void 0===r&&(r=null),void 0===o&&(o=!0),this._pool.length?this._pool.pop().setTo(t,n,r,o):new e(t,n,r,o)},e.prototype.clear=function(){return this.caller=null,this.method=null,this.args=null,this},e._pool=[],e._gid=1,e}();e.Handler=t,__reflect(t.prototype,"qmr.Handler")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.sendPost=function(e,t,n,r){var o="",i=0;for(var a in t)o+=0==i?a+"="+t[a]:"&"+a+"="+t[a],i++;var s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT,s.open(e,egret.HttpMethod.POST),s.send(o),s.addEventListener(egret.Event.COMPLETE,function(e){n&&n.call(s.response)},this)},e.sendGet=function(e,t,n){var r=new egret.HttpRequest;r.timeout=1e4,r.responseType=egret.HttpResponseType.TEXT,r.open(e,egret.HttpMethod.GET),r.send(null),r.addEventListener(egret.Event.COMPLETE,function(e){t&&t.call(n,r.response)},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){},this)},e}();e.HttpRequest=t,__reflect(t.prototype,"qmr.HttpRequest")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.MAP_LAYER="mapLayer",e.FIGTH_UI="figthUI",e.TOOLBAR="toolbar",e.ACTIVITY_UI="activityUI",e.BASE_UI="baseUI",e.SECOND_PAGE_UI="secondUI",e.UI_EFFECT="uiEffect",e.ALERT="alert",e.TIP="tip",e.LOADING="loading",e.SYSTEM_UI="systemUI",e.GUIDE="guide",e.MASK_UI="maskUI",e.CHAT="chat",e.TOP="top",e}();e.LayerConst=t,__reflect(t.prototype,"qmr.LayerConst")}(qmr||(qmr={}));var qmr;!function(e){var t=egret.DisplayObjectContainer,n=function(){function n(){this.layerList=new Array,this.layerDic=new e.Dictionary}return Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.setup=function(t){this._parent=t,this.layerIndex=this._parent.numChildren,this.addLayer(e.LayerConst.MAP_LAYER,!0),this.addLayer(e.LayerConst.FIGTH_UI,!0),this.addLayer(e.LayerConst.TOOLBAR,!0),this.addLayer(e.LayerConst.ACTIVITY_UI,!0),this.addLayer(e.LayerConst.BASE_UI,!0),this.addLayer(e.LayerConst.SECOND_PAGE_UI,!0),this.addLayer(e.LayerConst.UI_EFFECT,!1),this.addLayer(e.LayerConst.ALERT,!0),this.addLayer(e.LayerConst.SYSTEM_UI,!0),this.addLayer(e.LayerConst.MASK_UI,!0),this.addLayer(e.LayerConst.GUIDE,!0),this.addLayer(e.LayerConst.CHAT,!0),this.addLayer(e.LayerConst.TOP,!0),this.addLayer(e.LayerConst.TIP,!1),this.addLayer(e.LayerConst.LOADING,!1)},n.prototype.showOrHideFightMapAndToolbar=function(t){if(t){var n=this.getLayer(e.LayerConst.MAP_LAYER);e.DisplayUtils.removeDisplay(n),n=this.getLayer(e.LayerConst.FIGTH_UI),e.DisplayUtils.removeDisplay(n),n=this.getLayer(e.LayerConst.TOOLBAR),e.DisplayUtils.removeDisplay(n)}else{var n=this.getLayer(e.LayerConst.MAP_LAYER);this._parent.addChildAt(n,this.layerIndex),n=this.getLayer(e.LayerConst.FIGTH_UI),this._parent.addChildAt(n,this.layerIndex+1),n=this.getLayer(e.LayerConst.TOOLBAR),this._parent.addChildAt(n,this.layerIndex+2)}this._isHideFight=t},Object.defineProperty(n.prototype,"isHideFight",{get:function(){return this._isHideFight},enumerable:!0,configurable:!0}),n.prototype.showLayer=function(e){var t=this.getLayer(e);t&&(t.x=0)},n.prototype.hideLayer=function(e){var t=this.getLayer(e);t&&(t.x=9999)},n.prototype.addLayer=function(e,n){var r,o=this._parent.getChildByName(e);o||(r=new t,r.touchEnabled=r.touchChildren=n,r.name=e,this.layerList.push(r),this._parent.addChild(r),this.layerDic.set(e,r))},n.prototype.getLayer=function(e){return e?this.layerDic.get(e):null},n.prototype.addChild=function(e,t){var n=this.getLayer(t);return n&&n.addChild(e),e},n.prototype.addChildAt=function(e,t,n){void 0===n&&(n=0);var r=this.getLayer(t);return r&&r.addChildAt(e,0),e},n.prototype.removeChild=function(e){return e?(e.parent&&e.parent.removeChild(e),e):e},n.prototype.setCenter=function(t){t&&(t.x=Math.floor((e.StageUtil.stageWidth-t.width)/2),t.y=Math.floor((e.StageUtil.stageHeight-t.height)/2))},Object.defineProperty(n.prototype,"layersVisible",{set:function(e){for(var t=0,n=this.layerList;t<n.length;t++){var r=n[t];if(r.visible==e)break;r.visible=e}},enumerable:!0,configurable:!0}),n.prototype.addDisplay=function(e,t,n){var r=this.getLayer(t);n?r.addChildAt(e,999):r.addChild(e)},n}();e.LayerManager=n,__reflect(n.prototype,"qmr.LayerManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.loadGroup=function(e,n,r,o,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=0),void 0===i&&(i=null),t.addLoader(e,n,r,o,null,!0,i)},t.getRes=function(e,n,r,o,i){function a(t){n&&n.call(r,t,e)}if(void 0===o&&(o=0),void 0===i&&(i=null),e){if(RES.hasRes(e)){var s=RES.getRes(e);if(s)return void a(s)}t.addLoader(e,n,r,o,i)}},t.addLoader=function(o,i,a,s,l,c,u){void 0===s&&(s=0),void 0===l&&(l=null),void 0===c&&(c=!1),void 0===u&&(u=null);var f=r.get();f.init(t.loaderCompleted,o,i,a,l,s,c,u);var p=t._sameResInfoDic;p||(p=new e.Dictionary,t._sameResInfoDic=p);var g=p.get(o);if(g)g.push(f),t.checkSameLoaderPriority(o,s);else if(g=[],p.set(o,g),s>=n.IMMEDIATELY)t.startLoader(f);else{var d=t._loaderQueue;d||(d=[],t._loaderQueue=d),d.push(f),t.checkToLoadNext()}},t.checkSameLoaderPriority=function(e,r){var o=t._loaderQueue;if(o)for(var i=o.length,a=0;i>a;a++){var s=o[a];if(s.source==e){s.priority<r&&(s.priority=r,r==n.IMMEDIATELY?(o.splice(a,1),t.startLoader(s)):t.checkToLoadNext());break}}},t.checkToLoadNext=function(){var e=t._loaderQueue;if(e){var r=e.length;if(r>0){var o=e[r-1],i=!1;o.priority>=n.HIGH?t._loadingCount<t.HIGH_PRIORITY_MAX_COUNT&&(i=!0):o.priority<=n.LOW&&t._loadingCount<t.LOW_PRIORITY_MAX_COUNT&&(i=!0),i&&(o=e.pop(),t.startLoader(o))}}},t.startLoader=function(e){t._loadingCount++,e.load()},t.loaderCompleted=function(n,o,i){try{if(o){t.callbackLoader(n,i);var a=t._loaderQueue;if(a&&a.length>0)for(var s=a.length,l=s-1;l>=0;l--){var c=a[l];if(RES.hasRes(c.source)){var u=RES.getRes(c.source);u&&(t.callbackLoader(c,u),a.splice(l,1),r.recycle(c))}}}var f=t._sameResInfoDic.get(n.source),p=0;if(f&&(t._sameResInfoDic.remove(n.source),o)){p=f.length;for(var l=0;p>l;l++){var g=f[l];t.startLoader(g)}}r.recycle(n)}catch(d){e.LogUtil.log("ResManager.loaderCompleted error"+d)}finally{t._loadingCount--,t.checkToLoadNext()}},t.callbackLoader=function(e,t){e.compFunc&&(t?e.compFunc.call(e.thisObject,t,e.source):e.compFunc.call(e.thisObject))},t.LOW_PRIORITY_MAX_COUNT=1,t.HIGH_PRIORITY_MAX_COUNT=4,t._loadingCount=0,t}();e.ResManager=t,__reflect(t.prototype,"qmr.ResManager");var n;!function(e){e[e.LOW=-1]="LOW",e[e.HIGH=0]="HIGH",e[e.IMMEDIATELY=1]="IMMEDIATELY"}(n=e.LoadPriority||(e.LoadPriority={}));var r=function(){function e(){}return e.getPool=function(){var t=e._pool;return t||(t=[],e._pool=t),t},e.get=function(){var t,n=e.getPool();return t=n.length>0?n.pop():new o},e.recycle=function(t){t.reset();var n=e.getPool();n.push(t)},e}();__reflect(r.prototype,"LoaderPool");var o=function(){function t(){}return t.prototype.init=function(e,t,n,r,o,i,a,s){void 0===i&&(i=0),void 0===a&&(a=!1),void 0===s&&(s=null),this.callbackMananger=e,this.source=t,this.compFunc=n,this.thisObject=r,this.type=this.type,this.priority=i,this.isGroup=a,this.progFunc=s,this.loadCount=0},t.prototype.load=function(){if(this.loadCount++,this.isGroup)this.loadCount<=1&&(RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadCompleted,this)),RES.loadGroup(this.source);else{var e=!1;if(RES.hasRes(this.source)){e=!0;var t=RES.getRes(this.source);if(t)return void this.onGetResSuccess(t)}this.loadCount<=1&&RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),e?RES.getResAsync(this.source,this.onGetResSuccess,this):RES.getResByUrl(this.source,this.onGetResSuccess,this,this.type)}},t.prototype.reset=function(){this.isGroup?(RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadCompleted,this)):RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.callbackMananger=null,this.source=null,this.compFunc=null,this.thisObject=null,this.type=null,this.priority=null,this.isGroup=!1,this.progFunc=null,this.loadCount=0},t.prototype.onGetResSuccess=function(e){this.callbackMananger&&this.callbackMananger(this,!0,e)},t.prototype.onItemLoadError=function(t){this.source==t.resItem.url&&(e.LogUtil.log("onItemLoadError",this.source),this.callbackMananger&&this.callbackMananger(this,!1))},t.prototype.onGroupLoadCompleted=function(e){this.source==e.groupName&&this.callbackMananger&&this.callbackMananger(this,!0)},t.prototype.onGroupLoadError=function(e){this.source==e.groupName&&this.callbackMananger&&this.callbackMananger(this,!1)},t.prototype.onGroupProgress=function(e){this.source==e.groupName&&this.progFunc&&this.progFunc(e.itemsLoaded/e.itemsTotal)},t}();__reflect(o.prototype,"Loader")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.onHideCount=0}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;egret.lifecycle.onPause=function(){e.onPause()},egret.lifecycle.onResume=function(){e.onResume()}},t.prototype.onResume=function(){e.LogUtil.log("焦点触发"),e.SoundManager.getInstance().isMusicSoundOpen=t.bgSoundIsOpen,e.SoundManager.getInstance().isEffectSoundOpen=t.effectSoundIsOpen,e.PlatformManager.instance.platform.onShareBack()},t.prototype.onPause=function(){e.LogUtil.log("焦点失去"),t.instance.onHideCount++,t.bgSoundIsOpen=e.SoundManager.getInstance().isMusicSoundOpen,t.effectSoundIsOpen=e.SoundManager.getInstance().isEffectSoundOpen,e.SoundManager.getInstance().isMusicSoundOpen=!1,e.SoundManager.getInstance().isEffectSoundOpen=!1},t.bgSoundIsOpen=!0,t.effectSoundIsOpen=!0,t}();e.GameLifecycleManger=t,__reflect(t.prototype,"qmr.GameLifecycleManger")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.loadBaseRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.PlatformManager.instance.platform.setLoadingStatus("玩命加载中..."),[4,this.loadResJson("login.res.json","resourceLogin/")];case 1:return t.sent(),[4,this.loadThmJson("login.thm.json")];case 2:return t.sent(),[4,this.loadPreloadingGroup()];case 3:return t.sent(),[4,this.loadLoginBaseAnimation()];case 4:return t.sent(),e.PlatformManager.instance.platform.setLoadingProgress(50),[2]}})})},n.prototype.loadcreateRoleGroup=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResJson("createrole.res.json")];case 1:return n.sent(),[4,this.loadThmJson("createrole.thm.json")];case 2:return n.sent(),[4,this.loadCreateRoleThmJs()];case 3:return n.sent(),[2,new Promise(function(n,r){var o=2,i=0,a=function(){i++,i>=o&&n()};e.ResManager.loadGroup("createrole",a,t,e.LoadPriority.IMMEDIATELY),e.ResManager.getRes(e.GlobalConfig.getBgName(),a,t,e.LoadPriority.IMMEDIATELY)})]}})})},n.prototype.loadLoginViewRes=function(){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(r){return e.PlatformManager.instance.platform.setLoadingStatus("精彩立即呈现"),t=this,[2,new Promise(function(t,r){var o=2,i=0,a=function(){i++,i>=o&&t()};e.ResManager.loadGroup("login",a,n,e.LoadPriority.IMMEDIATELY),e.ResManager.getRes("serverlist_loginBg_jpg",a,n,e.LoadPriority.IMMEDIATELY)})]})})},n.prototype.loadGameResAfterLogin=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.VersionManager.isGameVersionReady?this.isGameResAfterLoginLoading?[2]:(this.isGameResAfterLoginLoading=!0,this.isGameResAfterLoginLoaded=!1,e.MarkPointManager.setPoint(e.PointEnum.POINT_7),[4,this.loadLoadingViewRes()]):[2];case 1:return t.sent(),this.setLoadingViewParams("加载资源配置...",!0,.05,.1,!1),e.MarkPointManager.loginSetPoint(e.PointEnum.LOAD_DEFAULT_RES),e.MarkPointManager.setPoint(e.PointEnum.POINT_WX_LOAD_SKIN),this.setLoadingViewParams("加载皮肤配置...",!0,.1,.2,!0),[4,this.loadResJson("default.res.json")];case 2:return t.sent(),[4,this.loadDefaultThmJs()];case 3:return t.sent(),[4,this.loadThmJson("default.thm.json")];case 4:return t.sent(),e.MarkPointManager.setPoint(e.PointEnum.POINT_WX_LOAD_CONFIG),this.setLoadingViewParams("加载游戏配置...",!0,.2,.5,!0),[4,this.loadConfigGroup()];case 5:return t.sent(),this.setLoadingViewParams("加载公共资源...",!0,.5,.9,!0),e.MarkPointManager.loginSetPoint(e.PointEnum.LOAD_COMMON_RES),e.MarkPointManager.setPoint(e.PointEnum.POINT_WX_LOAD_COMMON_RES),[4,this.loadCommonGroup()];case 6:return t.sent(),[4,this.loadBaseAnimation()];case 7:return t.sent(),e.GlobalConfig.isCreatRoleEnterGame?(this.setLoadingViewParams("加载公共资源...",!0,.9,.99,!0),[4,this.loadResNeedByNewRole()]):[3,9];case 8:t.sent(),t.label=9;case 9:return e.MarkPointManager.setPoint(e.PointEnum.POINT_WX_LOAD_COMPLETED),this.isGameResAfterLoginLoaded=!0,this.gameResAfterLoginLoadedCall&&this.gameResAfterLoginLoadedCall.call(this),[2]}})})},n.prototype.waiGameResAfterLoginLoaded=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n.prototype.waitGameResLoaded=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e=this,[2,new Promise(function(t,n){var r=function(){e.setLoadingViewParams("准备进入游戏...",!0,.99,.99,!0);var n=new egret.Timer(30,1);n.addEventListener(egret.TimerEvent.TIMER,function(){e.loadPreModel(),t()},e),n.start()};e.isGameResAfterLoginLoaded?(e.showLoadingView(),r()):(e.gameResAfterLoginLoadedCall=r,e.showLoadingView())})]})})},n.prototype.loadLoadingViewRes=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=1,i=0,a=function(){i++,i>=o&&n()
};e.ResManager.getRes(e.GameLoadingView.getBgName(),a,t,e.LoadPriority.IMMEDIATELY)})]})})},n.prototype.setLoadingViewParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.loadingViewparams=e,this.gameResAfterLoginLoadedCall&&this.showLoadingView()},n.prototype.showLoadingView=function(){this.loadingViewparams&&e.GameLoadingView.getInstance().showSelf(this.loadingViewparams[0],this.loadingViewparams[1],this.loadingViewparams[2],this.loadingViewparams[3],this.loadingViewparams[4])},n.prototype.updateTotalProgress=function(t){var n=e.ModuleManager.isShowModule(e.ModuleNameLogin.GAME_LOADING_VIEW);n&&e.GameLoadingView.getInstance().updateTotalProgress(t,!0)},n.prototype.loadPreloadingGroup=function(){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(r){return t=this,[2,new Promise(function(r,o){var i=function(){r()};e.ResManager.loadGroup("preloading1",i,n,e.LoadPriority.IMMEDIATELY,t.updateTotalProgress)})]})})},n.prototype.loadLoginBaseAnimation=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=[];o.push({path:e.SystemPath.defaultPath,res:"168_idle"});var i=o.length,a=0,s=function(){a++,a>=i&&n()};t.loaderSilentResource(o,s,e.LoadPriority.IMMEDIATELY)})]})})},n.prototype.loadCreateRoleThmJs=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,n){var r=function(){t()},o=function(e){};window.onScriptLoadedCallBack=r,window.onScriptLoadingProgressCallBack=o,window.loadJsForEgretGame?window.loadJsForEgretGame("createrole",e.VersionManager.getPathWithGameVersion):t()})]})})},n.prototype.loadDefaultThmJs=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,n){var r=function(){t()},o=function(e){};window.onScriptLoadedCallBack=r,window.onScriptLoadingProgressCallBack=o,window.loadJsForEgretGame?window.loadJsForEgretGame("game",e.VersionManager.getPathWithGameVersion):window.loadSub2?window.loadSub2():t()})]})})},n.prototype.loadResJson=function(t,n){return __awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(o){return[2,new Promise(function(o,i){var a=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,a,this),o()};RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,a,r),n||(n=e.PlatformConfig.baseRoot);var s="";s=e.PlatformConfig.useCdnRes?e.PlatformConfig.webUrl+n:n,RES.loadConfig(s+t,s)})]})})},n.prototype.loadThmJson=function(t,n){return __awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(o){return[2,new Promise(function(o,i){var a;n||(n=e.PlatformConfig.baseRoot);var s="";s=e.PlatformConfig.useCdnRes?e.PlatformConfig.webUrl+n:n,a=new eui.Theme(s+t,e.StageUtil.stage);var l=function(){a.removeEventListener(eui.UIEvent.COMPLETE,l,this),o()};a.addEventListener(eui.UIEvent.COMPLETE,l,r)})]})})},n.prototype.loadConfigGroup=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=t,i=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),n()};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),e.ResManager.loadGroup("config",i,t,e.LoadPriority.IMMEDIATELY,o.updateTotalProgress)})]})})},n.prototype.loadCommonGroup=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=t,i=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),n()};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),e.ResManager.loadGroup("common",i,t,e.LoadPriority.IMMEDIATELY,o.updateTotalProgress)})]})})},n.prototype.loadBaseAnimation=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=[];o.push({path:e.SystemPath.rolePath,res:"50_idle"}),t.loadFristMap(o);var i=o.length,a=0,s=function(){a++,a>=i&&n()};t.loaderSilentResource(o,s,e.LoadPriority.IMMEDIATELY)})]})})},n.prototype.loadResNeedByNewRole=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=[];o.push({path:"ui_dlhl_dengluhaoli_png",type:RES.ResourceItem.TYPE_IMAGE}),o.push({path:"lijilingqu_png",type:RES.ResourceItem.TYPE_IMAGE});var i=o.length,a=0,s=function(){a++,a>=i&&n()};t.loaderSilentResource(o,s,e.LoadPriority.IMMEDIATELY)})]})})},n.prototype.loadPreModel=function(){var t=[],n=[],r=e.SystemPath.effectPath,o=e.GlobalConfig.registerAccountHeroId;o==e.WarriorRole.ROLE_MALE?(t.push({path:e.SystemPath.rolePath,res:"1003_idle"}),n.push({path:r,res:"7110_effect",harf:!0}),n.push({path:r,res:"7107_effect"}),n.push({path:r,res:"7089_effect"}),n.push({path:r,res:"7090_effect",harf:!0}),n.push({path:r,res:"7091_effect"}),n.push({path:r,res:"7092_effect"}),n.push({path:r,res:"7093_effect",harf:!0}),n.push({path:r,res:"7094_effect"})):o==e.WarriorRole.ROLE_FEMALE&&(t.push({path:e.SystemPath.rolePath,res:"2003_idle"}),n.push({path:r,res:"7001_effect",harf:!0}),n.push({path:r,res:"7061_effect"}),n.push({path:r,res:"7062_effect",harf:!0}),n.push({path:r,res:"7095_effect"}),n.push({path:r,res:"7096_effect",harf:!0}),n.push({path:r,res:"7097_effect",harf:!0}),n.push({path:r,res:"7098_effect",harf:!0}),n.push({path:r,res:"7099_effect"})),this.loaderSilentResource(t,null,e.LoadPriority.IMMEDIATELY),this.loaderSilentResource(n,null,e.LoadPriority.LOW)},n.prototype.preLoadAnimation=function(t,n,r,o,i,a){void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=null),void 0===a&&(a=!1);var s=n;if(a&&(s+="_f"),o){var l=!1,c=!1;e.ResManager.getRes(t+n+".json",function(e){l=!0,c&&o&&o.call(i)},this,r,RES.ResourceItem.TYPE_JSON),e.ResManager.getRes(t+s+".png",function(e){c=!0,l&&o&&o.call(i)},this,r,RES.ResourceItem.TYPE_IMAGE)}else e.ResManager.getRes(t+n+".json",null,null,r,RES.ResourceItem.TYPE_JSON),e.ResManager.getRes(t+s+".png",null,null,r,RES.ResourceItem.TYPE_IMAGE)},n.prototype.loaderSilentResource=function(t,n,r){void 0===n&&(n=null),void 0===r&&(r=0);for(var o=this,i=null,a=null,s=0,l=t;s<l.length;s++){var c=l[s];a=c.path,c.type?e.ResManager.getRes(a,n,o,r,c.type):(i=c.res,this.preLoadAnimation(c.path,i,r,n,o,c.harf),a=c.path+i+".png",e.LoaderManager.instance.addGroupRef(a))}},n.prototype.loadFristMap=function(t){var n,r,o=1001,i=["_hang_top.jpg","_hang_middle.png","_hang_down.png"];i.forEach(function(i){n=o+i,r=e.ResPathUtil.getHangMapUrl(n),t.push({path:r,type:RES.ResourceItem.TYPE_IMAGE})})},Object.defineProperty(n,"instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n}(e.BaseNotify);e.GameLoadManager=t,__reflect(t.prototype,"qmr.GameLoadManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.jsonDic={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t,t.instance.parseNameJson()),t.instance},t.prototype.getRandomName=function(e){var t,n,r,o=this.name_xing.length,i=this.name_ming_nan.length,a=this.name_ming_nv.length;return t=this.name_xing[Math.floor(Math.random()*o)],n=0==e?this.name_ming_nan[Math.floor(Math.random()*i)]:this.name_ming_nv[Math.floor(Math.random()*a)],r=t+n},t.prototype.parseNameJson=function(){var t=e.ConfigManagerBase.getConf(e.ConfigEnumBase.PLAYERNAME,1);t&&(this.name_xing=t.name_xing?t.name_xing.toString().split(";"):null,this.name_ming_nan=t.name_ming_nan?t.name_ming_nan.toString().split(";"):null,this.name_ming_nv=t.name_ming_nv?t.name_ming_nv.toString().split(";"):null)},t}();e.JsonDataManager=t,__reflect(t.prototype,"qmr.JsonDataManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.mask=new egret.Sprite}return t.getLayerMaskSprite=function(){var n=e.Pool.getItemByClass("LayerMaskSprite",t);return n},t.recovryLayerMaskSprite=function(t){e.Pool.recover("LayerMaskSprite",t)},t.prototype.addMask=function(t,n){void 0===n&&(n=!1),this._isAlpha0=n,this.mask||(this.mask=new egret.Sprite),this.onStageResize(),this.mask.touchEnabled=!0,this.mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMaskHandler,this),e.LayerManager.instance.getLayer(t).addChild(this.mask),n||this.tweenAddMask()},t.prototype.onClickMaskHandler=function(t){if(this.mask&&this.mask.parent){var n=this.mask.parent.numChildren;if(n>1){var r=this.mask.parent.getChildAt(n-1);r instanceof e.SuperBaseModule&&r.isClickHide&&r.hide()}}},t.prototype.tweenAddMask=function(){this.mask&&this.mask.parent&&(egret.Tween.resumeTweens(this.mask),egret.Tween.get(this.mask).to({alpha:1},120))},t.prototype.tweenRemoveMask=function(){var e=this.mask;e&&e.parent&&(e.alpha>0?(e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMaskHandler,this),egret.Tween.resumeTweens(e),egret.Tween.get(e).to({alpha:0},100).call(this.removeMask,this)):this.removeMask())},t.prototype.onStageResize=function(){var e=this.stageWidth,t=this.stageHeight;this.mask.graphics.clear(),this.mask.graphics.beginFill(0,this._isAlpha0?0:.6),this.mask.graphics.drawRect(0,0,e,t),this.mask.graphics.endFill(),this.mask.width=e,this.mask.height=t},t.prototype.removeMask=function(){var e=this.mask;e&&e.parent&&(e.graphics.clear(),e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMaskHandler,this),e.parent.removeChild(e)),this.dispose()},Object.defineProperty(t.prototype,"stageWidth",{get:function(){return e.StageUtil.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stageHeight",{get:function(){return e.StageUtil.stageHeight},enumerable:!0,configurable:!0}),t.prototype.reset=function(){},t.prototype.dispose=function(){this.reset(),t.recovryLayerMaskSprite(this)},t}();e.LayerMaskSprite=t,__reflect(t.prototype,"qmr.LayerMaskSprite")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.maxLivingTime=12e4,this._noCountGroupNames=["common","mainC","common_beijing_png"];var t=this;t.groupNameDic={},e.Ticker.getInstance().registerTick(t.clearGroupTick,t,6e4)}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.addGroupRef=function(t){if(-1==this._noCountGroupNames.indexOf(t)){var n=this.groupNameDic[t];n||(this.groupNameDic[t]=n={});var r=n.count;r?r+=1:r=1,n.count=r,e.LogUtil.log("LoaderManager.addGroupRef:",t,r)}},t.prototype.removeGroupRef=function(e){e in this.groupNameDic&&delete this.groupNameDic[e]},t.prototype.destoryGroup=function(t,n){void 0===n&&(n=!1);var r=this.groupNameDic[t];if(r){var o=r.count;if(o?o-=1:o=0,0>=o&&(o=0),r.count=o,0==o&&(r.livingTime=egret.getTimer(),n)){var i=RES.destroyRes(t);e.LogUtil.warn("强制释放 "+t+"  "+i),this.groupNameDic[t]=null,delete this.groupNameDic[t]}}},t.prototype.calGpuSizeTick=function(){var t=100;t>>=20,t>100&&(e.LogUtil.log("gpu size:",t),this.clearGroupTick())},t.prototype.clearGroupTick=function(){var t=egret.getTimer(),n=this.groupNameDic,r=this.maxLivingTime;for(var o in n){var i=n[o];if(0==i.count&&i.livingTime&&t-i.livingTime>r){var a=RES.destroyRes(o);e.LogUtil.warn("RES.destroyRes res:"+o+"  "+a),n[o]=null,delete n[o]}}e.ModuleManager.clearModuleTick(t,r),e.AnimateManager.getInstance().clear(t)},t}();e.LoaderManager=t,__reflect(t.prototype,"qmr.LoaderManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.startCheck=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return t=this,e.PlatformManager.instance.isOutNetPlatForm?[3,2]:(n=e.Handler.create(t,t.pullServerList),[4,e.GameLoadManager.instance.loadLoginViewRes()]);case 1:return r.sent(),e.ModuleManager.showModule(e.ModuleNameLogin.LOGIN_VIEW,n),[3,3];case 2:t.pullServerList(),r.label=3;case 3:return[2]}})})},t.reqConnectGameServer=function(){var t=this,n=function(){e.MarkPointManager.setPoint(e.PointEnum.POINT_4);var n=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,o;return __generator(this,function(i){return t=e.ServerListModel.instance.getServerVo(parseInt(e.GlobalConfig.sid)),t&&(e.GlobalConfig.sName=t.serverName),n=e.ServerListModel.instance.sid,r=e.GlobalConfig.uid+"",console.log("account:"+e.GlobalConfig.account+" ---- userName:"+r),e.GlobalConfig.account?(e.MarkPointManager.setPoint(e.PointEnum.POINT_5),e.LoginController.instance.reqLogin(e.GlobalConfig.account,n),[2]):(o="平台账号验证失败，请重新登录",e.ModuleManager.showModule(e.ModuleNameLogin.DISCONNECT_VIEW,{msg:o,code:-1},e.LayerConst.TIP,!0,!1),[2])})})};t.checkAccountValidity(e.Handler.create(t,n))};e.GameLoading.getInstance().setLoadingTip("登录中..."),e.Rpc.getInstance().connect(e.GlobalConfig.loginServer,e.GlobalConfig.loginPort,n,t)},t.pullServerList=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){return t=this,e.GlobalConfig.account&&""!=e.GlobalConfig.account?(e.MarkPointManager.loginBeforeSetPoint(e.PointEnum.GET_SERVER_LIST),n=e.PlatformManager.instance.platform.getPullServerListUrl(),console.log("服务器请求列表: "+n),e.HttpRequest.sendGet(n,function(n){return __awaiter(this,void 0,void 0,function(){var r,o;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),r=JSON.parse(n),console.log("拉取服务器列表成功:"+JSON.stringify(n)),e.GlobalConfig.serverList=r.sl,e.GlobalConfig.recentLoginServerList=r.my,e.ServerListController.instance.parseServerList(e.GlobalConfig.serverList),e.PlatformConfig.platformId!=e.PlatformEnum.P_6kwAndriod&&e.PlatformManager.instance.isOutNetPlatForm?[3,2]:[4,t.showLoginView()];case 1:return i.sent(),[3,3];case 2:t.pullRecentlyServerList(),i.label=3;case 3:return[3,5];case 4:return o=i.sent(),console.log("拉取服务器解析失败:"+o),[3,5];case 5:return[2]}})})},t),[2]):(console.error("账号为空"),e.TipManagerCommon.getInstance().createCommonColorTip("账号为空"),[2])})})},t.checkAccountValidity=function(t){return __awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(o){switch(o.label){case 0:return n=this,[4,e.PlatformManager.instance.platform.getCheckAccountValidityUrl(e.TimeUtil.serverTime)];case 1:return r=o.sent(),console.log("检测账号合法性请求: "+r),e.HttpRequest.sendGet(r,function(n){var r=JSON.parse(n);console.log("请求登陆服检测账户合法性验证回包:"+JSON.stringify(n)),r&&0==r.ret&&(console.log("请求登陆服检测账户合法性验证通过",r.sparam),e.PlatformManager.instance.platform.isVerify=!0,e.GlobalConfig.cdata=r.cdata,e.GlobalConfig.sparam=r.sparam,e.GlobalConfig.logintime=r.sparam.time,r.sparam&&r.sparam.clientip&&(e.GlobalConfig.clientIp=r.sparam.clientip,e.PlatformConfig.channelId=r.sparam.ChannelId),r.sparam&&r.sparam.account&&(e.GlobalConfig.account=String(r.sparam.account),console.log("返回账号替换:"+r.sparam.account)),t&&t.run())},n),[2]}})})},t.showLoginView=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.PlatformManager.instance.platform.setLoadingProgress(100),[4,e.GameLoadManager.instance.loadLoginViewRes()];case 1:return t.sent(),e.ModuleManager.showModule(e.ModuleNameLogin.LOGIN_VIEW),e.MarkPointManager.loginBeforeSetPoint(e.PointEnum.SHOW_SELECT_SERVER_VIEW),[2]}})})},t.pullRecentlyServerList=function(){var t=this,n=function(){return __awaiter(this,void 0,void 0,function(){var n,r,o,i;return __generator(this,function(a){switch(a.label){case 0:if(n="",r=e.ServerListModel.instance.recentLoginServerlist,r&&r.length>0)for(o=void 0,i=0;i<r.length;i++)o=r[i],n+="ip="+o.ip+",serverId="+o.serverId+",serverName="+o.serverName+",serverIndex="+o.serverIndex+";";return console.log("获取玩家最近登录的服务器列表：===》》》"+n),e.ServerListModel.instance.recentLoginServerlist.length>0?(e.GlobalConfig.isFirstNewUser=!1,[4,t.showLoginView()]):[3,2];case 1:return a.sent(),e.MarkPointManager.loginBeforeSetPoint(e.PointEnum.SHOW_SELECT_SERVER_VIEW),e.ModuleManager.popModule(e.ModuleNameLogin.GONGGAO_VIEW),[3,3];case 2:e.GlobalConfig.isFirstNewUser=!0,t.firstLoginByNewUser(),a.label=3;case 3:return[2]}})})};e.ServerListController.instance.pullMyLoginServerList(e.Handler.create(this,n))},t.firstLoginByNewUser=function(){return __awaiter(this,void 0,void 0,function(){var n,r,o,i;return __generator(this,function(a){return e.MarkPointManager.setPoint(e.PointEnum.POINT_2),n=null,n=e.ServerListModel.instance.recommendServer,console.log("最近服务器数据",n&&JSON.stringify(n)),n||(n=e.ServerListModel.instance.defaultServer,console.log("默认服务器数据",n&&JSON.stringify(n))),n?n.isWh?(e.TipManagerCommon.getInstance().createCommonColorTip("服务器维护中"),[2]):(e.GlobalConfig.sid=n.serverId+"",r=n.ip,o=n.port,i=new e.LoginInfoVo,i.loginServerIP=r,i.loginServerPort=o+"",egret.localStorage.setItem("testUserid",e.GlobalConfig.account),egret.localStorage.setItem("serverId",e.GlobalConfig.sid),e.PlatformManager.instance.platform.setLoadingProgress(100),e.PlatformManager.instance.platform.setLoadingStatus("精彩立即呈现"),e.MarkPointManager.setPoint(e.PointEnum.POINT_3),e.LoginModel.instance.setLoginIninfo(i),t.reqConnectGameServer(),[2]):(e.TipManagerCommon.getInstance().createCommonColorTip("请选择服务器"),[2])})})},t}();e.LoginManager=t,__reflect(t.prototype,"qmr.LoginManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.setPoint=function(t,n){void 0===n&&(n=!1),e.PlatformConfig.platformId==e.PlatformEnum.P_WX&&e.GlobalConfig.isFirstNewUser&&(this.MarkedPoints[t]||(this.MarkedPoints[t]=!0,e.PlatformConfig.platformId==e.PlatformEnum.P_WX&&aladin.AladinSDK.reportAnalytics(e.PlatformConfig.appIdStr+"",t),console.log("》》》游戏进度打点:"+t+"	"+egret.getTimer()+"ms")))},t.loginBeforeSetPoint=function(t,n){if(n||(n=""),e.PlatformConfig.isNeedMarkPoint){var r=e.PlatformManager.instance;if(!r.isGetPlatformInfo)return void console.log("平台sdk信息拉取不成功,禁止打点...");if(!this.markedPoint[t]){var o=encodeURI(e.PlatformConfig.platform),i=encodeURI(e.GlobalConfig.account),a=encodeURI(e.PlatformConfig.channelId),s=t,l=encodeURI(e.WebBrowerUtil.model),c=encodeURI(e.GlobalConfig.appVersion),u=encodeURI(e.GlobalConfig.clientIp),f=(new Date).getTime()/1e3|0,p=encodeURI(e.Md5Util.getInstance().hex_md5(""+o+i+u+s+f+e.GlobalConfig.qosKey)),g=r.platform.markPointUrlBeforeLogin+"?platform="+o+"&account="+i+"&channel="+a+"&type="+s+"&subtype="+n+"&device="+l+"&clientver="+c+"&clientip="+u+"&time="+f+"&sign="+p;console.log("登录前打点地址: "+g),e.HttpRequest.sendGet(g,function(e){console.log("登录前打点地址回包"+e)},this),this.markedPoint[t]=!0}}},t.loginSetPoint=function(t,n,r){if(void 0===n&&(n=!0),r||(r=""),(!n||e.GlobalConfig.isCreatRoleEnterGame)&&e.PlatformConfig.isNeedMarkPoint){var o=e.GlobalConfig.cdata;if(!o||!o.qosurl)return void console.log("服务端返回不再打点 point:",t);var i=e.PlatformManager.instance;if(!i.isGetPlatformInfo)return void console.log("平台sdk信息拉取不成功,禁止打点...");if(!this.markedPoint[t]){var a=encodeURI(e.PlatformConfig.platform),s=encodeURI(e.GlobalConfig.sid),l=encodeURI(e.PlatformConfig.channelId),c=encodeURI(e.GlobalConfig.account),u=t,f=encodeURI(e.WebBrowerUtil.model),p=encodeURI(e.GlobalConfig.appVersion),g=encodeURI(e.GlobalConfig.clientIp),d=(new Date).getTime()/1e3|0,h=encodeURI(e.Md5Util.getInstance().hex_md5(""+a+c+s+g+u+d+e.GlobalConfig.qosKey)),m=i.platform.markPointUrl+"?platform="+a+"&serverid="+s+"&channel="+l+"&account="+c+"&type="+u+"&subtype="+r+"&device="+f+"&clientver="+p+"&clientip="+g+"&time="+d+"&sign="+h;console.log("登录后打点："+m),e.HttpRequest.sendGet(m,function(e){console.log("登录后打点地址回包"+e)},this),this.markedPoint[t]=!0}}},t.markedPoint={},t.MarkedPoints={},t}();e.MarkPointManager=t,__reflect(t.prototype,"qmr.MarkPointManager");var n;!function(e){e[e.SDK_LOGIN=100]="SDK_LOGIN",e[e.GET_SERVER_LIST=101]="GET_SERVER_LIST",e[e.SHOW_SELECT_SERVER_VIEW=102]="SHOW_SELECT_SERVER_VIEW",e[e.START_GAME=103]="START_GAME",e[e.SHOW_CREAT_ROLE_VIEW=301]="SHOW_CREAT_ROLE_VIEW",e[e.CREAT_SUCCESS=302]="CREAT_SUCCESS",e[e.CREAT_FAIL=303]="CREAT_FAIL",e[e.LOAD_DEFAULT_RES=304]="LOAD_DEFAULT_RES",e[e.LOAD_COMMON_RES=305]="LOAD_COMMON_RES",e[e.FIRST_ENTER_GAME=401]="FIRST_ENTER_GAME",e[e.EVERY_ENTER_GAME=402]="EVERY_ENTER_GAME",e[e.POINT_2=2]="POINT_2",e[e.POINT_3=3]="POINT_3",e[e.POINT_4=4]="POINT_4",e[e.POINT_5=5]="POINT_5",e[e.POINT_6=6]="POINT_6",e[e.POINT_7=7]="POINT_7",e[e.POINT_8=8]="POINT_8",e[e.POINT_9=9]="POINT_9",e[e.POINT_10=10]="POINT_10",e[e.POINT_11=11]="POINT_11",e[e.POINT_12=12]="POINT_12",e[e.POINT_WX_LOAD_SKIN=13]="POINT_WX_LOAD_SKIN",e[e.POINT_WX_LOAD_CONFIG=14]="POINT_WX_LOAD_CONFIG",e[e.POINT_WX_LOAD_COMMON_RES=15]="POINT_WX_LOAD_COMMON_RES",e[e.POINT_WX_LOAD_COMPLETED=16]="POINT_WX_LOAD_COMPLETED",e[e.POINT_WX_CLICK_START_BTN=17]="POINT_WX_CLICK_START_BTN",e[e.POINT_WX_CLICK_RANDOM_BTN=18]="POINT_WX_CLICK_RANDOM_BTN",e[e.POINT_WX_CLICK_INPUTTEXT=19]="POINT_WX_CLICK_INPUTTEXT"}(n=e.PointEnum||(e.PointEnum={}))}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.timeKey=-1,e}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.initListeners=function(){this.addSocketListener(e.MessageIDLogin.S_SYNC_TIME,this.onRecsynSystem,this),this.addSocketListener(e.MessageIDLogin.S_EXCEPTION_MSG,this.onRecExceptionMsg,this,!0)},n.prototype.startHeart=function(){this.isStartSysn||(this.isStartSysn=!0,this.timeFlag=Date.now(),this.timeKey=egret.setInterval(this.reqgetSystemTime,this,8e3),this.reqgetSystemTime())},n.prototype.clearHeart=function(){this.isStartSysn=!1,-1!=this.timeKey&&(egret.clearInterval(this.timeKey),this.timeKey=-1)},n.prototype.reqgetSystemTime=function(){var t=new com.message.C_SYNC_TIME;this.sendCmd(t,e.MessageIDLogin.C_SYNC_TIME)},n.prototype.onRecsynSystem=function(t){e.TimeUtil.syncServerTime(parseInt(t.time.toString())),this.isSyncOne||(this.isSyncOne=!0,this.dispatch(e.NotifyConstLogin.SCNY_ONE_SERVER_TIME)),e.GlobalConfig.loginInitFinish&&!e.ServerClock.getInstance().isClockStart&&e.ServerClock.getInstance().startClock()},n.prototype.onRecExceptionMsg=function(t){var n=t.code;e.LogUtil.log("[错误码: "+n+"]");var r=e.ConfigManagerBase.getConf(e.ConfigEnumBase.CODECFG,n);r&&(1217==n?(e.Rpc.getInstance().close(),e.GameLoading.getInstance().close(),e.TipManagerCommon.getInstance().createCommonColorTip(r.msg)):1171==n?(this.dispatch(e.NotifyConstLogin.S_USER_LOGIN_REPEAT),e.TipManagerCommon.getInstance().createCommonColorTip(r.msg)):this.dispatch(e.NotifyConstLogin.S_ERROR_CODE,n)),!e.GlobalConfig.isCreatRoleEnterGame||1171!=n&&1172!=n&&1173!=n||e.MarkPointManager.loginSetPoint(e.PointEnum.CREAT_FAIL)},n}(e.BaseController);e.SystemController=t,__reflect(t.prototype,"qmr.SystemController")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.commonTipCdTime=500,this.commonMessInfo=[],this.commonMessInfoCanRepeat=[],this.isConmmoning=!1,this.isConmmoningCanRepeat=!1,this.commonTips=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.createCommonTip=function(e,t,n,r){void 0===t&&(t=16777215),void 0===n&&(n=0),void 0===r&&(r=null);for(var o=!1,i=0,a=this.commonMessInfo;i<a.length;i++){var s=a[i];if(s.mess==e){o=!0;break}}o||this.commonMessInfo.push({mess:e,color:t,yPos:n,itemcfg:r}),this.isConmmoning||(this.isConmmoning=!0,this.showCommonTip())},t.prototype.createCommonColorTip=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=0),void 0===r&&(r=null),this.createCommonTip(e,t?632328:16711680,n,r)},t.prototype.createCNTip=function(t,n,r){void 0===n&&(n=16777215),void 0===r&&(r=0);var o=e.ConfigManagerBase.getConf(e.ConfigEnumBase.CLIENTCN,t);if(o){var i=o.colerType;i>=0&&(n=e.ColorUtil.getTipColorByType(i)),this.createCommonTip(o.value,n,r,null)}},t.prototype.recycleCommonTip=function(e){this.commonTips.push(e)},t.prototype.showCommonTip=function(){var t=this;if(this.isConmmoning){var n=this.commonMessInfo.shift();if(n){var r=this.commonTips.shift();r||(r=new e.CommonTip),e.LayerManager.instance.addDisplay(r,e.LayerConst.TIP),r.showTip(n),egret.setTimeout(function(){t.commonMessInfo.length?t.showCommonTip():t.isConmmoning=!1},this,this.commonTipCdTime)}}},t.prototype.createCommonTipCanRepeat=function(e,t,n,r){void 0===t&&(t=16777215),void 0===n&&(n=0),void 0===r&&(r=null),this.commonMessInfoCanRepeat.push({mess:e,color:t,yPos:n,itemcfg:r}),this.isConmmoningCanRepeat||(this.isConmmoningCanRepeat=!0,this.showCommonTipCanRepeat())},t.prototype.createCommonColorTipCanRepeat=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=0),void 0===r&&(r=null),this.createCommonTipCanRepeat(e,t?632328:16711680,n,r)},t.prototype.showCommonTipCanRepeat=function(){var t=this;if(this.isConmmoningCanRepeat){var n=this.commonMessInfoCanRepeat.shift();if(n){var r=this.commonTips.shift();r||(r=new e.CommonTip),e.LayerManager.instance.addDisplay(r,e.LayerConst.TIP),r.showTip(n),egret.setTimeout(function(){t.commonMessInfoCanRepeat.length?t.showCommonTipCanRepeat():t.isConmmoningCanRepeat=!1},this,this.commonTipCdTime)}}},t}();e.TipManagerCommon=t,__reflect(t.prototype,"qmr.TipManagerCommon")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.initGameVersion=function(t){return __awaiter(this,void 0,void 0,function(){var n,r,o,i,a;return __generator(this,function(s){switch(s.label){case 0:return e.PlatformConfig.useCdnRes?t?(n=t.split("&"),1!=n.length?[3,2]:(r=void 0,o=void 0,r=n[0],o=r.split(":"),i=void 0,a=void 0,i=1==o.length?o[0]:o[1],a=i.split("/"),this.gameVersionDir=a[0],this.gameVersionNumber=a[1],this.isGameVersionReady=!0,[4,this.parseGameVersionList()])):(console.log("gameVersion undefined"),[2]):(this.isGameVersionReady=!0,[2]);case 1:return s.sent(),[3,3];case 2:this.isGameVersionReady=!1,s.label=3;case 3:return[2]}})})},t.initGameVersionByServer=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return this.isGameVersionReady?[2]:(this.parseGameVersion(e,t),this.isGameVersionReady=!0,[4,this.parseGameVersionList()]);case 1:return n.sent(),[2]}})})},t.parseGameVersionList=function(){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(r){return this.updateAppVersion(),[2,new Promise(function(r,o){var i=e.PlatformConfig.webUrl+t.gameVersionDir+"/"+t.gameVersionNumber+"/version.json";e.LogUtil.log("》》》加载版本控制文件："+i);var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.open(i,egret.HttpMethod.GET),a.send(),a.addEventListener(egret.Event.COMPLETE,function(e){var t=e.currentTarget,o=JSON.parse(t.response);n.versionConfig=o.verDic,n.defaultVer=o.defaultVer,r()},n),a.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){egret.log("post error : "+event),o()},n)})]})})},t.parseGameVersion=function(e,t){if(!t)return void console.log("gameVersion undefined");for(var n,r,o,i,a,s,l,c,u,f,p=t.split("&"),g="ver",d="1",h=p.length,m=0;h>m;m++){o=p[m],i=o.split(":");var _=!1;if(1==i.length?(_=!0,l=null,a=i[0]):(l=i[0],a=i[1]),s=a.split("/"),n=s[0],r=s[1],_&&(g=n,d=r),l){c=l.split(",");for(var v=0,y=c;v<y.length;v++)if(u=y[v],f=u.split("-").map(Number),1==f.length){if(e==f[0])return this.gameVersionDir=n,void(this.gameVersionNumber=r)}else if(e>=f[0]&&e<=f[1])return this.gameVersionDir=n,void(this.gameVersionNumber=r)}}this.gameVersionDir=g,this.gameVersionNumber=d,console.log("game module ver : serverId="+e+" ver="+this.gameVersionDir+" "+this.gameVersionNumber)},t.updateAppVersion=function(){var t=this.gameVersionDir.replace(/[^0-9]/gi,"");""==t&&(t="1"),e.GlobalConfig.appVersion=e.PlatformConfig.loginVersion+"."+t+"."+this.gameVersionNumber,console.log("appVersion:",e.GlobalConfig.appVersion)},t.parseLoginResVersion=function(e){if(e){var t=e.split(".");this.loginResVersion=t[1]}console.log("login module res ver = "+this.loginResVersion)},t.getPathWithGameVersion=function(n){var r=t.defaultVer;return t.versionConfig&&t.versionConfig[n]&&(r=t.versionConfig[n]),n=e.PlatformConfig.webUrl+t.gameVersionDir+"/"+r+"/"+n},t.loginResVersion="1",t.isGameVersionReady=!1,t}();e.VersionManager=t,__reflect(t.prototype,"qmr.VersionManager");var n=function(){function n(){}return n.prototype.init=function(){return Promise.resolve()},n.prototype.getVirtualUrl=function(t){return e.PlatformConfig.useCdnRes?this.getResUrlByVersion(t):t+"?v="+(new Date).getTime()},n.prototype.getResUrlByVersion=function(n){if(-1!=n.indexOf("eui_skins"))return n;var r,o=n.indexOf("resourceLogin/");if(o>=0)return n.replace("resourceLogin/","login/resourceLogin/"+t.loginResVersion+"/");var i=n.indexOf(e.PlatformConfig.baseRoot);if(-1==i)return n;var a=n.indexOf("?v=");return r=-1!=a?n.slice(i,a):n.slice(i),r=t.getPathWithGameVersion(r)},n}();e.VersionController=n,__reflect(n.prototype,"qmr.VersionController",["RES.IVersionController"])}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.clearModuleTick=function(t,n){for(var r=this,o=r._cacheAppMap,i=o.keys,a=0,s=i;a<s.length;a++){var l=s[a],c=o.get(l);c?c.isShow||c.getEffective(t,n)||(o.remove(l),e.LogUtil.warn("ModuleManager.clear "+l)):e.LogUtil.error("ModuleManager.cacheAppMap变成空了？？ "+l)}},t.popModule=function(n,r,o,i,a){void 0===r&&(r=null),void 0===o&&(o=e.LayerConst.ALERT),void 0===i&&(i=!1),void 0===a&&(a=!0),t.showModule(n,r,o,i,a),e.SoundManager.getInstance().loadAndPlayEffect("SOUND_TANCHU")},t.showModule=function(t,n,r,o,i,a,s,l){void 0===n&&(n=null),void 0===r&&(r=e.LayerConst.BASE_UI),void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===a&&(a=""),void 0===s&&(s=null),void 0===l&&(l=null);var c=this;if(e.GlobalConfig.isHideRecharge&&-1!=c.NO_RECHARGE_HIDE_VIEW.indexOf(t))return c.closeCurrentModule(),void e.TipManagerCommon.getInstance().createCommonColorTip("暂未开放充值！");var u=c.getAppByClass(t);if(u){if(u.preModule=l,u.name=t,u.closeOpenPanel=a,u.closeOpenPanelData=s,i&&u.isShow)return-1!=c._NO_TRIGGER_MODULE.indexOf(t)?void u.show(n):void c.hideModule(t);o&&c.closeAllWindow(),u.show(n),c._currView=u,(u.isNeedMask||u.isNeedAlpha0Mask)&&(r=e.LayerConst.MASK_UI,u.maskSprite||(u.maskSprite=c.addMask(r,u.isNeedAlpha0Mask)));var f=u.groupName;void 0!=f&&""!=f&&(f.match("_json")?e.ResManager.getRes(f,null,c):e.ResManager.loadGroup(f),e.LoaderManager.instance.addGroupRef(f)),u.layer=r,e.LayerManager.instance.getLayer(r).addChild(u),u.title&&u.updateTitle(u.title,u.ruleId),e.LogUtil.log("[openModule:"+t+"]"),e.NotifyManager.sendNotification(e.NotifyConstLogin.OPEN_PANEL_VIEW,t),e.NotifyManager.sendNotification(e.NotifyConstLogin.OPEN_PANEL_LAYER,r)}c.sendToTop()},t.isShowModule=function(e){var t=this._cacheAppMap.get(e);return t?t.isShow:!1},t.hideModule=function(t,n){void 0===n&&(n=!1);var r,o=this,i=t;if(t instanceof e.SuperBaseModule?(r=t,i=r.name):r=o._cacheAppMap.get(t),r){if(!r.isShow)return;n?r.hide():o.disposWin(r),r.closeOpenPanel&&o.showModule(r.closeOpenPanel,r.closeOpenPanelData)}e.NotifyManager.sendNotification(e.NotifyConstLogin.CLOSE_PANEL_VIEW,i)},t.closeAllWindow=function(){for(var t,n=this,r=e.LayerManager.instance.getLayer(e.LayerConst.BASE_UI);r.numChildren;)t=r.getChildAt(0),n.disposWin(t);for(r=e.LayerManager.instance.getLayer(e.LayerConst.MASK_UI);r.numChildren;)t=r.getChildAt(0),n.disposWin(t);for(r=e.LayerManager.instance.getLayer(e.LayerConst.SECOND_PAGE_UI);r.numChildren;)t=r.getChildAt(0),n.disposWin(t);for(r=e.LayerManager.instance.getLayer(e.LayerConst.ALERT);r.numChildren;)t=r.getChildAt(0),n.disposWin(t)},t.getCurrentView=function(){return this._currView},t.closeCurrentModule=function(){this._currView&&this.disposWin(this._currView)},t.getAppByClass=function(t){if(null==t)return null;var n=egret.getTimer(),r=this,o=r._cacheAppMap.get(t),i=e.LoaderManager.instance.maxLivingTime;if(null==o||!o.getEffective(n,i)){var a=r.getClassName(t);o=new a,r._cacheAppMap.set(t,o)}return o.useTime=n,o},t.getSuperBaseModuleByClass=function(e){var t=this._cacheAppMap.get(e);
return t&&t.stage?t:null},t.getComponentGlobalPoint=function(e,t){var n=this._cacheAppMap.get(e);return n?n.getComponentGlobalPoint(t):{x:0,y:0}},t.addMask=function(t,n){void 0===n&&(n=!1);var r=e.LayerMaskSprite.getLayerMaskSprite();return r.addMask(t,n),r},t.disposWin=function(t){t instanceof e.SuperBaseModule?(t.dispose(),t.maskSprite&&(t.maskSprite.tweenRemoveMask(),t.maskSprite=null),t.preModule&&t.preModule.parent&&(t.updateGuide(),t.preModule=null)):e.DisplayUtils.removeDisplay(t),this.sendToTop()},t.sendToTop=function(){var t=e.LayerManager.instance.getLayer(e.LayerConst.BASE_UI);e.NotifyManager.sendNotification(e.NotifyConstLogin.CLOSE_PANEL_LAYER,t.numChildren),this.sendToTopEvent()},t.sendToTopEvent=function(){e.NotifyManager.sendNotification(e.NotifyConstLogin.CHANGE_MODEL_VIEW)},t.deleteModule=function(e){this._cacheAppMap.remove(e)},t.setupClass=function(){var t=this;t.registerClass(e.ModuleNameLogin.LOGIN_VIEW,e.LoginView),t.registerClass(e.ModuleNameLogin.SELECT_SEVER_LIST_VIEW,e.ServerListSelectView),t.registerClass(e.ModuleNameLogin.DISCONNECT_VIEW,e.DisConnectView),t.registerClass(e.ModuleNameLogin.DISCONNECT_VIEW,e.DisConnectView),t.registerClass(e.ModuleNameLogin.GONGGAO_VIEW,e.GonggaoView),t.registerClass(e.ModuleNameLogin.GAME_LOADING_VIEW,e.GameLoadingView)},t.registerClass=function(e,t){this._classAppMap[e]=t},t.getClassName=function(e){return this._classAppMap[e]},t._classAppMap={},t._cacheAppMap=new e.Dictionary,t._NO_TRIGGER_MODULE=[],t.NO_RECHARGE_HIDE_VIEW=[],t.openPanelFromBattle=!1,t}();e.ModuleManager=t,__reflect(t.prototype,"qmr.ModuleManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.LOGIN_VIEW="qmr.LoginView",e.SELECT_SEVER_LIST_VIEW="qmr.ServerListSelectView",e.DISCONNECT_VIEW="qmr.DisConnectView",e.GONGGAO_VIEW="qmr.GonggaoView",e.CREATEROLE_VIEW="qmr.CreateRoleView",e.GAME_LOADING_VIEW="qmr.GameLoadingView",e.RECHARGE_GUILD="qmr.RechargeGuildView",e.FIRST_RECHARGE_VIEW="qmr.FirstRechargetView",e}();e.ModuleNameLogin=t,__reflect(t.prototype,"qmr.ModuleNameLogin")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"isOpenRecharge",{get:function(){return this.cdata?1==this.cdata.charge:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isHideRecharge",{get:function(){return t.checkHideRechargeFunc?t.checkHideRechargeFunc():!1},enumerable:!0,configurable:!0}),t.getBgName=function(){if(!t._bgName){t._bgName="cjbg1_jpg";var e=window.createRoleBgCover;if(e){var n=Number(e);switch(n){case 2:t._bgName="cjbg2_jpg";break;case 3:t._bgName="cjbg3_jpg"}}}return t._bgName},Object.defineProperty(t,"isSysIos",{get:function(){return"IOS"==egret.Capabilities.os.toUpperCase()},enumerable:!0,configurable:!0}),t.saveNewUser=function(){var n=t.account;n&&egret.localStorage.setItem(n,n),e.LogUtil.log("》》》存入新用户数据："+n)},t.reportLogData={},t.reportLogUrl="http://testmt.housepig.cn/xyws/",t.bIsShowSlowLog=!1,t.loginInitFinish=!1,t.isDebugF=!1,t.userId=0,t.signature="",t.unverifysvr=0,t.platLoginTime="",t.recentLoginServerList=[],t.loginProxyServer="h5liutingting7000.cn",t.isSDKLogout=!1,t.registerAccountHeroId=0,t.account="",t.token="",t.sid="1",t.loginKey="^SOLaMeMOBILE#2019!COMMONKEY24@^$^%(*9183098abcdhghhde",t.qosKey="SolGAmE2019QOSSecReTkeY#RewaRdSecRet^Ket%",t.loginServer="",t.isFirstNewUser=!1,t.appVersion="",t.clientIp="127.0.0.1",t.logintime=0,t}();e.GlobalConfig=t,__reflect(t.prototype,"qmr.GlobalConfig")}(qmr||(qmr={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.qmrSkinName="DisConnectSkin",e.isNeedMask=!0,e.isClickHide=!1,e.isCenter=!0,e}return __extends(n,t),n.prototype.initListener=function(){t.prototype.initListener.call(this),this.addEvent(this.btn_refresh,egret.TouchEvent.TOUCH_TAP,this.onRefresh,this)},n.prototype.onRefresh=function(){e.GameLoadingView.getInstance().closeVitureProgress(),e.PlatformManager.instance.platform.reloadGame()},n.prototype.initData=function(){t.prototype.initData.call(this);var e=this.data;e?(this.txt_tip.text=e.msg+"",this.txt_code.visible=!1,-1!=e.code&&(this.txt_code.text="错误码: "+e.code,this.txt_code.visible=!0)):(this.txt_tip.text="服务器链接不上",this.txt_code.text="请稍后重试")},n.prototype.dispose=function(){e.LogUtil.log("DisConnectView被释放了"),t.prototype.dispose.call(this)},n}(e.SuperBaseModule);e.DisConnectView=t,__reflect(t.prototype,"qmr.DisConnectView")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.qmrSkinName="GonggaoViewSkin",e.isNeedMask=!0,e}return __extends(n,t),n.prototype.initListener=function(){t.prototype.initListener.call(this),this.addClickEvent(this.btnClose,this.hide,this)},n.prototype.show=function(n){var r=this;t.prototype.show.call(this,n),this.labContent.textFlow=e.HtmlUtil.getHtmlString("正在获取数据...");var o=e.PlatformManager.instance.platform.NoticeUrl+"?platform="+e.PlatformConfig.platform;console.log("gonggao url=",o),e.HttpRequest.sendGet(o,function(t){if(t){e.LogUtil.log("gonggao typeof res=",typeof t),e.LogUtil.log("gonggao res=",t);var n=JSON.parse(t);e.LogUtil.log("gonggao json=",n),n.data?r.labContent.textFlow=e.HtmlUtil.getHtmlString(n.data):r.labContent.textFlow=e.HtmlUtil.getHtmlString("获取数据失败")}},this)},n}(e.SuperBaseModule);e.GonggaoView=t,__reflect(t.prototype,"qmr.GonggaoView")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e.vitureCount=0;var n=e;return n.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){n.hasEventListener(egret.Event.ENTER_FRAME)&&n.removeEventListener(egret.Event.ENTER_FRAME,n.runLoading,n)},n),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){n.setProgress(0,1),n.addEventListener(egret.Event.ENTER_FRAME,n.runLoading,n)},n),n.touchEnabled=!0,e}return __extends(n,t),n.prototype.onTouch=function(e){e.stopImmediatePropagation()},n.prototype.runLoading=function(e){this._loadingRun&&(this._loadingRun.rotation+=3)},n.getInstance=function(){return null==n.inttance&&(n.inttance=new n),n.inttance},n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.rect=new eui.Rect,this.rect.fillColor=0,this.rect.fillAlpha=.2,this.addChild(this.rect),this.rect.touchEnabled=!0,this.rect.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this._loadingRun=new eui.Image(RES.getRes("preloading_loading_png")),this.addChild(this._loadingRun),this._txProgress=new eui.Label,this.addChild(this._txProgress),this.updateSize()},n.prototype.updateSize=function(){this._loadingRun.verticalCenter=0,this._loadingRun.horizontalCenter=0,this._txProgress.verticalCenter=0,this._txProgress.horizontalCenter=0,this._txProgress.size=20,this.rect.width=e.StageUtil.stageWidth,this.rect.height=e.StageUtil.stageHeight},n.prototype.setProgress=function(t,n){e.LayerManager.instance.addDisplay(this,e.LayerConst.TOP),this._txProgress&&(this._txProgress.text=Math.round(t/n*100)+"%",0==t?(this.vitureCount=1,e.Ticker.getInstance().registerTick(this.onTimer,this,50)):e.Ticker.getInstance().unRegisterTick(this.onTimer,this))},n.prototype.onTimer=function(){this.vitureCount++,this.vitureCount<100&&(this._txProgress.text=Math.round(this.vitureCount)+"%")},n.prototype.setLoadingTip=function(t){e.Ticker.getInstance().unRegisterTick(this.onTimer,this),e.NotifyManager.registerNotify(e.StageUtil.STAGE_RESIZE,this.updateSize,this),e.LayerManager.instance.addDisplay(this,e.LayerConst.TOP),this._txProgress&&(this._txProgress.text=t)},n.prototype.close=function(){e.NotifyManager.unRegisterNotify(e.StageUtil.STAGE_RESIZE,this.updateSize,this),e.Ticker.getInstance().unRegisterTick(this.onTimer,this),this.parent&&this.parent.removeChild(this)},n}(eui.Group);e.GameLoading=t,__reflect(t.prototype,"qmr.GameLoading")}(qmr||(qmr={}));var qmr;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="GameLoadingProgressBarSkin",t.touchEnabled=t.touchChildren=!1,t}return __extends(t,e),t.prototype.showProgressRate=function(e,t){void 0===t&&(t=!1);var n=e;0>=n&&(n=0),n>=1&&(n=1);var r=528*n;egret.Tween.removeTweens(this.imgProgress),t?egret.Tween.get(this.imgProgress).to({width:r},300):this.imgProgress.width=r,this.imgCloud.x=r},t.prototype.setLoadingTip=function(e){this.labHint.text=e},t.prototype.dispose=function(){egret.Tween.removeTweens(this.imgProgress)},t}(eui.Component);e.GameLoadingProgressBar=t,__reflect(t.prototype,"qmr.GameLoadingProgressBar")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.currentProgress=0,e.maxProgress=100,e.fromProgressTotal=0,e.dProgressTotal=1,e.HREF="event_refresh_game",e.needAdaptStatusBar=!1,e.skinName="GameLoadingViewSkin",e.progressBar1.visible=!0,e.progressBar2.visible=!0,e}return __extends(n,t),n.getInstance=function(){return n._instance||(n._instance=e.ModuleManager.getAppByClass(e.ModuleNameLogin.GAME_LOADING_VIEW)),n._instance},n.getBgName=function(){return n.bgName||(Math.random()>=.5?n.bgName=n.bgArray[0]:n.bgName=n.bgArray[1]),n.bgName},n.prototype.initComponent=function(){t.prototype.initComponent.call(this);var n=" 刷新游戏";e.PlatformManager.instance.platform.canClearResCache&&(n=" 清除缓存");var r=e.HtmlUtil.getHtmlTextElement("若长时间加载不成功，请点击",16777215),o=e.HtmlUtil.getHtmlTextElement(n,3276588,!0,this.HREF,1918992,1);this.labRefresh.textFlow=r.concat(o),this.labRefresh.touchEnabled=!0},n.prototype.initListener=function(){t.prototype.initListener.call(this),this.addEvent(this.labRefresh,egret.TextEvent.LINK,this.onRefresh,this)},n.prototype.addedToStage=function(e){t.prototype.addedToStage.call(this,e),this.imgBg.source=n.getBgName()},n.prototype.showSelf=function(t,n,r,o,i){void 0===n&&(n=!0),void 0===r&&(r=0),void 0===o&&(o=1),void 0===i&&(i=!0),e.ModuleManager.isShowModule(e.ModuleNameLogin.GAME_LOADING_VIEW)||e.ModuleManager.showModule(e.ModuleNameLogin.GAME_LOADING_VIEW,null,e.LayerConst.MASK_UI,!1),this.setPrelMessage(t),this.fromProgressTotal>=.99&&(n=!1,i=!1),n?this.showVitureProgress():this.closeVitureProgress(),this.fromProgressTotal=r,this.dProgressTotal=o-r,this.updateTotalProgress(0,i)},n.prototype.hideSelf=function(){this.currentProgress=0,e.ModuleManager.isShowModule(e.ModuleNameLogin.GAME_LOADING_VIEW)&&e.ModuleManager.hideModule(e.ModuleNameLogin.GAME_LOADING_VIEW)},n.prototype.updateTotalProgress=function(e,t){void 0===t&&(t=!1),this.isShow&&(this.fromProgressTotal>=.99&&(this.closeVitureProgress(),t=!1),this.showTotalProgress(this.fromProgressTotal+e*this.dProgressTotal,t))},n.prototype.showVitureProgress=function(){var e=this;this.tid||(this.tid=setInterval(function(){e.updateAutoLoading()},50),this.updateAutoLoading())},n.prototype.closeVitureProgress=function(){this.tid&&(clearInterval(this.tid),this.tid=null),this.showPreProgress(1)},n.prototype.updateAutoLoading=function(){this.currentProgress<this.maxProgress?this.currentProgress+=10:this.currentProgress=0,this.showPreProgress(this.currentProgress/this.maxProgress)},n.prototype.onRefresh=function(t){e.PlatformManager.instance.platform.reloadGame(e.PlatformManager.instance.platform.canClearResCache)},n.prototype.setPrelMessage=function(e){this.progressBar1.setLoadingTip(e)},n.prototype.setTotalMessage=function(e){this.progressBar2.setLoadingTip(e)},n.prototype.showTotalProgress=function(e,t){void 0===t&&(t=!1),this.progressBar2.showProgressRate(e,t)},n.prototype.showPreProgress=function(e,t){void 0===t&&(t=!1),this.progressBar1.showProgressRate(e,t)},n.prototype.dispose=function(){this.currentProgress=0,this.closeVitureProgress(),t.prototype.dispose.call(this),e.LoaderManager.instance.destoryGroup("serverlist_loginBg_jpg")},n.bgArray=["loadingNiu_jpg","loadingYu_jpg"],n}(e.SuperBaseModule);e.GameLoadingView=t,__reflect(t.prototype,"qmr.GameLoadingView")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.initListeners=function(){var t=this;t.addSocketListener(e.MessageIDLogin.S_USER_LOGIN,t.onRecLoginSuccess,t,!0),t.addSocketListener(e.MessageIDLogin.S_USER_LOGOUT,t.onRecUseLoginOut,t,!0),t.addSocketListener(e.MessageIDLogin.S_SEND_SDK_DATA,t.onSdkReportResponse,t,!0)},n.prototype.reqLogin=function(t,n){void 0===n&&(n="1"),egret.log("登陆账号:"+t,"区服:"+n);var r=new com.message.C_USER_LOGIN;r.username=t,r.gameSite=n;var o=e.GlobalConfig.sparam;o&&(r.sparam=JSON.stringify(o)),this.sendCmd(r,e.MessageIDLogin.C_USER_LOGIN,!0)},n.prototype.reqLoginRegister=function(t,n,r,o){e.GlobalConfig.saveNewUser();var i=new com.message.C_LOGIN_REGISTER;i.username=t,i.gameSite=n,i.nickname=r,i.heroId=o;var a=e.GlobalConfig.sparam;a&&(i.sparam=JSON.stringify(a)),this.sendCmd(i,e.MessageIDLogin.C_LOGIN_REGISTER)},n.prototype.onRecLoginSuccess=function(t){e.SystemController.instance,e.LoginModel.instance.isReconnect?(e.SystemController.instance.startHeart(),e.GameLoading.getInstance().close(),e.PbGlobalCounter.maxReconnectCount=3,e.LogUtil.log("断线重连完成！！")):(e.LoginModel.instance.onRecLoginSuccess(t),this.dispatch(e.NotifyConstLogin.S_USER_LOGIN))},n.prototype.reqUserLogout=function(t){var n=new com.message.C_USER_LOGOUT;n.playerId=t,this.sendCmd(n,e.MessageIDLogin.C_USER_LOGOUT,!0)},n.prototype.onRecUseLoginOut=function(t){t.beKickOut?e.LoginModel.instance.isInstead=!0:e.LoginModel.instance.isDisconnect=!0,this.dispatch(e.NotifyConstLogin.S_USER_LOGOUT)},n.prototype.reqReconnect=function(){if(e.PlatformManager.instance.platform.isVerify){e.LoginModel.instance.isReconnect=!0;var t=e.ServerListModel.instance.sid;this.reqLogin(e.GlobalConfig.account,t)}},n.prototype.reqRelogin=function(){if(e.PlatformManager.instance.platform.isVerify){e.LoginModel.instance.isReconnect=!1;var t=e.ServerListModel.instance.sid;this.reqLogin(e.GlobalConfig.account,t)}},n.prototype.reportSdkPortRequest=function(t,n){var r=new com.message.C_SEND_SDK_DATA;r.reportStr=n,r.reportUrl=t,this.sendCmd(r,e.MessageIDLogin.C_SEND_SDK_DATA,!0)},n.prototype.onSdkReportResponse=function(e){console.log("sdk数据上报结果："+e.canUse)},n}(e.BaseController);e.LoginController=t,__reflect(t.prototype,"qmr.LoginController")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.onRecLoginSuccess=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return e.SystemController.instance.startHeart(),e.GlobalConfig.userId=parseFloat(t.playerId.toString()),[4,e.VersionManager.initGameVersionByServer(parseInt(e.GlobalConfig.sid),e.PlatformConfig.gameVersion)];case 1:return n.sent(),e.GlobalConfig.userId>0?(e.GlobalConfig.isCreatRoleEnterGame?(e.MarkPointManager.setPoint(e.PointEnum.POINT_9),e.MarkPointManager.loginSetPoint(e.PointEnum.CREAT_SUCCESS)):e.GlobalConfig.isFirstNewUser=!1,e.GameLoading.getInstance().close(),this.isEnterGame=!0,this.destoryLoginRes(),e.GameLoadManager.instance.loadGameResAfterLogin(),[4,e.GameLoadManager.instance.waitGameResLoaded()]):[3,3];case 2:return n.sent(),e.EntryAfterLogin.setup(),[3,5];case 3:return[4,e.GameLoadManager.instance.loadcreateRoleGroup()];case 4:n.sent(),e.EntryCreateRole.setup(),e.ModuleManager.showModule(e.ModuleNameLogin.CREATEROLE_VIEW),n.label=5;case 5:return[2]}})})},t.prototype.setLoginIninfo=function(t){e.GlobalConfig.loginProxyServer=t.proxyServer,e.GlobalConfig.loginPort=parseInt(t.loginServerPort+""),e.GlobalConfig.loginServer=t.loginServerIP,e.PlatformManager.instance.platform.initLoginServer()},t.prototype.destoryLoginRes=function(){var t=document.getElementById("preLoadBg");t&&t.parentNode&&t.parentNode.removeChild(t),e.ModuleManager.hideModule(e.ModuleNameLogin.GONGGAO_VIEW,!0),e.ModuleManager.hideModule(e.ModuleNameLogin.SELECT_SEVER_LIST_VIEW,!0),e.ModuleManager.hideModule(e.ModuleNameLogin.LOGIN_VIEW,!0),e.ModuleManager.hideModule(e.ModuleNameLogin.CREATEROLE_VIEW,!0)},t}();e.LoginModel=t,__reflect(t.prototype,"qmr.LoginModel")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._isLogin=!1,e.needAdaptStatusBar=!1,e.groupName="login",e}return __extends(n,t),n.prototype.initListener=function(){t.prototype.initListener.call(this),this.addClickEvent(this.btn_login,this.onStartLogin,this),this.addClickEvent(this.group_gonggao,this.onShowGonggao,this),this.addClickEvent(this.groupSwitchSDKAccount,this.onSwitchAccount,this),this.addEvent(this.g_select,egret.TouchEvent.TOUCH_TAP,this.onSelectServerList,this),e.LabelUtil.addInputListener(this.txt_account,this)},n.prototype.onSwitchAccount=function(){},n.prototype.addedToStage=function(n){t.prototype.addedToStage.call(this,n),this.groupSwitchSDKAccount.visible=!1,this.addEffect();var r=document.getElementById("gameLoading");r&&r.parentNode&&r.parentNode.removeChild(r);var o=document.getElementById("style");if(o&&o.parentNode&&o.parentNode.removeChild(o),e.PlatformConfig.platformId!=e.PlatformEnum.P_6kwAndriod){var i=document.getElementById("preIndexBg");i&&i.parentNode&&i.parentNode.removeChild(i)}e.PlatformManager.instance.platform.setLoadingStatus(""),this.imgBg.source="serverlist_loginBg_jpg",this.imgBg.addEventListener(egret.Event.COMPLETE,this.onBgResBack,this),this.group_gonggao.visible=e.PlatformConfig.isShowNotice,e.GameLoadManager.instance.loadGameResAfterLogin()},n.prototype.onBgResBack=function(){if(e.LogUtil.log("onBgResBack"),document&&document.getElementById("loaingMyBg")){var t=document.getElementById("loaingMyBg");t.style.display="none"}},n.prototype.addWindEffect=function(){var t=7e3;this.imgWindSlow.x=this.stage.stageWidth,this.imgWindFast.x=this.stage.stageWidth,this.imgWindMiddle.x=this.stage.stageWidth;var n=-this.imgWindSlow.width;e.LogUtil.log("this.imgWindSlow.width",this.imgWindSlow.width),egret.Tween.get(this.imgWindSlow,{loop:!0}).to({x:n},t),egret.Tween.get(this.imgWindFast,{loop:!0}).to({x:n},t/1.5),egret.Tween.get(this.imgWindMiddle,{loop:!0}).to({x:n},t/1.3)},n.prototype.createAvatar=function(){this.avatar=new e.BaseActor(e.SystemPath.roleUiPath,null,this,e.Status.IDLE),this.groupRoleMonkey.addChild(this.avatar),this.avatar.addPartAt(e.ActorPart.BODY,20100,0,-1)},n.prototype.addEffect=function(){this.createAvatar();var e=4e3;this.groupMonkey.y=0,egret.Tween.get(this.groupMonkey,{loop:!0}).to({y:40},e).to({y:0},e),this.addWindEffect()},n.prototype.onShowGonggao=function(){e.ModuleManager.popModule(e.ModuleNameLogin.GONGGAO_VIEW)},n.prototype.initData=function(){if(t.prototype.initData.call(this),this.handler=this.data,this.btn_login.enabled=!0,this.lbl_ver.text=e.GlobalConfig.appVersion,this.isOutNetPlatForm=e.PlatformManager.instance.isOutNetPlatForm,this.isOutNetPlatForm||!this.isOutNetPlatForm&&e.GlobalConfig.account){var n=null;if(n=e.ServerListModel.instance.recommendServer,n&&(this.txt_severmax.text=n.serverName),this.isOutNetPlatForm)n=e.ServerListModel.instance.defaultServer,n&&(e.GlobalConfig.sid=n.serverId+"");else{var r="";r=egret.localStorage.getItem("serverId")||"1",e.GlobalConfig.sid=r,n=e.ServerListModel.instance.getServerVo(parseInt(r))}n&&(this.txt_severname.text=n.serverName),this.currentState="publish",this.txt_severname.touchEnabled=!1,this.g_select.touchChildren=!1}else this.currentState="beforeLogin",this.txt_account.text=egret.localStorage.getItem("testUserid")},n.prototype.onStartLogin=function(t){if(void 0===t&&(t=!0),e.PlatformConfig.platformId==e.PlatformEnum.P_6kwAndriod&&e.GlobalConfig.isSDKLogout)return void e.TipManagerCommon.getInstance().createCommonColorTip("当前处于登出状态，请重新登录");if(!this.isOutNetPlatForm&&!e.GlobalConfig.account){var n=this.txt_account.text.trim();return 0==n.length?void e.TipManagerCommon.getInstance().createCommonColorTip("请输入用户名"):(e.GlobalConfig.account=n,e.MarkPointManager.loginBeforeSetPoint(e.PointEnum.SDK_LOGIN),this.handler&&(this.handler.run(),this.handler=null),void this.hide())}if(this.btn_login.enabled){e.MarkPointManager.loginBeforeSetPoint(e.PointEnum.START_GAME),this._isLogin=t;var r=e.ServerListModel.instance.getServerVo(parseInt(e.GlobalConfig.sid));if(!r)return void e.TipManagerCommon.getInstance().createCommonColorTip("请选择服务器");var o=r.ip,i=r.port,a=new e.LoginInfoVo;a.loginServerIP=o,a.loginServerPort=i+"",egret.localStorage.setItem("testUserid",e.GlobalConfig.account),egret.localStorage.setItem("serverId",e.GlobalConfig.sid),this.connectLoginServer(a)}},n.prototype.onSelectServerList=function(){e.ModuleManager.popModule(e.ModuleNameLogin.SELECT_SEVER_LIST_VIEW,this)},n.prototype.selectHandler=function(e){this.txt_severname.text=e},n.prototype.connectLoginServer=function(t){var n=e.ServerListModel.instance.getServerVo(parseInt(e.GlobalConfig.sid));return n.isWh?void e.TipManagerCommon.getInstance().createCommonColorTip("服务器维护中"):(e.LoginModel.instance.setLoginIninfo(t),this.lockBtn(),void e.LoginManager.reqConnectGameServer())},n.prototype.lockBtn=function(){var e=this;this.btn_login.enabled=!1,this.timeId=setTimeout(function(){e.btn_login.enabled=!0},3e3)},n.prototype.dispose=function(){t.prototype.dispose.call(this),e.LabelUtil.removeInputListener(this.txt_account,this),this.timeId&&(clearTimeout(this.timeId),this.timeId=null),egret.Tween.removeTweens(this.imgWindSlow),egret.Tween.removeTweens(this.imgWindFast),egret.Tween.removeTweens(this.imgWindMiddle),egret.Tween.removeTweens(this.groupMonkey),this.avatar&&this.avatar.dispos(),e.ModuleManager.deleteModule(e.ModuleNameLogin.GONGGAO_VIEW),e.ModuleManager.deleteModule(e.ModuleNameLogin.LOGIN_VIEW),e.ModuleManager.deleteModule(e.ModuleNameLogin.SELECT_SEVER_LIST_VIEW);var n=RES.destroyRes("login");e.LogUtil.log("RES.destroyRes,login=",n)},n}(e.LoginViewUI);e.LoginView=t,__reflect(t.prototype,"qmr.LoginView")}(qmr||(qmr={}));var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),qmr.EntryLogin.setup(this.stage)},t.frame=0,t.currentIndex=0,t}(eui.UILayer);__reflect(Main.prototype,"Main");var qmr;!function(e){var t=function(){function e(){}return e}();e.LoginInfoVo=t,__reflect(t.prototype,"qmr.LoginInfoVo")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.prototype.parseServerList=function(t){e.ServerListModel.instance.parseServerList(t)},t.prototype.pullMyLoginServerList=function(t){var n=e.PlatformManager.instance.platform;if(n){if(e.ServerListModel.isHasGetRecentLogin)return void(t&&t.run());var r=(e.PlatformConfig.isTSVersion?1:0,e.PlatformConfig.isTSVersion?n.tsLastLoginServerReqUrl:n.lastLoginServerReqUrl),o=(new Date).getTime(),i=e.Md5Util.getInstance().hex_md5(""+e.GlobalConfig.account+o+e.GlobalConfig.loginKey),a=r+"?account="+e.GlobalConfig.account+"&time="+o+"&sign="+i;console.log("请求用户最近登录的服务器列表：》》》"+a),e.HttpRequest.sendGet(a,function(n){var r=JSON.parse(n);console.log("请求用户最近登录的服务器列表数据：》》》"+JSON.stringify(n)),0==r.ret?r&&r.sl&&(e.ServerListModel.isHasGetRecentLogin=!0,e.ServerListModel.instance.parseMyRecentLogin(r.sl),t&&t.run()):t&&t.run()},this)}},Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t)},enumerable:!0,configurable:!0}),t}();e.ServerListController=t,__reflect(t.prototype,"qmr.ServerListController")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this._serverVoDic=new e.Dictionary,this._serverTabDic=new e.Dictionary,this._recentLoginServerlist=[]}return t.prototype.parseServerList=function(n){var r,o,i=this,a=n,s=0;this._serverTabDic.clear(),a.forEach(function(n,a){r=new e.ServerVo,r.parseData(n,a+1),s=a/t.tabServerNum|0,o=i._serverTabDic.get(s),a+=1,o||(o=[],i._serverTabDic.set(s,o)),o.push(r),i._serverVoDic.set(r.serverId,r)})},t.prototype.parseMyRecentLogin=function(e){var t=this,n=e;if(n){var r,o=this;n.forEach(function(e){r=o.getServerVo(e.id),r&&t._recentLoginServerlist.push(r)})}},t.prototype.getTabServerList=function(e){return this._serverTabDic.get(e)},Object.defineProperty(t.prototype,"serverTabDic",{get:function(){return this._serverTabDic},enumerable:!0,configurable:!0}),t.prototype.getServerVo=function(e){return this._serverVoDic.get(e)},t.prototype.getServerName=function(n){var r=t.instance.getServerVo(parseInt(e.GlobalConfig.sid));return r?r.serverName:""},Object.defineProperty(t.prototype,"recentLoginServerlist",{get:function(){return this._recentLoginServerlist},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultServer",{get:function(){var e=this.recentLoginServerlist[0];if(e)return e;var t=egret.localStorage.getItem("serverId");return e=this.getServerVo(parseInt(t)),e?e:this.recommendServer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recommendServer",{get:function(){var e=this._serverVoDic.values;return e[e.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sid",{get:function(){var t=e.GlobalConfig.sid;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t)},enumerable:!0,configurable:!0}),t.tabServerNum=10,t.isHasGetRecentLogin=!1,t}();e.ServerListModel=t,__reflect(t.prototype,"qmr.ServerListModel");var n;!function(e){e[e.STATE1=1]="STATE1",e[e.STATE2=2]="STATE2",e[e.STATE3=3]="STATE3"}(n=e.ServerStateEnum||(e.ServerStateEnum={}))}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.isNeedMask=!0,e}return __extends(n,t),n.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.listServer.itemRenderer=e.ServerRender,this.collect=new eui.ArrayCollection,this.listServer.dataProvider=this.collect,this.tabCollect=new eui.ArrayCollection,this.updateTab()},n.prototype.initListener=function(){t.prototype.initListener.call(this),this.addEvent(this.tab_server,egret.Event.CHANGE,this.onTabarChanage,this),this.addEvent(this.listServer,eui.ItemTapEvent.ITEM_TAP,this.onClickItem,this),this.addClickEvent(this.btnClose,this.hide,this)},n.prototype.initData=function(){t.prototype.initData.call(this),this.tab_server.selectedIndex=0,this.onTabarChanage()},n.prototype.updateTab=function(){var e=this.convertData();this.tab_server.dataProvider=this.tabCollect,this.tabCollect.source=e},n.prototype.onTabarChanage=function(){var t;0==this.tab_server.selectedIndex?(this.collect.source=null,this.reqMyLoginServerList()):t=e.ServerListModel.instance.getTabServerList(this.tab_server.selectedIndex-1),t&&(this.collect.source=t)},n.prototype.reqMyLoginServerList=function(){var t=function(){this.collect.source=e.ServerListModel.instance.recentLoginServerlist};e.ServerListController.instance.pullMyLoginServerList(e.Handler.create(this,t))},n.prototype.onClickItem=function(t){var n=t.item;e.GlobalConfig.sid=n.serverId+"";var r=n.serverName,o=this.data;o&&o.selectHandler(r),this.hide()},n.prototype.convertData=function(){var t=[],n=e.ServerListModel.instance.serverTabDic;t.push({label:"我的区服"});var r=n.keys.sort(function(e,t){return t-e});return r.forEach(function(r){var o=n.get(r);if(o){var i=r*e.ServerListModel.tabServerNum+1,a=i+(e.ServerListModel.tabServerNum-1),s=i+"-"+a+"区";t.push({label:s})}}),t},n}(e.ServerListSelectUI);e.ServerListSelectView=t,__reflect(t.prototype,"qmr.ServerListSelectView")}(qmr||(qmr={}));var qmr;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ServerItemSkin",t}return __extends(t,e),t.prototype.dataChanged=function(){this.imgMark.visible=!1;var e=this.data;this.imgState.source=this.getStateIcon(),this.labServerNum.text=this.data.serverIndex+"区",this.labServerName.text=e.serverName,e.isNewServer?(this.imgMark.visible=!0,this.imgMark.source="serverlist_biao_png"):e.isHot&&(this.imgMark.visible=!0,this.imgMark.source="serverlist_biao2_png")},t.prototype.getStateIcon=function(){return this.data.isWh?"serverlist_ui_fwq_wh_png":this.data.isNewServer?"serverlist_ui_ty_ld_png":"serverlist_common_dian_png"},t}(eui.ItemRenderer);e.ServerRender=t,__reflect(t.prototype,"qmr.ServerRender")}(qmr||(qmr={}));var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var qmr;!function(e){var t=function(){function e(){}return e.prototype.parseData=function(e,t){this._serverId=e.id,this.serverIndex=t,this._ip=e.ip,this._port=e.pp,this._serverName=e.nm,this._openServerTime=e.tm,e.xf&&(this._isNewServer=1==e.xf),this._isWh=1==e.wh,this._isHot=1==e.hr},Object.defineProperty(e.prototype,"serverId",{get:function(){return this._serverId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ip",{get:function(){return this._ip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverName",{get:function(){return this._serverName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openServerTime",{get:function(){return this._openServerTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNewServer",{get:function(){return this._isNewServer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWh",{get:function(){return this._isWh},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHot",{get:function(){return this._isHot},enumerable:!0,configurable:!0}),e}();e.ServerVo=t,__reflect(t.prototype,"qmr.ServerVo")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.init=function(){var e,t=this;for(var n in t)e=t[n],t.MSG_KEYS.set(e,n)},t.getMsgNameById=function(e){return t.MSG_KEYS.get(e)},t.MSG_KEYS=new e.Dictionary,t.S_EXCEPTION_MSG=900,t.C_USER_LOGIN=1001,t.S_USER_LOGIN=1002,t.C_LOGIN_REGISTER=1005,t.C_USER_LOGOUT=1007,t.S_USER_LOGOUT=1008,t.C_SYNC_TIME=2101,t.S_SYNC_TIME=2102,t.C_SEND_SDK_DATA=1032,t.S_SEND_SDK_DATA=1033,t}();e.MessageIDLogin=t,__reflect(t.prototype,"qmr.MessageIDLogin")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.msgIdMap={},this.msgIdMap[e.MessageIDLogin.S_EXCEPTION_MSG]=com.message.S_EXCEPTION_MSG,this.msgIdMap[e.MessageIDLogin.S_USER_LOGIN]=com.message.S_USER_LOGIN,this.msgIdMap[e.MessageIDLogin.S_USER_LOGOUT]=com.message.S_USER_LOGOUT,this.msgIdMap[e.MessageIDLogin.C_SYNC_TIME]=com.message.C_SYNC_TIME,this.msgIdMap[e.MessageIDLogin.S_SYNC_TIME]=com.message.S_SYNC_TIME,this.msgIdMap[e.MessageIDLogin.C_SEND_SDK_DATA]=com.message.C_SEND_SDK_DATA,this.msgIdMap[e.MessageIDLogin.S_SEND_SDK_DATA]=com.message.S_SEND_SDK_DATA}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t}();e.ProtoMsgIdMapLogin=t,__reflect(t.prototype,"qmr.ProtoMsgIdMapLogin")}(qmr||(qmr={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function o(e){t.call(r,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(r))
}var a=this;if("undefined"!=typeof generateEUI)qmr.LogUtil.log("[url:"+e+"]"),egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var l=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(l,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(r,generateJSON.paths[e])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var qmr;!function(e){var t=function(){function e(){}return e.registerNotify=function(t,n,r){var o=e.typeDic,i=o[t];if(i){for(var a=!1,s=0,l=i;s<l.length;s++){var c=l[s];if(c.callback==n&&c.thisObject==r){a=!0;break}}a||(i.push({callback:n,thisObject:r}),o[t]=i)}else o[t]=[{callback:n,thisObject:r}]},e.unRegisterNotify=function(t,n,r){var o=e.typeDic[t];if(o){for(var i=0,a=o;i<a.length;i++){var s=a[i];if(s.callback==n&&s.thisObject==r){var l=o.indexOf(s);-1!=l&&o.splice(l,1);break}}0==o.length?delete e.typeDic[t]:e.typeDic[t]=o}},e.unRegisterNotifyByType=function(t){delete e.typeDic[t]},e.hasNotification=function(t){var n=e.typeDic[t];return n?n.length>0:!1},e.sendNotification=function(t,n){void 0===n&&(n=null);var r=e.typeDic[t];if(r)for(var o=r.length,i=void 0,a=o-1;a>=0;a--)i=r[a],i&&i.callback&&i.callback.call(i.thisObject,n)},e.sendNotificationSplit=function(t,n){void 0===n&&(n=null);var r=e.typeDic[t],o=[];if(r){for(var i=r.length,a=void 0,s=i-1;s>=0;s--)a=r[s],a&&a.callback&&(o[s]||(o[s]={}),o[s].callback=a.callback,o[s].thisObject=a.thisObject,o[s].params=a.params);e.splitTypeDic.push(o)}},e.removeThisObjectNofity=function(t){var n=e.typeDic;for(var r in n){for(var o=n[r],i=o.length-1;i>=0;i--)o[i].thisObject==t&&o.splice(i,1);0==o.length?delete n[r]:n[r]=o}},e.test=function(){console.warn("NotifyManager.typeDic=======================================================>"),console.warn(e.typeDic),console.warn("egret.ticker=======================================================>"),console.warn(egret.ticker)},e.typeDic={},e.splitTypeDic=[],e.logDic={},e}();e.NotifyManager=t,__reflect(t.prototype,"qmr.NotifyManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.setModel=function(e,t){this._guildModel=e,this._heroModel=t},Object.defineProperty(e.prototype,"ownGuildId",{get:function(){var e=0;return this._guildModel&&(e=this._guildModel.ownGuildId),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guildName",{get:function(){var e="";return this._guildModel&&(e=this._guildModel.guildName),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playerId",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.playerId),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){var e="";return this._heroModel&&(e=this._heroModel.name),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"money",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.money),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.level),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diamond",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.diamond),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vipLevel",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.vipLevel),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createTime",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.createTime),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightVal",{get:function(){var e=0;return this._heroModel&&(e=this._heroModel.fightVal),e},enumerable:!0,configurable:!0}),e}();e.ClientHelper=t,__reflect(t.prototype,"qmr.ClientHelper")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.init=function(){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:if(n=window.GAME_CONFIG,!n)throw new Error("platfrom config is not define");return this.GAME_CONFIG=n,this.platformId=Number(n.platformId),this.channelId=n.channelId,this.isNeedMarkPoint=n.isMarkPoint,this.isTSVersion=!!Number(n.isTSVersion),n.isWSS&&(this.isWSS=!!Number(n.isWSS)),this.isShildTSV=!!Number(n.isShildTSV),this.isShieldIOSBusiness=!!Number(n.isShieldIOSBusiness),this.isOpenGM=!!Number(Number(n.isOpenGM)),this.loginVersion=n.loginVersion,this.gameVersion=n.gameVersion,this.isDebug=!!Number(n.isDebug),this.extendsParams=n.extendsParams,this.platformClassType=n.platformClassType,this.useCdnRes=!!Number(n.isPublish),this.baseRoot=n.basePath,this.webUrl=n.resPath,this.webRoot=this.webUrl+this.baseRoot,n.isShowNotice&&(this.isShowNotice=!!Number(n.isShowNotice)),n.max_hw_ratio&&(e.StageUtil.MAX_HW_RATIO=Math.min(e.StageUtil.MAX_HW_RATIO,n.max_hw_ratio)),n.min_hw_ratio&&(e.StageUtil.MIN_HW_RATIO=Math.max(e.StageUtil.MIN_HW_RATIO,n.min_hw_ratio)),this.appIdStr=n.appId,this.appKey=n.appKey,this.platform=n.platform,this.platformSign=n.platformSign,this.serverDomain=n.serverDomain,this.ts_serverDomain=n.ts_serverDomain,this.markPointDomain=n.markPointServer,this.ossDoamin=n.ossServer,e.GlobalConfig.appVersion=t.loginVersion,e.VersionManager.parseLoginResVersion(this.loginVersion),[4,e.VersionManager.initGameVersion(this.gameVersion)];case 1:return r.sent(),[2]}})})},t.GAME_CONFIG=null,t.platformId=0,t.channelId="0",t.isNeedMarkPoint=!0,t.isTSVersion=!1,t.isShildTSV=!1,t.isShieldIOSBusiness=!1,t.isOpenGM=!1,t.isShowNotice=!0,t.isWSS=!0,t.extendsParams="",t.useCdnRes=!1,t.baseRoot="",t.webUrl="",t.webRoot="",t}();e.PlatformConfig=t,__reflect(t.prototype,"qmr.PlatformConfig")}(qmr||(qmr={}));var qmr;!function(e){var t;!function(e){e[e.P_SLOGAME_DEBUG=0]="P_SLOGAME_DEBUG",e[e.P_SLOGAME_WEB=100]="P_SLOGAME_WEB",e[e.P_DYHY_IOS=6]="P_DYHY_IOS",e[e.P_DYHY_QUICK=7]="P_DYHY_QUICK",e[e.P_DYHY_MK=8]="P_DYHY_MK",e[e.P_XIYOU_SQQ=9]="P_XIYOU_SQQ",e[e.P_DYHY_IOS_WEB=10]="P_DYHY_IOS_WEB",e[e.P_WX=11]="P_WX",e[e.P_DYHY_IOS_WEB_crown=120]="P_DYHY_IOS_WEB_crown",e[e.P_6kwAndriod=130]="P_6kwAndriod",e[e.P_9377=12]="P_9377",e[e.P_7477=13]="P_7477",e[e.P_XIYOU_H5=14]="P_XIYOU_H5",e[e.P_YMXK=15]="P_YMXK",e[e.P_OPPO=16]="P_OPPO",e[e.L_CAT=1e3]="L_CAT"}(t=e.PlatformEnum||(e.PlatformEnum={}))}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.creatPlatform=function(t){var n;switch(t){case e.PlatformEnum.P_SLOGAME_DEBUG:n=new e.SolGamePlatform;break;case e.PlatformEnum.P_DYHY_IOS:n=new e.SolGamePlatform;break;case e.PlatformEnum.P_DYHY_QUICK:n=new e.SolGamePlatform;break;case e.PlatformEnum.P_DYHY_MK:n=new e.SolGamePlatform;break;case e.PlatformEnum.P_DYHY_IOS_WEB:n=new e.SolGamePlatform;break;case e.PlatformEnum.L_CAT:n=new e.SolGamePlatform;break;case e.PlatformEnum.P_XIYOU_SQQ:n=new e.XiyouSQQPlatform;break;case e.PlatformEnum.P_WX:n=new e.XiyouXWPlatform;break;case e.PlatformEnum.P_9377:n=new e.Pf9377Platform;break;case e.PlatformEnum.P_7477:n=new e.Pf7477Platform;break;case e.PlatformEnum.P_XIYOU_H5:n="apk"==e.PlatformConfig.platformClassType?new e.XiyouApkPlatform:new e.XiyouH5Platform;break;case e.PlatformEnum.P_YMXK:n=new e.PlatformYMXK;break;case e.PlatformEnum.P_OPPO:n=new e.PlatformOppo;break;default:throw new Error("platform not case at PlatformFactory.creatPlatform")}return n},t}();e.PlatformFactory=t,__reflect(t.prototype,"qmr.PlatformFactory")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this._platform=e.PlatformFactory.creatPlatform(e.PlatformConfig.platformId)}return t.prototype.reportRegister=function(){this.platform.reportRegister()},t.prototype.reportLogin=function(){this.platform.reportLogin()},t.prototype.reqPay=function(t){return e.GlobalConfig.isOpenRecharge?void this.platform.reqPay(t):void e.TipManagerCommon.getInstance().createCommonColorTip("暂未开放充值！")},t.prototype.reportUpLevel=function(){this.platform.reportUpLevel()},t.prototype.shareGame=function(e,t,n){this.platform.shareGame(e,t,n)},Object.defineProperty(t.prototype,"platform",{get:function(){return this._platform},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOutNetPlatForm",{get:function(){return e.PlatformConfig.platformId!=e.PlatformEnum.P_SLOGAME_DEBUG},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGetPlatformInfo",{get:function(){return this.platform.isGetPlatformInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t)},enumerable:!0,configurable:!0}),t}();e.PlatformManager=t,__reflect(t.prototype,"qmr.PlatformManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.ORDER_URL="{0}//{1}/api/{2}.orderid_{3}.php",e.SVRLISTOP_URL="{0}//{1}/api/{2}.svrlist_{3}.php",e.TS_SVRLISTOP_URL="{0}//{1}/api/{2}.svrlist_{3}_ts.php",e.QUERY_URL="{0}//{1}/api/{2}.query_{3}.php",e.FORBIDDEN_URL="{0}//{1}/api/{2}.forbidden_{3}.php",e.LASTLOGIN_URL="{0}//{1}/api/{2}.lastlogin_{3}.php",e.LOGIN_URL="{0}//{1}/api/{2}.login_{3}.php",e.WORD_URL="{0}//{1}/api/dirtycli.php",e.NOTICE_URL="{0}//{1}/api/gm/getserver_notice.php",e.VERIFY_URL="{0}//{1}/api/{2}.validation.php",e}();e.PlatformUrlConsont=t,__reflect(t.prototype,"qmr.PlatformUrlConsont")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,e}return __extends(n,t),n.prototype.initGetOption=function(){var t=this;t.uid=decodeURI(e.JsUtil.getQueryStringByName("uid")),e.PlatformConfig.appIdStr=e.JsUtil.getQueryStringByName("appid"),t.username=decodeURI(e.JsUtil.getQueryStringByName("username")),t.serverid=decodeURI(e.JsUtil.getQueryStringByName("serverid")),t.isadult=decodeURI(e.JsUtil.getQueryStringByName("isadult")),t.time=e.JsUtil.getQueryStringByName("time"),t.sign=e.JsUtil.getQueryStringByName("sign"),t.pf=e.JsUtil.getQueryStringByName("platform"),console.log("网页传过来的参数：》》》"+location.search),t.platformSing2=e.JsUtil.getValueFromParams("platformSing2",e.PlatformConfig.extendsParams),console.log("获取网页传参：》》》"+t.uid,t.username,e.PlatformConfig.appIdStr,t.serverid,t.platformSing2,t.sign),t.pf&&(t.platformSing2=t.pf),e.GlobalConfig.account=t.username,e.GlobalConfig.uid=t.uid},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return egret.log("平台登陆"),t=this,[2,new Promise(function(n,r){var o=function(t){var r=JSON.parse(t);console.log("sdk登录返回："+r),0==r.ret?(this.isGetPlatformInfo=!0,egret.log("sdk登录成功:"+status)):e.TipManagerCommon.getInstance().createCommonColorTip("sdk登录失败："+r.msg),n()},i=t.uid,a=encodeURI(t.username),s=e.PlatformConfig.appIdStr,l=t.sign,c=t.pf,u=t.serverid,f=t.isadult,p=t.time,g=t.verifyUrl+"?uid="+i+"&account="+a+"&appid="+s+"&sign="+l+"&platform="+c+"&serverId="+u+"&isadult="+f+"&time="+p;console.log("请求sdk登录："+g),e.HttpRequest.sendGet(g,o,t)})]})})},n.prototype.logout=function(){},n.prototype.getCheckAccountValidityUrl=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,l,c,u,f,p;return __generator(this,function(g){return t=e.GlobalConfig.account,n=this.time,r=n,o=e.GlobalConfig.sid,i=0,a=e.Md5Util.getInstance().hex_md5(encodeURI(t)+o+r+n+e.GlobalConfig.loginKey),s=e.WebBrowerUtil.model||"none",l=this.uid,c=this.sign,u=e.PlatformConfig.appIdStr,f=this.platformSing2,p=this.isadult,[2,this.loginServerUrl+"?account="+t+"&token="+r+"&time="+n+"&serverId="+o+"&unverifysvr="+i+"&sign="+a+"&clientVer="+e.GlobalConfig.appVersion+"&deviceUID="+s+"&uid="+l+"&appid="+u+"&psign="+c+"&pplatform="+f+"&isadult="+p]})})},n.prototype.reportRegister=function(){this.reportUpLevel(),this.reportEnterRole()},n.prototype.reportLogin=function(){this.reportEnterRole()},n.prototype.reportUpLevel=function(){var t=this,n={uid:t.uid,username:t.username,role:e.ClientHelper.instance.name,platform:t.platformSing2,appid:e.PlatformConfig.appIdStr,sid:t.serverid,level:e.ClientHelper.instance.level},r=JSON.stringify(n),o="https://m.7477.com/wap/openapi/update_role";e.LoginController.instance.reportSdkPortRequest(o,r)},n.prototype.reportEnterRole=function(){},n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("请求充值服生成订单号回包: "+JSON.stringify(e));var r=JSON.parse(e);n.orderResultData=r,r&&0==r.ret&&(n.orderId=r.orderId,console.log("请求充值服生成订单号成功:"+n.orderId),n.pay(t))},o=e.GlobalConfig.account,i=e.GlobalConfig.sid,a=e.PlatformConfig.channelId,s=t.id,l=e.GlobalConfig.uid,c=Math.round(e.TimeUtil.serverTime/1e3),u=e.PlatformConfig.appIdStr,f=n.platformSing2,p=e.Md5Util.getInstance().hex_md5(encodeURI(o)+i+a+c+s+e.GlobalConfig.loginKey),g=n.rechargeOrderIdServer+"?account="+o+"&serverId="+i+"&channelId="+a+"&productId="+s+"&time="+c+"&uid="+l+"&appid="+u+"&pplatform="+f+"&sign="+p;console.log("请求充值服生成订单号: "+g),e.HttpRequest.sendGet(g,r,n)},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(r){return[2,new Promise(function(r,o){var i=n;e.Md5Util.getInstance().hex_md5(e.PlatformConfig.appIdStr+e.ClientHelper.instance.level+i.platformSing2+i.time+i.uid+i.username+e.PlatformConfig.appKey),t.level;console.log("======================》》》7477获取的后台json数据："+JSON.stringify(i.orderResultData.content));var a=i.orderResultData.content,s=e.PlatformConfig.channelId+"@"+t.id+"@@"+a.out_orderid+"@"+a.serverid;console.log("=============================9377透传参数》》》"+a);var l="https://m.7477.com/wap/pay?uid="+a.uid+"&username="+a.username+"&paymoney="+a.paymoney+"&appid="+a.appid+"&serverid="+a.serverid+"&platform="+a.platform+"&time="+a.time+"&out_orderid="+a.out_orderid+"&goods_name="+encodeURI(t.name)+"&param="+s+"&sign="+a.sign;console.log("============================================》》》7477充值接口地址："+l),window.tc_iframe&&window.tc_iframe(l)})]})})},n}(e.BasePlatform);e.Pf7477Platform=t,__reflect(t.prototype,"qmr.Pf7477Platform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,e}return __extends(n,t),n.prototype.initGetOption=function(){var t=this;e.PlatformConfig.platformSign=e.PlatformConfig.platform+"",t.packName=e.JsUtil.getValueFromParams("packName",e.PlatformConfig.extendsParams),t.username=decodeURI(e.JsUtil.getQueryStringByName("username")),t.adult=decodeURI(e.JsUtil.getQueryStringByName("adult")),t.timestamp=e.JsUtil.getQueryStringByName("timestamp"),t.sign=e.JsUtil.getQueryStringByName("sign");var n=e.JsUtil.getQueryStringByName("gameid");n&&(e.PlatformConfig.appIdStr=n);var r=function(e){console.log("》》》收到网页内嵌消息："+e.origin,e.source,e.data)};window.addEventListener("message",r,!1),e.GlobalConfig.account=e.GlobalConfig.uid=t.username;var o=e.Md5Util.getInstance().hex_md5("gameid=44044&type=1&uid="+e.GlobalConfig.account+"&key=a25959454254c4501bb316ba4cec3859"),i="https://s.9377.com/h5/union_platform/report.php?platformId=10138&event_type=aiweiyou_chat&uid="+e.GlobalConfig.account+"&touid=&type=1&gameid=44044&sign="+o;e.HttpRequest.sendGet(i,t.getPlatUid,t),console.log("》》》获取网页传参："+t.username,t.adult,t.timestamp,t.sign)},n.prototype.getPlatUid=function(e){var t=this,n=JSON.parse(e);console.log("》》》拉取用户渠道编号："+n),n&&n.gameid&&(t.uid=n.uid,t.touid=n.touid,t.gameId=n.gameid,t.gameSign=n.sign)},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return egret.log("》》》平台登陆"),[2,new Promise(function(t,n){e.isGetPlatformInfo=!0,egret.log("》》》平台登陆成功:"+status),t()})]})})},n.prototype.logout=function(){},n.prototype.getPullServerListUrl=function(){var t=this,n=e.PlatformConfig.isTSVersion?t.tsServerListServer:t.serverListServer;return n+"?account="+e.GlobalConfig.account},n.prototype.getCheckAccountValidityUrl=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return __generator(this,function(l){return t=e.GlobalConfig.account,n=this.timestamp,r=n,o=e.GlobalConfig.sid,i=0,a=e.Md5Util.getInstance().hex_md5(encodeURI(t)+o+r+n+e.GlobalConfig.loginKey),s=e.WebBrowerUtil.model||"none",[2,this.loginServerUrl+"?account="+t+"&token="+r+"&time="+n+"&serverId="+o+"&unverifysvr="+i+"&sign="+a+"&clientVer="+e.GlobalConfig.appVersion+"&deviceUID="+s]})})},n.prototype.reportRegister=function(){this.reportRoleInfo()},n.prototype.reportLogin=function(){var t={event:"enter_role",id:e.ClientHelper.instance.playerId,name:e.ClientHelper.instance.name,level:e.ClientHelper.instance.level,server_name:e.GlobalConfig.sName,_sid:e.GlobalConfig.sid},n=JSON.stringify(t);window.parent.postMessage(n,"*"),console.log("》》》获取角色数据上报："+n)},n.prototype.reportUpLevel=function(){this.reportRoleInfo()},n.prototype.reportRoleInfo=function(){var t={event:"role",id:e.ClientHelper.instance.playerId,name:e.ClientHelper.instance.name,level:e.ClientHelper.instance.level,server_name:e.GlobalConfig.sName,_sid:e.GlobalConfig.sid},n=JSON.stringify(t);window.parent.postMessage(n,"*"),console.log("》》》角色信息上传参数："+n)},n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("》》》请求充值服生成订单号回包: "+JSON.stringify(e));var r=JSON.parse(e);n.orderResultData=r,r&&0==r.ret&&(n.orderId=r.orderId,console.log("》》》请求充值服生成订单号成功:"+n.orderId),n.pay(t))},o=e.GlobalConfig.account,i=e.GlobalConfig.sid,a=e.PlatformConfig.channelId,s=t.id,l=Math.round(e.TimeUtil.serverTime/1e3),c=e.Md5Util.getInstance().hex_md5(encodeURI(o)+i+a+l+s+e.GlobalConfig.loginKey),u=n.rechargeOrderIdServer+"?account="+o+"&serverId="+i+"&channelId="+a+"&productId="+s+"&time="+l+"&sign="+c;console.log("》》》请求充值服生成订单号: "+u),e.HttpRequest.sendGet(u,r,n)},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){return n=this,[2,new Promise(function(r,o){var i=t.level,a=(Math.round(e.TimeUtil.serverTime/1e3),n.reqRoute+"@"+t.id+"@@"+n.orderResultData.orderId+"@"+e.GlobalConfig.sid);console.log("》》》透传参数"+a);var s=t.id;t.product_id&&(s=t.product_id);var l={event:"pay",gid:e.PlatformConfig.appIdStr,username:n.username,amount:i,product:t.name,product_id:s,extra_info:a,role:e.ClientHelper.instance.name,_sid:e.GlobalConfig.sid,_server_name:e.GlobalConfig.sName,server_name:e.GlobalConfig.sName,id:e.ClientHelper.instance.playerId,name:e.ClientHelper.instance.name,level:e.ClientHelper.instance.level},c=JSON.stringify(l);console.log("》》》充值上传参数类型："+typeof c),console.log("》》》充值上传参数："+c),window.parent.postMessage(c,"*"),e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_HIDE_VIP_VIEW)})]})})},n.prototype.chatDataPost=function(t,n,r,o,i,a,s){void 0===a&&(a=""),void 0===s&&(s=0);var l=this,c=l.getChannelId(t),u="gameid="+l.gameId+"&type="+c+"&uid="+l.uid+"&key=fSaLpB242wChFJK6SJAOnKOFl1VyGcld",f=e.Md5Util.getInstance().hex_md5(u),p=1==c?s+"":"",g=1==c?"爱微游":"",d=1==c?"1":"",h="&type="+c+"&gameid="+l.gameId+"&serverid="+e.GlobalConfig.sid+"&uid="+l.uid+"&nick="+e.ClientHelper.instance.name+"&fromch=爱微游&touid="+d+"&tonick="+p+"&toch="+g+"&msg="+n+"&ip=&sign="+f,m="https://chat-monitor.11h5.com/chat/?cmd=record"+h;e.HttpRequest.sendGet(m,l.chatPostReturn,l),console.log("》》》聊天监控上报："+h)},n.prototype.chatPostReturn=function(e){console.log("》》》聊天监控上报结果返回："+e)},n.prototype.getChannelId=function(e){switch(e){case 2:return 4;case 3:return 2;case 4:return 1;case 5:return 5}return 3},n}(e.BasePlatform);e.Pf9377Platform=t,__reflect(t.prototype,"qmr.Pf9377Platform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,e}return __extends(n,t),n.prototype.setLoadingProgress=function(e){C9377SDK.Global.setLoadingProgress(e),console.log("》》》上报游戏加载进度",e)},n.prototype.getPullServerListUrl=function(){var t=e.PlatformConfig.isTSVersion?1:0,n=e.PlatformConfig.isTSVersion?this.tsServerListServer:this.serverListServer,r=e.PlatformConfig.isTSVersion?9e3:0;return n+"?account="+e.GlobalConfig.account+"&ts="+t+"&sid="+r},n.prototype.getCheckAccountValidityUrl=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,l;return __generator(this,function(c){return t=e.GlobalConfig.account,n=e.TimeUtil.serverTime/1e3|0,r=n+"",o=r,i=e.GlobalConfig.sid,a=0,s=e.Md5Util.getInstance().hex_md5(encodeURI(t)+i+o+r+e.GlobalConfig.loginKey),l=e.WebBrowerUtil.model||"none",[2,this.loginServerUrl+"?account="+t+"&token="+o+"&time="+r+"&serverId="+i+"&unverifysvr="+a+"&sign="+s+"&clientVer="+e.GlobalConfig.appVersion+"&deviceUID="+l]})})},n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("》》》请求充值服生成订单号回包: "+JSON.stringify(e));var r=JSON.parse(e);n.orderResultData=r,r&&0==r.ret&&(n.orderId=r.orderId,console.log("》》》请求SDK充值 订单号:"+n.orderId),n.pay(t))},o=e.GlobalConfig.account,i=e.GlobalConfig.sid,a=e.PlatformConfig.channelId,s=t.id,l=Math.round(e.TimeUtil.serverTime/1e3),c=e.Md5Util.getInstance().hex_md5(encodeURI(o)+i+a+l+s+e.GlobalConfig.loginKey),u=n.rechargeOrderIdServer+"?account="+o+"&serverId="+i+"&channelId="+a+"&productId="+s+"&time="+l+"&sign="+c;console.log("》》》请求充值服生成订单号: "+u),e.HttpRequest.sendGet(u,r,n)},n.prototype.reportLogin=function(){window.qg.reportMonitor?(window.qg.reportMonitor("game_scene",0),console.log("》》》上报进入游戏主界面")):console.log("》》》上报进入游戏主界面失败，不支持该接口")},n.prototype.reportFightPower=function(e){var t=new C9377SDK.SDKReport,n=e;t.pushRank(n),console.log("》》》上报排行榜战力",e)},n.prototype.initGetOption=function(){},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=new C9377SDK.SDKLogin;o.login({logined:function(r,o,i){e.GlobalConfig.account=i.getUsername(),t.isGetPlatformInfo=!0,console.log("》》》sdk登录成功",e.GlobalConfig.account),n()}})})]})})},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){return n=this,[2,new Promise(function(r,o){var i=t.level,a=t.name,s=null,l=parseFloat(e.GlobalConfig.sid),c=n.reqRoute+"@"+t.id+"@@"+n.orderId+"@"+e.GlobalConfig.sid,u=null,f=new C9377SDK.SDKPay;f.toPay(i,a,l,c,s,u),r()})]})})},n.prototype.reloadGame=function(t){var n="";if(t){this.setLoadingStatus("清理中..."),egret.localStorage.clear();var r=window.clear_res_cache;r&&r(),n="缓存清理成功，"}n+="请重新进入小程序",window.qg&&window.qg.exitApplication?(this.setLoadingStatus(""),window.qg.showModal({content:n,showCancel:!1,complete:function(){window.qg.exitApplication({})}})):e.TipManagerCommon.getInstance().createCommonColorTip("请关闭游戏进程重新进入")},n}(e.BasePlatform);e.PlatformOppo=t,__reflect(t.prototype,"qmr.PlatformOppo")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,console.log("PlatformYMXK created"),e}return __extends(n,t),n.prototype.getPullServerListUrl=function(){var t=this,n=e.PlatformConfig.isTSVersion?t.tsServerListServer:t.serverListServer;return n+"?account="+e.GlobalConfig.account},n.prototype.getCheckAccountValidityUrl=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,l;return __generator(this,function(c){return t=e.GlobalConfig.account,n=this.timestamp,r=n,o=e.GlobalConfig.sid,i=0,a=e.Md5Util.getInstance().hex_md5(encodeURI(t)+o+r+n+e.GlobalConfig.loginKey),s=e.WebBrowerUtil.model||"none",l=e.PlatformConfig.channelId,[2,this.loginServerUrl+"?account="+t+"&token="+r+"&time="+n+"&serverId="+o+"&unverifysvr="+i+"&sign="+a+"&clientVer="+e.GlobalConfig.appVersion+"&deviceUID="+s+"&channelId="+l]})})},n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("》》》请求充值服生成订单号回包: "+JSON.stringify(e));var r=JSON.parse(e);n.orderResultData=r,r&&0==r.ret&&(n.orderId=r.orderId,console.log("》》》请求充值服生成订单号成功:"+n.orderId),n.pay(t))};console.log("GlobalConfig.account",e.GlobalConfig.account);var o=e.GlobalConfig.account,i=e.GlobalConfig.sid,a=e.PlatformConfig.channelId,s=t.id,l=Math.round(e.TimeUtil.serverTime/1e3),c=e.Md5Util.getInstance().hex_md5(encodeURI(o)+i+a+l+s+e.GlobalConfig.loginKey),u=n.rechargeOrderIdServer+"?account="+o+"&serverId="+i+"&channelId="+a+"&productId="+s+"&time="+l+"&sign="+c;console.log("》》》请求充值服生成订单号: "+u),e.HttpRequest.sendGet(u,r,n)},n.prototype.reportRegister=function(){this.reportRoleInfo()},n.prototype.reportLogin=function(){var t={event:"enter_role",id:e.ClientHelper.instance.playerId,name:e.ClientHelper.instance.name,level:e.ClientHelper.instance.level,server_name:e.GlobalConfig.sName,_sid:e.GlobalConfig.sid},n=JSON.stringify(t);window.parent.postMessage(n,"*"),console.log("》》》进入游戏角色信息上报："+n)},n.prototype.reportUpLevel=function(){this.reportRoleInfo()},n.prototype.chatDataPost=function(t,n,r,o,i,a,s){void 0===a&&(a=""),void 0===s&&(s=0);var l=""+t;switch(t){case e.CHAT_CHANNELID.CROSS:l="9";break;case e.CHAT_CHANNELID.SELF:l="1";break;case e.CHAT_CHANNELID.TEAM:l="7";break;case e.CHAT_CHANNELID.UNION:l="6";break;case e.CHAT_CHANNELID.WORLD:l="4";break;default:return}var c=e.ServerListModel.instance.getServerName(parseInt(i)),u={event:"chat_message",fromUserId:o,toUserId:a,type:l,content:n,time:""+r/1e3,serverId:i,serverName:c},f=JSON.stringify(u);window.parent.postMessage(f,"*"),console.log("》》》聊天消息上报："+f)},n.prototype.initGetOption=function(){var t=this;t.username=decodeURI(e.JsUtil.getQueryStringByName("username")),e.GlobalConfig.account=e.GlobalConfig.uid=t.username,t.adult=decodeURI(e.JsUtil.getQueryStringByName("adult")),t.timestamp=e.JsUtil.getQueryStringByName("timestamp"),t.avatar=e.JsUtil.getQueryStringByName("avatar"),t.sign=e.JsUtil.getQueryStringByName("sign"),t.age=e.JsUtil.getQueryStringByName("age"),e.PlatformConfig.appIdStr=e.JsUtil.getQueryStringByName("gameid"),e.PlatformConfig.channelId=e.PlatformConfig.appIdStr},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return[2,new Promise(function(t,n){e.isGetPlatformInfo=!0,t()})]})})},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){return n=this,[2,new Promise(function(r,o){var i=t.level,a=(Math.round(e.TimeUtil.serverTime/1e3),e.PlatformConfig.channelId+"@"+t.id+"@@"+n.orderResultData.orderId+"@"+e.GlobalConfig.sid);console.log("》》》透传参数"+a);var s=t.id;t.product_id&&(s=t.product_id);var l={event:"pay",gid:e.PlatformConfig.appIdStr,username:n.username,_sid:e.GlobalConfig.sid,amount:i,product:t.name,product_id:s,extra_info:a,role:e.ClientHelper.instance.name,_server_name:e.GlobalConfig.sName,server_name:e.GlobalConfig.sName,id:e.ClientHelper.instance.playerId,name:e.ClientHelper.instance.name,level:e.ClientHelper.instance.level},c=JSON.stringify(l);console.log("》》》充值上传参数类型："+typeof c),console.log("》》》充值上传参数："+c),window.parent.postMessage(c,"*"),e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_HIDE_VIP_VIEW),r()})]})})},n.prototype.reportRoleInfo=function(){var t={event:"role",id:e.ClientHelper.instance.playerId,name:e.ClientHelper.instance.name,level:e.ClientHelper.instance.level,server_name:e.GlobalConfig.sName,_sid:e.GlobalConfig.sid},n=JSON.stringify(t);window.parent.postMessage(n,"*"),console.log("》》》角色信息上报参数："+n)},n}(e.BasePlatform);e.PlatformYMXK=t,__reflect(t.prototype,"qmr.PlatformYMXK")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,e}return __extends(n,t),n.prototype.initGetOption=function(){e.PlatformConfig.platformSign=e.PlatformConfig.platform+"",this.isGetPlatformInfo=!0},n.prototype.initLoginServer=function(){this.updateLoginServer()},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return egret.log("平台登陆"),[2,new Promise(function(n,r){e.GlobalConfig.token="2322232",t.isGetPlatformInfo=!0,n(),egret.log("平台登陆成功:"+status)})]})})},n.prototype.reqPay=function(e){},n.prototype.pay=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n}(e.BasePlatform);e.SolGamePlatform=t,__reflect(t.prototype,"qmr.SolGamePlatform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,egret.registerFontMapping("specialGameFont","./font/specialFont.ttf"),e}return __extends(n,t),n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("请求充值服生成订单号回包: "+JSON.stringify(e));var t=JSON.parse(e);t&&0==t.ret&&n.pay(t.data)},o=""+t.id+"@"+e.PlatformConfig.channelId,i=String(n.packageId),a=e.GlobalConfig.account,s=e.GlobalConfig.sid,l=e.GlobalConfig.uid,c=e.ClientHelper.instance.name,u=e.ClientHelper.instance.level+"",f=String(t.id),p=t.cumulVal,g=t.name,d=t.name,h=(e.GlobalConfig.loginKey,e.Md5Util.getInstance().hex_md5(""+i+encodeURI(a)+s+l+u+f+p+e.GlobalConfig.loginKey)),m=n.rechargeOrderIdServer+"?pid="+n.packageId+"&account="+a+"&serverId="+s+"&roleId="+l+"&roleName="+c+"&roleLevel="+u+"&productId="+f+"&productName="+g+"&productDesc="+d+"&price="+p+"&extension="+o+"&sign="+h+"&time="+e.TimeUtil.serverTime;console.log("请求充值服生成订单号: "+m),e.HttpRequest.sendGet(m,r,n)},n.prototype.reloadGame=function(e){this.logout()},n.prototype.setLoadingStatus=function(e){e=e||"hide",console.log("js setLoadingStatus",e),egret.ExternalInterface.call("setLoadingStatus",e)},n.prototype.reportRegister=function(){this.uploadGameRoleInfo(2)},n.prototype.reportLogin=function(){this.uploadGameRoleInfo(1)},n.prototype.reportUpLevel=function(){this.uploadGameRoleInfo(3)},n.prototype.logout=function(){this.uploadGameRoleInfo(4),egret.ExternalInterface.call("loginOutXiyouGameSDK","loginOutXiyouGameSDK message from JS")},n.prototype.initGetOption=function(){},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return t=this,[2,new Promise(function(n,r){var o=function(e){var n=JSON.parse(e);n.success?(console.log("sdk初始化成功",e),t.packageId=n.pid,egret.ExternalInterface.call("loginXiyouGameSDK","loginXiyouGameSDK message from JS")):console.log("sdk初始化失败",e)},i=function(r){var o=JSON.parse(r);o.success?(console.log("sdk登录成功",r),e.GlobalConfig.uid=o.sUniqueUserId,e.GlobalConfig.token=o.sAuthToken,e.GlobalConfig.account=e.GlobalConfig.uid,t.isGetPlatformInfo=!0,n()):console.log("sdk登录失败",r)},a=function(t){var r=JSON.parse(t);r.success?(console.log("sdk登出成功",t),window.location&&window.location.reload?window.location.reload():e.TipManagerCommon.getInstance().createCommonColorTip("请手动重启游戏"),n()):(console.log("sdk登出失败",t),e.TipManagerCommon.getInstance().createCommonColorTip("请手动重启游戏"))},s=function(e){t.uploadGameRoleInfo(4),egret.ExternalInterface.call("exitXiyouGameSDK","exitXiyouGameSDK message from JS")},l=function(e){console.log("实名认证查询",JSON.stringify(e));var t=JSON.parse(e),n=t.age_scope;switch(n){case"1":break;case"2":break;case"3":break;case"4":}};egret.ExternalInterface.addCallback("onExitResultXiyouGameSDK",s),egret.ExternalInterface.addCallback("logoutXiyouGameSDKComplete",a),egret.ExternalInterface.addCallback("onUserAuthXiyouGameSDKComplete",l),egret.ExternalInterface.addCallback("initXiyouGameSDKComplete",o),egret.ExternalInterface.addCallback("loginXiyouGameSDKComplete",i),egret.ExternalInterface.call("initXiyouGameSDK","initXiyouGameSDK message from JS")})]})})},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return[2,new Promise(function(n,r){var o={};
o.fixedPay=!0,o.productId=t.productId,o.productName=t.productName,o.productDesc=t.productName,o.ration=t.ration,o.coinName="元宝",o.price=t.price,o.buyNum=t.buyNum,o.roleId=""+e.ClientHelper.instance.playerId,o.roleName=e.ClientHelper.instance.name,o.roleLevel=e.ClientHelper.instance.level,o.serverId=e.GlobalConfig.sid,o.serverName=e.GlobalConfig.sName,o.orderId=t.orderId,o.extension=t.extension;var i=JSON.stringify(o);console.log("请求sdk支付:",i),egret.ExternalInterface.call("payXiyouGameSDK",i)})]})})},n.prototype.uploadGameRoleInfo=function(t){var n=new Object;n.dataType=t,n.serverId=e.GlobalConfig.sid,n.serverName=e.GlobalConfig.sName,n.roleId=""+e.ClientHelper.instance.playerId,n.roleName=e.ClientHelper.instance.name,n.roleLevel=""+e.ClientHelper.instance.level;var r=Math.round(e.TimeUtil.serverTime/1e3);n.roleCTime=e.ClientHelper.instance.createTime,n.roleLevelIMTime=r,n.moneyNum=""+e.ClientHelper.instance.diamond,n.vip=""+e.ClientHelper.instance.vipLevel,n.power=""+e.ClientHelper.instance.fightVal;var o=JSON.stringify(n);console.log("上传角色信息:",o),egret.ExternalInterface.call("reportXiyouGameSDK",o)},n}(e.BasePlatform);e.XiyouApkPlatform=t,__reflect(t.prototype,"qmr.XiyouApkPlatform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.canClearResCache=!1,e}return __extends(n,t),n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("请求充值服生成订单号回包: "+JSON.stringify(e));var t=JSON.parse(e);t&&0==t.ret&&n.pay(t.data)},o=""+t.id+"@"+e.PlatformConfig.channelId,i=String(n.packageId),a=e.GlobalConfig.account,s=e.GlobalConfig.sid,l=e.GlobalConfig.uid,c=e.ClientHelper.instance.name,u=e.ClientHelper.instance.level+"",f=String(t.id),p=t.cumulVal,g=t.name,d=t.name,h=(e.GlobalConfig.loginKey,e.Md5Util.getInstance().hex_md5(""+i+encodeURI(a)+s+l+u+f+p+e.GlobalConfig.loginKey)),m=n.rechargeOrderIdServer+"?pid="+n.packageId+"&account="+a+"&serverId="+s+"&roleId="+l+"&roleName="+c+"&roleLevel="+u+"&productId="+f+"&productName="+g+"&productDesc="+d+"&price="+p+"&extension="+o+"&sign="+h;console.log("请求充值服生成订单号: "+m),e.HttpRequest.sendGet(m,r,n)},n.prototype.reportRegister=function(){this.uploadGameRoleInfo(2)},n.prototype.reportLogin=function(){this.uploadGameRoleInfo(1)},n.prototype.reportUpLevel=function(){this.uploadGameRoleInfo(3)},n.prototype.logout=function(){this.uploadGameRoleInfo(4)},n.prototype.initGetOption=function(){},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return t=this,[2,new Promise(function(n,r){if(t.sdk=window.XiYouSDK,!t.sdk)throw new Error("XiYouSDK not found");var o={};o.debugState=!0,o.appId=e.PlatformConfig.appIdStr,o.appKey=e.PlatformConfig.appKey,o.appVersion=e.GlobalConfig.appVersion;var i={};i.onInit=function(e){1===e.state?(console.log("sdk初始化成功",JSON.stringify(e)),t.packageId=e.data.pid,t.sdk.login()):console.log("sdk初始化失败",JSON.stringify(e))},i.onLogin=function(r){if(1===r.state){console.log("sdk登录成功",JSON.stringify(r));var o=r.data.userId;e.GlobalConfig.uid=o;var i=r.data.token;e.GlobalConfig.token=i,e.GlobalConfig.account=e.GlobalConfig.uid,t.isGetPlatformInfo=!0,egret.log("sdk请求实名认证查询"),t.sdk.getUserAuth(),n()}else console.log("sdk登录失败",JSON.stringify(r))},i.onPay=function(e){1===e.state?console.log("sdk支付成功",JSON.stringify(e)):console.log("sdk支付失败",JSON.stringify(e))},i.onServers=function(e){},i.onUserAuth=function(e){if(console.log("实名认证查询",JSON.stringify(e)),1===e.state){var n=e.data.age_scope;switch(n){case"1":break;case"2":break;case"3":break;case"4":break;default:t.sdk.setUserAuth(2,!0)}}else 0===e.state},i.onLogout=function(e){1===e.state?console.log("注销成功",JSON.stringify(e)):console.log("注销失败",JSON.stringify(e))},i.onPay=function(e){1===e.state?console.log("支付成功",JSON.stringify(e)):console.log("支付失败",JSON.stringify(e))},i.onExit=function(e){1===e.state?console.log("退出成功",JSON.stringify(e)):console.log("退出失败",JSON.stringify(e))},egret.log("sdk请求初始化"),t.sdk.init(o,i)})]})})},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(r){return[2,new Promise(function(r,o){var i=n;if(i.sdk){var a={};a.fixedPay=!0,a.productId=t.productId,a.productName=t.productName,a.productDesc=t.productName,a.ration=t.ration,a.coinName="元宝",a.price=t.price,a.buyNum=t.buyNum,a.orderId=t.orderId,a.extension=t.extension,a.serverId=e.GlobalConfig.sid,a.serverName=e.GlobalConfig.sName,console.log("请求sdk支付:",JSON.stringify(a)),i.sdk.pay(a)}})]})})},n.prototype.uploadGameRoleInfo=function(t){var n=this;if(n.sdk){var r=new Object;r.dataType=t,r.serverId=e.GlobalConfig.sid,r.serverName=e.GlobalConfig.sName,r.roleId=e.GlobalConfig.uid,r.roleName=e.ClientHelper.instance.name,r.roleLevel=""+e.ClientHelper.instance.level;var o=Math.round(e.TimeUtil.serverTime/1e3);r.roleCTime=e.ClientHelper.instance.createTime,r.roleLevelIMTime=o,r.moneyNum=""+e.ClientHelper.instance.diamond,r.vip=""+e.ClientHelper.instance.vipLevel,r.power=""+e.ClientHelper.instance.fightVal,console.log("上传角色信息:"+JSON.stringify(r)),n.sdk.dataSubmit(r)}},n}(e.BasePlatform);e.XiyouH5Platform=t,__reflect(t.prototype,"qmr.XiyouH5Platform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e.canClearResCache=!0,e.lastTime=0,e.__isShareGame=!1;return e}return __extends(n,t),n.prototype.initGetOption=function(){var t=this;e.PlatformConfig.platformSign=e.PlatformConfig.platform+"",t.masterId=e.JsUtil.getValueFromParams("masterId",e.PlatformConfig.extendsParams),t.packageId=e.JsUtil.getValueFromParams("packageId",e.PlatformConfig.extendsParams),t.packageName=e.JsUtil.getValueFromParams("packageName",e.PlatformConfig.extendsParams),this.isGetPlatformInfo=!0,window.onShareSucess=t.onShareSucess},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(r){return egret.log("平台登陆"),t=this,[2,new Promise(function(r,o){if(!window.XYqqSdk)throw new Error("XYqqSdk init faild");if(t.sdk=window.XYqqSdk,!window.isInitSDK)throw new Error("XYqqSdk init faild");n.sdk&&n.sdk.doLogin(function(t,o){t?egret.error("sdk登录失败:"+t):(n.data=o,e.GlobalConfig.uid=String(o.userId),e.GlobalConfig.token=String(o.token),e.GlobalConfig.account=e.GlobalConfig.uid,egret.log("sdk登录成功:"+e.GlobalConfig.account),r())})})]})})},n.prototype.uploadGameRoleInfo=function(t){if(this.isGetPlatformInfo){var n=this;if(n.sdk){var r=new Object;r.dataType=t,r.serverId=e.GlobalConfig.sid,r.serverName=e.GlobalConfig.sName,r.roleId=e.GlobalConfig.uid,r.roleName=e.ClientHelper.instance.name,r.roleLevel=e.ClientHelper.instance.level;var o=Math.round(e.TimeUtil.serverTime/1e3);r.roleCTime=e.GlobalConfig.logintime>0?e.GlobalConfig.logintime:"0",r.roleLevelIMTime=o,r.moneyNum=e.ClientHelper.instance.money,r.vip=e.ClientHelper.instance.vipLevel,r.power="0";var i=JSON.stringify(r);egret.log("上传角色信息:"+i),n.sdk.doSubmit(r)}}},Object.defineProperty(n.prototype,"httpProtoco",{get:function(){return"https:"},enumerable:!0,configurable:!0}),n.prototype.reportRegister=function(){this.uploadGameRoleInfo(2)},n.prototype.reportLogin=function(){this.uploadGameRoleInfo(1)},n.prototype.reportUpLevel=function(){this.uploadGameRoleInfo(3)},n.prototype.logout=function(){this.uploadGameRoleInfo(4)},n.prototype.reqPay=function(t){var n=this,r=function(e){console.log("请求充值服生成订单号回包: "+JSON.stringify(e));var r=JSON.parse(e);n.orderResultData=r.data,r&&0==r.ret&&(n.orderId=n.orderResultData.orderId,console.log("请求充值服生成订单号成功:"+n.orderId),n.pay(t))},o=t.id+"@"+e.PlatformConfig.channelId,i=n.packageId,a=e.GlobalConfig.account,s=e.GlobalConfig.sid,l=e.GlobalConfig.uid,c=e.ClientHelper.instance.name,u=e.ClientHelper.instance.level+"",f=t.id,p=t.name,g=t.name,d=t.cumulVal,h=(e.GlobalConfig.loginKey,e.Md5Util.getInstance().hex_md5(""+i+encodeURI(a)+s+l+u+f+d+e.GlobalConfig.loginKey)),m=n.rechargeOrderIdServer+"?pid="+i+"&account="+a+"&serverId="+s+"&roleId="+l+"&roleName="+c+"&roleLevel="+u+"&productId="+f+"&productName="+p+"&productDesc="+g+"&price="+d+"&extension="+o+"&sign="+h;console.log("请求充值服生成订单号: "+m),e.HttpRequest.sendGet(m,r,n)},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(r){return[2,new Promise(function(r,o){var i=n,a=t.level;if(i.sdk){var s=new Object;s.productId=t.id,s.productName=t.name,s.productDesc=t.name,s.ration="100",s.coinName="元宝",s.price=a,s.buyNum="1",s.orderId=n.orderResultData.orderId,s.zoneid=e.GlobalConfig.sid,s.extension=n.orderResultData.extension;var l=JSON.stringify(s);egret.log("调用sdk充值接口:"+l),i.sdk.doPay(s)}})]})})},n.prototype.onScreenShow=function(){console.log("游戏界面切入前台");var t=this;if(t.__isShareGame){t.__isShareGame=!1;var n=egret.getTimer()-this.lastTime;n>2e3?(console.log("分享时间超过2秒"),e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_REQUEST_SHARE_REWARD)):console.log("分享时间不足2秒")}},n.prototype.onScreenHide=function(){console.log("游戏界面切入后台")},n.prototype.onShareBack=function(){var t=this;if(t.__isShareGame){t.__isShareGame=!1;var n=egret.getTimer()-this.lastTime;n>2e3&&e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_REQUEST_SHARE_REWARD)}},n.prototype.onShareSucess=function(){var t=this;t.__isShareGame&&(t.__isShareGame=!1,e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_REQUEST_SHARE_REWARD))},n.prototype.shareGame=function(t,n,r){var o=this,i=t-n;return 0>=i?void e.TipManagerCommon.getInstance().createCommonColorTip("今日的分享次数已经用完"):r>0&&r>egret.getTimer()?void e.TipManagerCommon.getInstance().createCommonColorTip("CD时间未到，请稍后"):(o.lastTime=egret.getTimer(),o.__isShareGame=!0,void(o.sdk&&o.sdk.doShare()))},n.prototype.reloadGame=function(t){console.log("reloadGame",t,window.clear_res_cache);var n="";if(t){this.setLoadingStatus("清理中..."),egret.localStorage.clear();var r=window.clear_res_cache;r&&r(),n="缓存清理成功，"}n+="请杀掉进程后重新启动游戏",window.qq&&window.qq.exitMiniProgram?(this.setLoadingStatus(""),window.qq.showModal({content:n,showCancel:!1,complete:function(){}})):e.TipManagerCommon.getInstance().createCommonColorTip("请关闭游戏进程重新进入")},n}(e.BasePlatform);e.XiyouSQQPlatform=t,__reflect(t.prototype,"qmr.XiyouSQQPlatform")}(qmr||(qmr={}));var qmr;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e.canClearResCache=!0,e.lastTime=0,e.__isShareGame=!1;return e}return __extends(n,t),n.prototype.initGetOption=function(){var t=this;e.PlatformConfig.platformSign=e.PlatformConfig.platform+"";var r=e.JsUtil.getValueFromParams("limit",e.PlatformConfig.extendsParams),o=null==r?0:Number(r),i=e.JsUtil.getValueFromParams("h5limit",e.PlatformConfig.extendsParams),a=null==i?0:Number(i);n.limit=o,n.h5limit=a,this.isGetPlatformInfo=!0,aladin.AladinSDK.initSdk(),aladin.AladinSDK.init2(e.PlatformConfig.appIdStr,e.GlobalConfig.appVersion,null,t.aladinSdkInitComplete),aladin.AladinSDK.allowDebug(!1),window.showPayGuild=t.showPayGuild},n.prototype.aladinSdkInitComplete=function(){},Object.defineProperty(n.prototype,"httpProtoco",{get:function(){return"https:"},enumerable:!0,configurable:!0}),n.prototype.getCode=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return e=this,e.sdk?[4,e.sdk.getCode()]:[3,2];case 1:return t=n.sent(),console.log("》》》获取微信code参数："+t),[2,new Promise(function(e,n){e(t)})];case 2:return[2]}})})},n.prototype.reportOpenId=function(){aladin.AladinSDK.reportOpenId(e.GlobalConfig.uid),console.log("》》》上报openid："+e.GlobalConfig.uid)},Object.defineProperty(n.prototype,"reqRoute",{get:function(){return"IOS"==egret.Capabilities.os.toUpperCase()?"ios":"android"},enumerable:!0,configurable:!0}),n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return t=this,console.log("游戏平台登录接口调用"),window.wxplatform?(t.sdk=window.wxplatform,t.sdk?(t.sdk.init(),[4,t.sdk.login()]):[3,2]):[3,2];case 1:return n=r.sent(),t.data=n,e.GlobalConfig.uid=n.openid,e.GlobalConfig.token=n.token,e.GlobalConfig.account=e.GlobalConfig.uid,console.log("》》》微信登录返回参数：openid"+e.GlobalConfig.uid+"   code: "+e.GlobalConfig.token),[2,new Promise(function(e,t){e()})];case 2:return[2]}})})},n.prototype.getPullServerListUrl=function(){var t=this,n=e.PlatformConfig.isTSVersion?1:0,r=(e.PlatformConfig.isTSVersion?t.tsServerListServer:t.serverListServer,e.PlatformConfig.isTSVersion?9e3:e.PlatformConfig.platformId);return t.serverListServer+"?account="+e.GlobalConfig.account+"&ts="+n+"&sid="+r},n.prototype.getCheckAccountValidityUrl=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,l,c;return __generator(this,function(u){switch(u.label){case 0:return t=e.GlobalConfig.account,[4,this.getCode()];case 1:return n=u.sent(),r=n.token,console.log("账号验签新code:"+r),o=e.TimeUtil.serverTime/1e3|0,i=o+"",a=e.GlobalConfig.sid,s=0,l=e.Md5Util.getInstance().hex_md5(encodeURI(t)+a+r+i+e.GlobalConfig.loginKey),c=e.WebBrowerUtil.model||"none",[2,this.loginServerUrl+"?account="+t+"&token="+r+"&time="+i+"&serverId="+a+"&unverifysvr="+s+"&sign="+l+"&clientVer="+e.GlobalConfig.appVersion+"&deviceUID="+c]}})})},n.prototype.tryOrder=function(t){console.log("上线尝试拉取订单");var n=this,r=Math.round(t/1e3),o={account:e.GlobalConfig.account,serverId:e.GlobalConfig.sid,channelId:e.PlatformConfig.channelId,pf:"android",time:r,roleId:e.GlobalConfig.uid,roleName:e.ClientHelper.instance.name,roleLevel:e.ClientHelper.instance.level,rechargeUrl:n.rechargeOrderIdServer};console.log("请求支付:"+o),n.sdk&&n.sdk.tryOrder(o)},n.prototype.reportCreateRoleView=function(){console.log("==================================登录界面时间上报================================");aladin.AladinSDK&&aladin.AladinSDK.reportWithAppId(e.PlatformConfig.appIdStr,"15_1","")},n.prototype.reportUpLevel=function(){aladin.AladinSDK.reportWithAppId(e.PlatformConfig.appIdStr,"16_1",e.ClientHelper.instance.level+""),console.log("==============================》》》上报角色升级："+e.ClientHelper.instance.level),10==e.ClientHelper.instance.level&&"ANDROID"==egret.Capabilities.os.toUpperCase()&&e.ModuleManager.popModule(e.ModuleNameLogin.FIRST_RECHARGE_VIEW,!1)},n.prototype.showPayGuild=function(){var t=e.ClientHelper.instance.playerId+"",n=egret.localStorage.getItem(t);n==t?(console.log("===========================》》》老用户直接跳客服对话"),window.startH5PayCall&&(window.startH5PayCall(),console.log("===========================》》》老用户客服消息回调："))):(console.log("===========================》》》第一次弹付费引导界面"),egret.localStorage.setItem(t.toString(),t.toString()),e.ModuleManager.showModule(e.ModuleNameLogin.RECHARGE_GUILD))},n.prototype.startH5PayCall=function(){console.log("===========================》》》关闭引导界面后回调："+window.startH5PayCall),window.startH5PayCall&&(console.log("===========================》》》第一次客服消息回调："),window.startH5PayCall())},n.prototype.reqPay=function(e){var t=this;t.pay(e)},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){return n=this,[2,new Promise(function(r,o){var i=100*t.level,a=Math.round(e.TimeUtil.serverTime/1e3);if(n.sdk){var s={account:e.GlobalConfig.account,serverId:e.GlobalConfig.sid,channelId:e.PlatformConfig.channelId,time:a,pf:"android",productId:t.id,productName:t.name,roleId:e.GlobalConfig.uid,roleName:e.ClientHelper.instance.name,roleLevel:e.ClientHelper.instance.level,price:i,rechargeUrl:n.rechargeOrderIdServer};console.log("请求支付:"+s),n.sdk.pay(s)}})]})})},n.prototype.onScreenShow=function(){console.log("===============================================游戏界面切入前台===============================================");var t=this;if(t.__isShareGame){t.__isShareGame=!1;var n=egret.getTimer()-this.lastTime;n>2e3?(console.log("===============================================分享时间超过2秒==============================================="),e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_REQUEST_SHARE_REWARD)):console.log("===============================================分享时间不足2秒===============================================")}},n.prototype.onScreenHide=function(){console.log("===============================================游戏界面切入后台===============================================")},n.prototype.onShareBack=function(){var t=this;if(t.__isShareGame){t.__isShareGame=!1;var n=egret.getTimer()-this.lastTime;n>2e3&&e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_REQUEST_SHARE_REWARD)}},n.prototype.onShareSucess=function(){var t=this;t.__isShareGame&&(t.__isShareGame=!1,e.NotifyManager.sendNotification(e.NotifyConstLogin.TO_REQUEST_SHARE_REWARD))},n.prototype.shareGame=function(t,n,r){console.log("==================调用微信分享=====================");var o=this,i=t-n;return 0>=i?void e.TipManagerCommon.getInstance().createCommonColorTip("今日的分享次数已经用完"):r>0&&r>egret.getTimer()?void e.TipManagerCommon.getInstance().createCommonColorTip("CD时间未到，请稍后"):(o.lastTime=egret.getTimer(),o.__isShareGame=!0,void(o.sdk&&(console.log("==================进入微信SDK分享====================="),o.sdk.doShare())))},n.prototype.reloadGame=function(t){var n="";if(t){this.setLoadingStatus("清理中..."),egret.localStorage.clear();var r=window.clear_res_cache;r&&r(),n="缓存清理成功，"}n+="请重新进入小程序",window.wx&&window.wx.exitMiniProgram?(this.setLoadingStatus(""),window.wx.showModal({content:n,showCancel:!1,complete:function(){window.wx.exitMiniProgram()}})):e.TipManagerCommon.getInstance().createCommonColorTip("请关闭游戏进程重新进入")},n.limit=0,n.h5limit=0,n}(e.BasePlatform);e.XiyouXWPlatform=t,__reflect(t.prototype,"qmr.XiyouXWPlatform")}(qmr||(qmr={}));var aladin;!function(e){var t=function(){function t(){}return t.allowDebug=function(t){e.ALUtil.DEBUG=t},t.readAppidList=function(t){return e.ALData.appIdListStr?void t(e.ALData.appIdListStr):void e.ALUtil.readAppIDList().then(function(n){e.ALData.appIdListStr=n,t(e.ALData.appIdListStr),e.ALUtil.LOG("AladinSDK readAppIDList",n)})},t.initSdk=function(){e.UserInfoData.InitUserinfo(),e.ALReport.init(),e.ALIntercept.init()},t.init2=function(t,n,r,o){e.ALSDK.init2(t,n,r,o)},t.reportOpenId=function(t,n){e.ALUtil.LOG("上报的[OPENID]:",t),e.ALReport.report(e.REPORT_TYPE_OPEN_ID,t)},t.reportAnalytics=function(t,n){e.ALReport.reportAnalytics(t,n)},t.reportWithAppId=function(t,n,r){void 0===r&&(r=""),e.ALConfig.appId=t,e.ALReport.report(n,r)},t.clickToMiniProgram=function(t,n,r){void 0===r&&(r=""),n===this.ClickTypes.ICONS_CLICK?e.ALSDK.toMiniProgram(t,this.ClickTypes.ICONS_CLICK,e.SDK_MODULE_ICONS_CLICK,r||"icons"):n===this.ClickTypes.BANNER_CLICK?e.ALSDK.toMiniProgram(t,this.ClickTypes.BANNER_CLICK,e.SDK_MODULE_BANNER_CLICK,r||"banner"):e.ALSDK.toMiniProgram(t,this.ClickTypes.ICONS_CLICK,e.SDK_MODULE_ICONS_CLICK,r)},t.getFavoData=function(t){e.ALSDK.requestModuleData(e.SDK_MODULE_LIKE,t)},t.ClickTypes={ICONS_CLICK:"0_11",BANNER_CLICK:"0_12"},t.ReportTypes={SHOW:"1_1",LOGIN:"1_2",OPEN_ID:"1_3",AUTH:"1_4",SHARE:"1_5",LIKE_CLICK:"1_6",DRAWER_CLICK:"1_7",LIKE_SHOW:"1_8",DRAWER_SHOW:"1_9",SHARE_Ready:"1_10",PAY_MENT:"6_1",PAY_MENT_STAR:"6_2",PAY_MENT_INTER:"6_3",PAY_MENT_FAIL:"6_4",MORE_SHOW:"2_0",MORE_FOLD:"2_1",MORE_CLICK:"2_2",MORE_LONG_CLICK:"2_3",VIDEO_OPEN:"2_4",VIDEO_WATCH_FAIL:"2_5",VIDEO_WATCH_NORMAL:"2_6",GAME_BOX_SHOW:"8_1",GAME_BOX_CLICK:"8_2",GAME_BOX_BANNER_CLICK:"8_3",VIDEO_BTN_SHOW:"5_6",VIDEO_CLICK:"5_7",SHARE_BTN_SHOW:"5_8",SHARE_CLICK:"5_9"},t}();e.AladinSDK=t,__reflect(t.prototype,"aladin.AladinSDK")}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function e(){}return e.sdkVersion="1.2.0",e.envVersion="release",e.appId="",e.version="1.0.0",e.openId="",e.unionId="",e.ReportMarketDomain="https://mprogram.boomegg.cn",e.ReportDataDomain="https://distribute-stats.boomegg.cn",e.ImgDomain="https://ad-static.boomegg.cn",e}();e.ALConfig=t,__reflect(t.prototype,"aladin.ALConfig")}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function e(){}return e.opts=null,e.scene=0,e.shareScene=0,e.topInviter="0",e.inviter="0",e.level=1,e.score=1,e.isVertical=!1,e.isTSA=!1,e.allowShare=!1,e.appIdListStr="",e.sdkData=null,e.moreData=null,e.iconData=null,e}();e.ALData=t,__reflect(t.prototype,"aladin.ALData");var n=function(){function t(){}return t.InitUserinfo=function(){if(e.ALUtil.wxqqExist()){var n=e.ALUtil.wxExist()?wx:qq;n.getUserInfo({complete:function(e){e&&e.userInfo&&(t.NickName=e.userInfo.nickName||"",t.AvatarUrl=e.userInfo.avatarUrl||"",t.Country=e.userInfo.country||"",t.Gender=void 0!==e.userInfo.gender?e.userInfo.gender:0,t.Language=e.userInfo.language||"",t.Province=e.userInfo.province||"");try{n.getSystemInfo({success:function(e){t.Model=e.model}})}catch(r){}}})}},t.NickName="",t.AvatarUrl="",t.Country="",t.Gender=0,t.Language="",t.Province="",t.Model="",t}();e.UserInfoData=n,__reflect(n.prototype,"aladin.UserInfoData")}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function t(){}return t.EmptyFn=function(){e.ALUtil.LOG("empty fn")},t.init=function(){this._inited||(this._inited=!0,e.ALUtil.LOG("ALIntercept init "),e.ALUtil.wxqqNotExist()||(this._pay(),this._shareApp(),this._execShowHide(),this._onShareApp(),this._rewardedVideoAd(),e.ALUtil.LOG("ALIntercept init success ")))},t._execShowHide=function(){t.TimeShow=Date.now(),t.Params={type:"duration",sub_type:e.REPORT_TYPE_GAME_DURATION,diff_key:"",extra:""};var n=e.ALUtil.wxExist()?wx:qq;n.onShow(function(n){t.TimeShow=Date.now(),e.ALUtil.LOG("ALIntercept wxQQ.onShow")}),n.onHide(function(n){var r=Math.ceil((Date.now()-t.TimeShow)/1e3);r>2&&(t.Params.diff_key=r.toString(),t.Params.extra=e.ALReport.getAdsPos(),e.ALReport.reportDataToMarket(t.Params)),e.ALUtil.LOG("ALIntercept wxQQ.onHide")})},t._rewardedVideoAd=function(){var n=e.ALUtil.wxExist()?wx:qq,r=n.createRewardedVideoAd;Object.defineProperty(n,"createRewardedVideoAd",{configurable:!0,enumerable:!0,writable:!0,value:function(){var n=r.apply(this,arguments),o=arguments[0]||{};if(t.VideoId=o.adUnitId,n.isIntercept)return n;n.isIntercept=!0;var i=n.show;Object.defineProperty(n,"show",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.ALUtil.LOG("ALIntercept _rewardedVideoAd show ---"),e.ALReport.report(e.REPORT_TYPE_VIDEO_OPEN,t.VideoId),i.apply(this,arguments)}}),n.onClose(t.VideoClose);var a=n.offClose;return Object.defineProperty(n,"offClose",{configurable:!0,enumerable:!0,writable:!0,value:function(){e.ALUtil.LOG("ALIntercept _rewardedVideoAd offClose!!!"),a.apply(this,arguments)}}),n}}),t._rewardedVideoAd=t.EmptyFn},t.VideoClose=function(n){e.ALUtil.LOG("ALIntercept _rewardedVideoAd VideoClose--- ",n),void 0===n||n&&n.isEnded?e.ALReport.report(e.REPORT_TYPE_VIDEO_WATCH_NORMAL,t.VideoId):e.ALReport.report(e.REPORT_TYPE_VIDEO_WATCH_FAIL,t.VideoId)},t._pay=function(){var n=e.ALUtil.qqExist()?qq:wx,r=n.requestMidasPayment;Object.defineProperty(n,"requestMidasPayment",{configurable:!0,enumerable:!0,writable:!0,value:function(){e.ALReport.report(e.REPORT_TYPE_PAY_MENT_START);var t=arguments[0]||{},n="0";n=e.ALUtil.qqExist()?t.starCurrency:t.buyQuantity;var o=t.success||null;t.success=function(t){e.ALUtil.LOG("ALIntercept _pay success --- ",t),n+="|1",e.ALReport.reportPay(n),o&&o(t)};var i=t.fail||null;return t.fail=function(t){e.ALUtil.LOG("ALIntercept _pay fail --- ",t),n+="|0",e.ALReport.reportPay(n),i&&i(t)},r.apply(this,arguments)}}),t._pay=t.EmptyFn},t._execOnShareApp=function(){if(t.InfoGot=!0,t.ShareParamFunc){var n=e.ALUtil.wxExist()?wx:qq;n.offShareAppMessage(t.ShareParamFunc),n.onShareAppMessage(t.ShareParamFunc)}},t._shareApp=function(){var n=e.ALUtil.wxExist()?wx:qq,r=n.shareAppMessage;Object.defineProperty(n,"shareAppMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(){var n=arguments[0]||{};return t._handleShareParam(n),n.query=n.query+("&a_inviter="+e.ALData.inviter+"&a_level="+e.ALData.level+"&a_top_inviter="+e.ALData.topInviter),e.ALUtil.LOG("ALIntercept shareAppMessage query ",n.query),r.apply(this,arguments)}}),t._shareApp=t.EmptyFn},t._onShareApp=function(){var n=e.ALUtil.wxExist()?wx:qq,r=n.onShareAppMessage;Object.defineProperty(n,"onShareAppMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(){e.ALUtil.LOG("开始拦截_onShareApp");var n=arguments[0];return n?t.InfoGot?(e.ALUtil.LOG("ALIntercept onShareAppMessage _infoExist"),arguments[0]=function(){var r=n();return t._handleShareParam(r,!1),r.query=r.query+("&a_inviter="+e.ALData.inviter+"&a_level="+e.ALData.level+"&a_top_inviter="+e.ALData.topInviter),e.ALUtil.LOG("ALIntercept onShareAppMessage query ",r.query),{title:r.title,imageUrl:r.imageUrl,imageUrlId:r.imageUrlId,query:r.query}},r.apply(this,arguments)):(t.ShareParamFunc=n,e.ALUtil.LOG("ALIntercept onShareAppMessage _infoExist not"),r.apply(this,arguments)):(e.ALUtil.LOG("ALIntercept onShareAppMessage argument0F empty"),r.apply(this,arguments))}});var o=n.offShareAppMessage;Object.defineProperty(n,"offShareAppMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(){o.apply(this,arguments),e.ALUtil.LOG("ALIntercept offShareAppMessage !!!")}}),t._onShareApp=t.EmptyFn},t._handleShareParam=function(t,n){void 0===n&&(n=!0);var r=t.query||"",o=t.imageUrl,i=t.imageUrlId,a=e.ALUtil._parseQueryString(r);e.ALUtil.LOG("ALIntercept _handleShareParam queryObj ",a),e.ALData.shareScene=a.shareScene||0;var s="default";if(!a.Ads){if(e.ALData.sdkData&&e.ALData.sdkData.shares&&e.ALData.sdkData.shares.length>0){var l=Math.floor(Math.random()*e.ALData.sdkData.shares.length),c=e.ALData.sdkData.shares[l];t.imageUrl=c.url,t.title=c.desc,s=c.shareid}else if(i)s=i;else if(o){var u=e.ALUtil.getUrlFileName(o);e.ALUtil.LOG("ALIntercept _handleShareParam ",o,u),s=0!==o.indexOf("http")&&-1===u.indexOf(".")?"screenShot":u.replace(".","_")}var f="&Ads=a_Share&AdsPos="+s;e.ALUtil.LOG("ALIntercept _handleShareParam ads_str ",f),t.query=r+f}n&&e.ALReport.report(e.REPORT_TYPE_SHARE_READY,s)},t._inited=!1,t.TimeShow=null,t.Params=null,t.VideoId=null,t.InfoGot=!1,t.ShareParamFunc=null,t}();e.ALIntercept=t,__reflect(t.prototype,"aladin.ALIntercept")}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function t(){}return t.getAdsPos=function(){return this.Ads+"|"+this.AdsPos},t.init=function(){this._inited||(this._inited=!0,e.ALUtil.LOG("ALReport init "),e.ALUtil.wxqqNotExist()||(this.initStartTime(),this._initAdsPos(),this._initReportData(),e.ALUtil.LOG("ALReport init success")))},t.initStartTime=function(){t.startTime=(new Date).getTime(),e.ALUtil.LOG("初始化游戏开始时间",t.startTime)},t.reportTime=function(n){if(0!=t.startTime){var r=(new Date).getTime(),o={type:"loadtime",sub_type:e.REPORT_TYPE_TIME,data:n,now:r,start:t.startTime,extra:r-t.startTime};this.reportDataToMarket(o)}},t.reportAnalytics=function(t,n){if(isNaN(n))return void e.ALUtil.LOG("ALReport step error --- ",n);this._inited||(e.ALConfig.appId=t,this.init()),this._initReportData();var r=this.reportPrefix+this._getCurrentDate()+"|"+this._getTimeStamp()+"|"+this.reportDevice2Sence+e.ALData.level+"|0|"+e.ALConfig.openId+"|10|"+n+"||||"+e.ALData.topInviter+"|"+e.UserInfoData.Gender;e.ALUtil.LOG("ALReport reportAnalytics str --- ",r);var o=e.StringUtil.base64encode(r);e.HttpUtil.POST(e.ALConfig.ReportDataDomain+"/report",{info:o},function(t){t.isSucc||e.ALUtil.LOG("ALReport reportAnalytics fail --- ",t.reason)})},t.report=function(t,n){if(this._inited||this.init(),t==e.REPORT_TYPE_TIME)return void this.reportTime(n);var r=t.split("_");if(r.length<2)return void console.warn("ALReport 参数传递错误");var o=n||"";if(t===e.REPORT_TYPE_OPEN_ID)return e.ALConfig.openId=n,window.ALOpenId=n,this.reportOpenId(),void this._initLevelData();var i=r[0],a=r[1];this._initReportData();var s=this.reportPrefix+this._getCurrentDate()+"|"+this._getTimeStamp()+"|"+this.reportDevice2Sence+e.ALData.level+"|0|"+e.ALConfig.openId+"|"+i+"|"+a+"|0|"+o+"||"+e.ALData.topInviter+"|"+e.UserInfoData.Gender;e.ALUtil.LOG("ALReport _report str --- ",s);var l=e.StringUtil.base64encode(s);e.HttpUtil.POST(e.ALConfig.ReportDataDomain+"/report",{info:l},function(t){t.isSucc||e.ALUtil.LOG("ALReport _report fail --- ",t.reason)})},t.reportOpenId=function(){var n={type:"openId",sub_type:e.REPORT_TYPE_OPEN_ID,extra:this.getAdsPos()};if(e.UserInfoData.InitUserinfo(),e.ALUtil.wxqqExist()){var r=e.ALUtil.wxExist()?wx:qq;r.getUserInfo({complete:function(o){o&&o.userInfo&&(n.nickName=o.userInfo.nickName||"",n.avatarUrl=o.userInfo.avatarUrl||"",n.country=o.userInfo.country||"",n.gender=void 0!==o.userInfo.gender?o.userInfo.gender:0,n.language=o.userInfo.language||"",n.province=o.userInfo.province||"");try{r.getSystemInfo({success:function(e){n.model=e.model},complete:function(){r.getNetworkType({success:function(e){n.networkType=e.networkType},complete:function(){t.reportDataToMarket(n)}})}})}catch(i){t.reportDataToMarket(n)}e.UserInfoData.InitUserinfo()}})}else t.reportDataToMarket(n)},t.reportPay=function(t){e.ALUtil.LOG("拦截支付数据",t);var n={type:"pay",sub_type:e.REPORT_TYPE_PAY_MENT_ENTER,extra:t};this.reportDataToMarket(n)},t.reportShareState=function(t){var n=t?"1":"2",r={type:"share",sub_type:e.REPORT_TYPE_SHARE_SUCCESS,diff_key:n};this.reportDataToMarket(r)},t.reportDataToMarket=function(t){t.id=e.ALConfig.appId,t.openid=e.ALConfig.openId,e.ALUtil.LOG("reportDataToMarket param --- ",t),e.HttpUtil.POST(e.ALConfig.ReportMarketDomain+"/box/stats_sdk",t,function(t){t.isSucc||e.ALUtil.LOG("ALReport reportServer fail --- ",t.reason)})},t._initAdsPos=function(){var t="",n="";try{var r=e.ALUtil.wxExist()?wx:qq,o=r.getLaunchOptionsSync();e.ALUtil.LOG("ALReport opts --- ",o),e.ALData.opts=o,e.ALData.scene=o.scene;var i=o.query;if(i.scene){var a=decodeURIComponent(i.scene).split(",");t=a[1],n=a[2]}else if(i.Ads||i.AdsPos)t=i.Ads?i.Ads:"",n=i.AdsPos?i.AdsPos:"";else if(o.referrerInfo&&o.referrerInfo.extraData){var s=o.referrerInfo.extraData;t=s.Ads?s.Ads:"",n=s.AdsPos?s.AdsPos:""}""===t&&("1037"==o.scene?(t="fromMini",n=o.referrerInfo.appId||"0"):(t=e.ALUtil.qqExist()?"qq":"weixin",n=o.scene||"0"))}catch(l){console.log("ALReport _initAdSource catch--- ",l)}if(this.Ads=t,this.AdsPos=n,1044==e.ALData.scene||1007==e.ALData.scene||1036==e.ALData.scene||1008==e.ALData.scene){var i=e.ALData.opts.query;e.ALData.topInviter=i.a_top_inviter||"0",e.ALData.level=i.a_level||1}},t._initLevelData=function(){var t=null;if(1044==e.ALData.scene||1007==e.ALData.scene||1036==e.ALData.scene||1008==e.ALData.scene){var n=e.ALData.opts.query;t={appid:e.ALConfig.appId,openid:e.ALConfig.openId,level:n.a_level||"",inviter:n.a_inviter||"",top_inviter:n.a_top_inviter||""}}else t={appid:e.ALConfig.appId,openid:e.ALConfig.openId};e.HttpUtil.GET(e.ALConfig.ReportMarketDomain+"/box/accountinfo",t,function(t){if(t.isSucc){var n=t.data.info;e.ALUtil.LOG("ALReport _initLevelData data --- ",t.data),e.ALUtil.LOG("初始化得到的分享数据：",n),e.ALData.topInviter=n.top_inviter||"0",e.ALData.inviter=e.ALConfig.openId,e.ALData.level=n.share_level?parseInt(n.share_level)+1:1,e.ALData.score=n.score?parseInt(n.score):0,e.ALIntercept._execOnShareApp()}else e.ALUtil.LOG("ALReport _initLevelData fail --- ",t.reason)})},t._initReportData=function(){var t="",n="",r="",o="",i="";try{var a=e.ALUtil.wxExist()?wx:qq,s=a.getSystemInfoSync();t=s.platform,n=s.model,r=s.system,o=s.language,i=s.version}catch(l){console.warn("ALReport _initParam error--- ",l)}n&&"unknown"!==n?(-1!=n.toLowerCase().indexOf("iphone")||-1!=n.toLowerCase().indexOf("ipad"))&&(n="ios"):n="android",this.reportPrefix="t_event|distribute_all|",this.reportDevice2Sence=t+"|"+n+"|"+e.ALConfig.version+"|"+r+"||0.0.0.0||"+o+"||"+i+"|"+e.ALConfig.appId+"|"+this.Ads+"|"+this.AdsPos+"|"},t._getCurrentDate=function(){var e=new Date,t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),r=e.getDate().toString();1===n.length&&(n="0"+n),1===r.length&&(r="0"+r);var o=t+n+r;return o},t._getTimeStamp=function(){return Math.round(Date.now()/1e3)},t.Ads="",t.AdsPos="",t.reportPrefix="",t.reportDevice2Sence="",t._inited=!1,t.startTime=0,t}();e.ALReport=t,__reflect(t.prototype,"aladin.ALReport"),e.REPORT_TYPE_SHOW="1_1",e.REPORT_TYPE_LOGIN="1_2",e.REPORT_TYPE_OPEN_ID="1_3",e.REPORT_TYPE_AUTH="1_4",e.REPORT_TYPE_LIKE_CLICK="1_6",e.REPORT_TYPE_LIKE_SHOW="1_8",e.REPORT_TYPE_DRAWER_CLICK="1_7",e.REPORT_TYPE_DRAWER_SHOW="1_9",e.REPORT_TYPE_CLICK_SUCCESS="3_1",e.REPORT_TYPE_SHARE_READY="1_10",e.REPORT_TYPE_SHARE_SUCCESS="1_5",e.REPORT_TYPE_GAME_DURATION="1_12",e.REPORT_TYPE_SCENE_CLICK="1_13",e.REPORT_TYPE_SCENE_CLICK_SUCCESS="1_14",e.REPORT_TYPE_PAY_MENT="6_0",e.REPORT_TYPE_PAY_MENT_START="6_2",e.REPORT_TYPE_PAY_MENT_ENTER="6_3",e.REPORT_TYPE_MORE_SHOW="2_0",e.REPORT_TYPE_MORE_CLICK="2_1",e.REPORT_TYPE_MORE_CLICK_O="2_2",e.REPORT_TYPE_MORE_LONG_CLICK_O="2_3",e.REPORT_TYPE_VIDEO_OPEN="2_4",e.REPORT_TYPE_VIDEO_WATCH_FAIL="2_5",e.REPORT_TYPE_VIDEO_WATCH_NORMAL="2_6",e.REPORT_TYPE_GAME_BOX_SHOW="8_1",e.REPORT_TYPE_GAME_BOX_CLICK="8_2",e.REPORT_TYPE_GAME_BOX_BANNER_CLICK="8_3",e.REPORT_TYPE_VIDEO_BTN_SHOW="5_6",e.REPORT_TYPE_VIDEO_CLICK="5_7",e.REPORT_TYPE_SHARE_BTN_SHOW="5_8",e.REPORT_TYPE_SHARE_CLICK="5_9",e.REPORT_TYPE_TIME="15_1"
}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function t(){}return t.init2=function(t,n,r,o){this._inited||(this._inited=!0,e.ALConfig.appId=t,e.ALConfig.version=n)},t.toMiniProgram=function(n,r,o,i){var a=e.ALUtil.parseNavigateParam(n),s=n[14]||n[4],l={appid:a.target_appid,type:"click",sub_type:r,diff_key:s,extra:o,scene:i},c={appid:a.target_appid,type:"jump",sub_type:e.REPORT_TYPE_SCENE_CLICK_SUCCESS,extra:o,scene:i};if(e.ALUtil.LOG("[aladinsdk] 跳转参数如下：",n),e.ALUtil.LOG("[aladinsdk] data.appId:>>",a.appId),e.ALUtil.LOG("[aladinsdk] data.path:>>",a.path),e.ALUtil.LOG("[aladinsdk] data.extraData:>>",a.extraData),e.ALUtil.LOG("[aladinsdk] Data.conf.envVersion:>>",e.ALConfig.envVersion),!e.ALUtil.wxqqNotExist()){var u=n[6]||null,f=e.ALUtil.qqExist()?qq:wx;e.ALReport.reportDataToMarket(l),u||!f.navigateToMiniProgram?t._preview(u,c):f.navigateToMiniProgram({appId:a.appId,path:a.path,extraData:a.extraData,envVersion:e.ALConfig.envVersion,success:function(t){e.ALReport.reportDataToMarket(c)},fail:function(n){e.ALUtil.LOG("ALSDK navigateToMiniProgram fail ",n),n&&n.errMsg&&-1===n.errMsg.indexOf("cancel")&&u&&t._preview(u,c)}})}},t._preview=function(t,n){var r=e.ALUtil.qqExist()?qq:wx;r.previewImage({urls:[t],success:function(){e.ALUtil.LOG("ALSDK _preview success "),e.ALReport.reportDataToMarket(n)},fail:function(e){console.warn("ALSDK _preview error ",e)}})},t.requestModuleData=function(n,r){e.ALUtil.readAppIDList().then(function(o){var i={id:e.ALConfig.appId,module:n,appidList:o,openid:e.ALConfig.openId,nickName:e.UserInfoData.NickName,avatarUrl:e.UserInfoData.AvatarUrl,country:e.UserInfoData.Country,gender:e.UserInfoData.Gender,language:e.UserInfoData.Language,province:e.UserInfoData.Province},a="Icon"===n?e.ALData.iconData:e.ALData.moreData;return a?void r(a):void e.HttpUtil.GET(e.ALConfig.ReportMarketDomain+"/box/sdk/module",i,function(o){if(!o.isSucc)return void console.warn("ALSDK requestModuleData fail !!!",o.reason,n);var i=t.handleHttpData(o);"Icon"===n?e.ALData.iconData=i:"more"===n&&(e.ALData.moreData=i),r(i)})})},t.handleHttpData=function(e){var t=e.data.values||[],n=e.data.base;if(n&&t.length>0)for(var r=0,o=t.length;o>r;r++){var i=t[r];i[4]=n+i[4]}return t},t._inited=!1,t}();e.ALSDK=t,__reflect(t.prototype,"aladin.ALSDK"),e.SDK_MODULE_LIKE="Icon",e.SDK_MODULE_ICONS_CLICK="ICONS_CLICK",e.SDK_MODULE_BANNER_CLICK="BANNER_CLICK"}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function t(){}return t.LOG=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.DEBUG&&console.log("[AladinSDK]",e,t)},t.wxNotExist=function(){return"undefined"==typeof wx?!0:!1},t.wxExist=function(){return"undefined"==typeof wx?!1:!0},t.qqNotExist=function(){return"undefined"==typeof qq?!0:!1},t.qqExist=function(){return"undefined"==typeof qq?!1:!0},t.wxqqExist=function(){return"undefined"==typeof wx&&"undefined"==typeof qq?!1:!0},t.wxqqNotExist=function(){return"undefined"==typeof wx&&"undefined"==typeof qq?!0:!1},t.readAppIDList=function(){return new Promise(function(e,n){var r=t.qqExist()?qq:wx,o="devtools"===r.getSystemInfoSync().platform?"game.json":"app-config.json",i=r.getFileSystemManager();i.readFile({filePath:o,encoding:"utf-8",success:function(n){var r=n.data,o=JSON.parse(r),i=o.navigateToMiniProgramAppIdList,a="";i&&(a=i.join(",")),t.LOG("ALSDK readAppIDList appIdListStr ",a),e(a)},fail:function(n){t.LOG("ALSDK readAppIDList error ",n),e("")}})})},t.getUrlFileName=function(e){return e.split("/").pop().split("?")[0].split("#")[0]},t.getUrlReportName=function(t){var n=t.split(e.ALConfig.ImgDomain);return n.length>1?n[1].toString():n[0].toString()},t._buildQueryString=function(e){var t=new Array;for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+e[n]);return t.join("&")},t._mergeParams=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},t._parseQueryString=function(e){var t={};if(!e)return t;for(var n=e.split("&"),r=null,o=0,i=n.length;i>o;o++)r=n[o].split("="),t[r[0]]=r[1];return t},t.parseNavigateParam=function(e){var t=e[0],n=e[1],r=e[2]||"pages/index/index",o=this._parseQueryString(e[3]);if(r.indexOf("?")>-1){var i=r.split("?"),a=this._parseQueryString(i[1]);this._mergeParams(o,a)}o.tgt=e[1],r+="?"+this._buildQueryString(o);var s={appId:t,path:r,extraData:o,target_appid:n};return s},t.DEBUG=!0,t}();e.ALUtil=t,__reflect(t.prototype,"aladin.ALUtil")}(aladin||(aladin={}));var aladin;!function(e){e.METHOD_GET="GET",e.METHOD_POST="POST";var t=function(){function t(){}return t.GET=function(t,n,r,o){this._request(t,e.METHOD_GET,n,r,o)},t.POST=function(t,n,r,o){this._request(t,e.METHOD_POST,n,r,o)},t._request=function(t,n,r,o,i){if(e.ALUtil.LOG("请求参数[param]",r),"undefined"!=typeof wx||"undefined"!=typeof qq){"GET"==n&&r&&(t+=encodeURI("?"+this.objParam2PostString(r))),e.ALUtil.LOG("HttpUtil url ----- ",t);var a={url:t,method:n,success:function(t){e.ALUtil.LOG("HttpUtil responseText---",t);try{var n=t.data;return n&&0!==n.code&&0!==n.ret?(e.ALUtil.LOG("HttpUtil json---"),void o({isSucc:!1,reason:n.msg})):void o({isSucc:!0,data:n?n.data:null})}catch(r){return e.ALUtil.LOG("HttpUtil parse---",r),void o({isSucc:!1,reason:"json_parse_error"})}},fail:function(t){e.ALUtil.LOG("HttpUtil fail---",t),o({isSucc:!1,reason:"network_error"})}};this.Authorization?a.header={"content-type":"application/x-www-form-urlencoded",Authorization:this.Authorization}:a.header={"content-type":"application/x-www-form-urlencoded"},r&&(a.data=r);var s=e.ALUtil.wxExist()?wx:qq;s.request(a)}else{var l=new XMLHttpRequest,c=null;"GET"==n?r&&(t+=encodeURI("?"+this.objParam2PostString(r))):c=null==r?null:encodeURI(this.objParam2PostString(r)),l.open(n,t,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.Authorization&&l.setRequestHeader("Authorization",this.Authorization),l.onreadystatechange=function(){if(4===l.readyState&&l.status>199&&l.status<400){e.ALUtil.LOG("HttpUtil responseText---",l.responseText);try{var t=l.responseText?JSON.parse(l.responseText):null,n=t;return n&&0!==n.code&&0!==n.ret?(e.ALUtil.LOG("HttpUtil json---"),void o({isSucc:!1,reason:n.msg})):void o({isSucc:!0,data:n?n.data:null})}catch(r){return e.ALUtil.LOG("HttpUtil parse---",r),void o({isSucc:!1,reason:"json_parse_error"})}}},l.onerror=function(t){e.ALUtil.LOG("HttpUtil onerror---",t),o({isSucc:!1,reason:"network_error"})},l.ontimeout=function(t){e.ALUtil.LOG("HttpUtil ontimeout---",t),o({isSucc:!1,reason:"timeout_error"})},l.send(c)}},t.objParam2PostString=function(e){var t="";for(var n in e)t+=n+"="+e[n],t+="&";return""!=t&&(t=t.slice(0,t.length-1)),t},t.Authorization=null,t}();e.HttpUtil=t,__reflect(t.prototype,"aladin.HttpUtil")}(aladin||(aladin={}));var aladin;!function(e){var t=function(){function e(){}return e.base64encode=function(e){var t,n,r,o,i,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(r=e.length,n=0,t="";r>n;){if(o=255&e.charCodeAt(n++),n==r){t+=s.charAt(o>>2),t+=s.charAt((3&o)<<4),t+="==";break}if(i=e.charCodeAt(n++),n==r){t+=s.charAt(o>>2),t+=s.charAt((3&o)<<4|(240&i)>>4),t+=s.charAt((15&i)<<2),t+="=";break}a=e.charCodeAt(n++),t+=s.charAt(o>>2),t+=s.charAt((3&o)<<4|(240&i)>>4),t+=s.charAt((15&i)<<2|(192&a)>>6),t+=s.charAt(63&a)}return t},e}();e.StringUtil=t,__reflect(t.prototype,"aladin.StringUtil")}(aladin||(aladin={}));var qmr;!function(e){var t=function(){function e(){}return e.BODY=0,e.WEAPON=1,e.WING=2,e.HORSE=4,e.HORSE_UP=5,e.SHIELD=6,e.DEFAULT=7,e}();e.ActorPart=t,__reflect(t.prototype,"qmr.ActorPart")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.parseMsg=function(n){var r=n.readInt()-t.ADD_L,o=n.readInt(),i=e.ByteArrayPool.getInstance().createByte();n.readBytes(i,0,r);var a=this.decryptForDis(i);e.ByteArrayPool.getInstance().recycleByte(i),e.Rpc.getInstance().onDataIn(o,a),e.ByteArrayPool.getInstance().recycleByte(a)},t.getSendMsg=function(n,r,o){void 0===o&&(o=!1);var i=e.MessageIDLogin.getMsgNameById(r);if(e.MessageID&&e.MessageID.getMsgNameById){var a=e.MessageID.getMsgNameById(r);a&&(i=a)}var s,l=com.message[i].encode(n).finish(),c=l.byteLength;if(void 0==i||void 0==r)return e.LogUtil.log("[send:error:"+n+"]"),s;o&&e.PlatformConfig.isDebug&&e.LogUtil.log("[C_S:"+r+" "+i+"] msgLength:"+c);var u=this.encryptForDis(l,c);return s=e.ByteArrayPool.getInstance().createByte(),s.writeInt(c+t.ADD_L),s.writeInt(r),s.writeBytes(u),e.ByteArrayPool.getInstance().recycleByte(u),s},t.encryptForDis=function(t,n){var r=e.ByteArrayPool.getInstance().createByte();r._writeUint8Array(t);for(var o,i=r.bytes,a=0;n>a&&!(a+3>n-1);a+=5)o=~i[a+2],i[a+2]=i[a+3],i[a+3]=o;return r},t.decryptForDis=function(t){var n=e.ByteArrayPool.getInstance().createByte();n.writeBytes(t);for(var r,o=n.bytes,i=o.byteLength,a=0;i>a&&!(a+3>i-1);a+=5)r=o[a+2],o[a+2]=~o[a+3],o[a+3]=r;return n},t.KEY="",t.ADD_L=4,t}();e.BufferGid=t,__reflect(t.prototype,"qmr.BufferGid")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this.byteList=[];for(var e=0;20>e;e++){var t=new egret.ByteArray;t.endian=egret.Endian.BIG_ENDIAN,this.byteList.push(t)}}return e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.createByte=function(){if(this.byteList.length>0)return this.byteList.shift();var e=new egret.ByteArray;return e.endian=egret.Endian.BIG_ENDIAN,e},e.prototype.recycleByte=function(e){e.clear(),this.byteList.push(e)},e}();e.ByteArrayPool=t,__reflect(t.prototype,"qmr.ByteArrayPool")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this._counter=-1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getCountter=function(){return this._counter+=1,this._counter},e.prototype.resetCounter=function(){this._counter=-1},e.maxReconnectCount=3,e}();e.PbGlobalCounter=t,__reflect(t.prototype,"qmr.PbGlobalCounter")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e}();e.RequestHandler=t,__reflect(t.prototype,"qmr.RequestHandler")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.eventPool={},this.callbackPool={}}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.addSocketListener=function(t,n,r,o){if(void 0===o&&(o=!1),null!=this.eventPool[t])return void e.LogUtil.error("[error = addSocketListener 添加重复的消息 msgId="+t+"]");var i=new e.RequestHandler;i.callBack=n,i.thisObject=r,i.isRpc=!1,i.isLog=o,this.eventPool[t]=i},t.prototype.removeSocketListener=function(e,t,n){this.eventPool[e]&&delete this.eventPool[e]},t.prototype.connect=function(t,n,r,o){this.close(),this.loginSocket=new e.WebSocket,this.loginSocket.connect(t,n,function(){r.call(o)},this.onConnectClose,this.onConnectClose,this)},t.prototype.sendCmd=function(e,t,n){void 0===n&&(n=!1),this.loginSocket&&this.loginSocket.sendCmd(e,t,n)},t.prototype.rpcCMD=function(t,n,r,o,i,a,s,l){if(void 0===a&&(a=null),void 0===s&&(s=10),void 0===l&&(l=!1),null!=this.callbackPool[t])return void e.LogUtil.warn("[error = rpcCMD 添加重复的消息 eventMsgId="+t+"]");var c=new e.RequestHandler;c.callBack=o,c.thisObject=i,c.timeOutCallBack=a,c.timeOut=s,c.isRpc=!0,c.isLog=l,c.sendTime=Date.now(),this.callbackPool[t]=c,this.sendCmd(n,r,l),e.Ticker.getInstance().unRegisterTick(this.checkTimeOut,this),e.Ticker.getInstance().registerTick(this.checkTimeOut,this,1e3)},t.prototype.onDataIn=function(t,n){var r=e.ProtoMsgIdMapLogin.instance.msgIdMap;e.ProtoMsgIdMap&&e.ProtoMsgIdMap.instance&&e.ProtoMsgIdMap.instance.msgIdMap&&(r=e.ProtoMsgIdMap.instance.msgIdMap);var o=r[t];if(null==o)return void e.LogUtil.error("[尚未注册 ProtoMsgIdMap.instance.msgIdMap["+t+"] = null]");var i=n.buffer,a=new Uint8Array(i),s=o.decode(a),l=this.eventPool[t];l?(l.isLog&&e.LogUtil.log("[S_C:"+t+" "+o.name+"]"),l.clientData?l.callBack.call(l.thisObject,s,l.clientData):l.callBack.call(l.thisObject,s),l=null):e.LogUtil.error("[未监听协议 [msgId="+t+"]");var c=this.callbackPool[t];c&&c.callBack&&(delete this.callbackPool[t],c.clientData?c.callBack.call(c.thisObject,s,c.clientData):c.callBack.call(c.thisObject,s),c=null)},Object.defineProperty(t.prototype,"isconnect",{get:function(){return this.loginSocket?this.loginSocket.isconnected:!0},enumerable:!0,configurable:!0}),t.prototype.onConnectClose=function(){var n=this;e.PbGlobalCounter.getInstance().resetCounter(),e.SystemController.instance.clearHeart(),e.LoginModel.instance.isInstead?n.showDisConnectView("您的账号在另一台设备登录，请重新登录"):e.LoginModel.instance.isDisconnect?n.showDisConnectView("小伙子，不要开车，你掉线了"):e.PbGlobalCounter.maxReconnectCount>0?(e.PbGlobalCounter.maxReconnectCount--,t.getInstance().close(),e.LoginModel.instance.isEnterGame?(e.GameLoading.getInstance().setLoadingTip("重连中..."),egret.setTimeout(function(){t.getInstance().startReConnect()},n,2e3)):egret.setTimeout(function(){t.getInstance().startReLogin()},n,2e3)):e.LoginModel.instance.isEnterGame?n.showDisConnectView("重连服务器失败，请检查手机网络环境!"):(e.PbGlobalCounter.maxReconnectCount=3,t.getInstance().close(),e.GameLoading.getInstance().close(),e.TipManagerCommon.getInstance().createCommonColorTip("连接服务器失败，请重试！",!1))},t.prototype.showDisConnectView=function(t){e.GameLoading.getInstance().close(),e.ModuleManager.showModule(e.ModuleNameLogin.DISCONNECT_VIEW,{msg:t,code:-1},e.LayerConst.TIP,!0,!1)},t.prototype.startReConnect=function(){this.connect(e.GlobalConfig.loginServer,e.GlobalConfig.loginPort,this.onGameServerConnect,this)},t.prototype.onGameServerConnect=function(){e.GameLoading.getInstance().setLoadingTip("重连中..."),e.LoginController.instance.reqReconnect()},t.prototype.startReLogin=function(){this.connect(e.GlobalConfig.loginServer,e.GlobalConfig.loginPort,this.onGameLoginServerConnect,this)},t.prototype.onGameLoginServerConnect=function(){e.GameLoading.getInstance().setLoadingTip("登录中..."),e.LoginController.instance.reqRelogin()},t.prototype.onConnnectError=function(){e.PbGlobalCounter.getInstance().resetCounter(),e.LogUtil.log("ioerror")},t.prototype.close=function(){this.loginSocket&&(this.loginSocket.dispos(),this.loginSocket=null)},t.prototype.fnErrorTrap=function(){},t.prototype.checkTimeOut=function(){var e=this.callbackPool;for(var t in e){var n=e[t];n&&n.isRpc&&Date.now()-n.sendTime>1e3*n.timeOut&&delete e[t]}},t}();e.Rpc=t,__reflect(t.prototype,"qmr.Rpc")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.WEB_KEY="/ws",this.websocket=new egret.WebSocket,this.websocket.type=egret.WebSocket.TYPE_BINARY,this.websocket.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.websocket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.websocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onDataIn,this),this.websocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIoError,this)}return t.prototype.connect=function(t,n,r,o,i,a){this.connectCallBack=r,this.connectCloseBack=o,this.connectErrorBack=i,this.thisObject=a;var s=e.PlatformManager.instance,l=s.platform.webSocketProtoco,c="",u=s.isOutNetPlatForm;u?(c=l+"://"+t+"/s"+e.GlobalConfig.sid,e.PlatformConfig.isWSS&&(c="wss://"+t+"/s"+e.GlobalConfig.sid)):c="ws://"+t+":"+n+this.WEB_KEY,this.websocket.connectByUrl(c),this.clearConTimeout(),this.tid=egret.setTimeout(this.onTimeOut,this,1e4),e.LogUtil.log("链接的服务器和端口:"+c)},t.prototype.onTimeOut=function(){this.clearConTimeout(),this.connectCloseBack&&this.connectCloseBack.call(this.thisObject),e.LogUtil.log("10秒链接不上超时")},t.prototype.onSocketConnected=function(t){this._isConnect=!0,this.clearConTimeout(),this.connectCallBack&&this.connectCallBack.call(this.thisObject),e.LogUtil.log("连接服务器成功！")},t.prototype.onSocketClose=function(t){this._isConnect=!1,this.clearConTimeout(),this.connectCloseBack&&this.connectCloseBack.call(this.thisObject),e.LogUtil.log("服务器连接关闭")},t.prototype.onDataIn=function(t){if(this.websocket){var n=e.ByteArrayPool.getInstance().createByte();for(this.websocket.readBytes(n);n.bytesAvailable;)e.BufferGid.parseMsg(n);e.ByteArrayPool.getInstance().recycleByte(n)}},t.prototype.onIoError=function(t){this._isConnect=!1,this.clearConTimeout(),this.connectErrorBack&&this.connectErrorBack.call(this.thisObject),e.LogUtil.log("服务器连接错误")},t.prototype.sendCmd=function(t,n,r){if(void 0===r&&(r=!1),this.isconnected){var o=e.BufferGid.getSendMsg(t,n,r);o&&(this.websocket.writeBytes(o),this.websocket.flush(),e.ByteArrayPool.getInstance().recycleByte(o)),t=null}},Object.defineProperty(t.prototype,"isconnected",{get:function(){return this._isConnect&&this.websocket&&this.websocket.connected},enumerable:!0,configurable:!0}),t.prototype.clearConTimeout=function(){this.tid&&(egret.clearTimeout(this.tid),this.tid=0)},t.prototype.dispos=function(){var e=this;e.clearConTimeout(),null!=e.websocket&&(e.websocket.removeEventListener(egret.Event.CONNECT,e.onSocketConnected,e),e.websocket.removeEventListener(egret.Event.CLOSE,e.onSocketClose,e),e.websocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,e.onDataIn,e),e.websocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.onIoError,e),e.isconnected&&(e._isConnect=!1,e.websocket.close()),e.websocket=null),e.connectCallBack=null,e.connectCloseBack=null,e.connectErrorBack=null,e.thisObject=null},t}();e.WebSocket=t,__reflect(t.prototype,"qmr.WebSocket")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=egret.Sound.EFFECT),this.sound=e,this.isPlay=!1,this.type=t,null!=e&&(this.sound.type=t)}return e.prototype.play=function(e,t){void 0===t&&(t=0),null!=this.sound&&(this.isPlay=!0,this.soundChannel=this.sound.play(e,t),this.soundChannel.once(egret.Event.SOUND_COMPLETE,this.onPlayerEnd,this),this.sound.type==egret.Sound.MUSIC&&(this.soundChannel.volume=.7))},e.prototype.onPlayerEnd=function(){this.isPlay=!1},e.prototype.stop=function(){null!=this.sound&&(this.isPlay=!1,null!=this.soundChannel&&this.soundChannel.stop())},Object.defineProperty(e.prototype,"position",{get:function(){return this.soundChannel?this.soundChannel.position:0},enumerable:!0,configurable:!0}),e}();e.SoundItem=t,__reflect(t.prototype,"qmr.SoundItem")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this._isEffectSoundOpen=!0,this._isMusicSoundOpen=!0,this._isMusicLifecycleOpen=!0,this._soundCfgDic=new e.Dictionary,this._lastMusicPosition=0,this._lastMusicName="",this._musicName="",this._soundPool={},this._isMusicSoundOpen=!e.SettingUtil.getInstance().getForbidState(e.MusicType.BG_MUSIC),this._isEffectSoundOpen=!e.SettingUtil.getInstance().getForbidState(e.MusicType.EFFECT_MUSIC)}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},Object.defineProperty(t.prototype,"soundPool",{get:function(){return this._soundPool},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEffectSoundOpen",{get:function(){return this._isEffectSoundOpen},set:function(e){if(this._isEffectSoundOpen=e,!e)for(var t in this._soundPool){var n=this._soundPool[t];null!=n&&null!=n.sound&&n.sound.type==egret.Sound.EFFECT&&n.stop()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMusicSoundOpen",{get:function(){return this._isMusicSoundOpen},set:function(e){this._isMusicSoundOpen=e,e?(null!=this._bgSoundItem&&this._bgSoundItem.stop(),""!=this._musicName&&(this._bgSoundItem=this._soundPool[this._musicName],this._bgSoundItem?(this._lastMusicName=this._musicName,this._lastMusicPosition=0,this._bgSoundItem.play(0)):this.loadBgMusic(this._musicName))):null!=this._bgSoundItem&&(this._lastMusicPosition=this._bgSoundItem.position,this._bgSoundItem.stop())},enumerable:!0,configurable:!0}),t.prototype.loadAndPlayEffect=function(t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=!1),this._isMusicLifecycleOpen&&this._isEffectSoundOpen){var o=this._soundPool,i=this.getSoundCfg(t);if(!i)return void e.LogUtil.log("音效不存在。。。"+t);var a=i.soundName;if(void 0==a||""==a)return;var s=o[a],l=i.isPlaySameTime>0;if(null==s){var c=RES.getRes(a+"_mp3");if(c){var u=o[a];u||(s=new e.SoundItem(c),o[a]=s),!l||r?!s.isPlay&&s.position<=0&&s.play(0,n):s.play(0,n)}else e.ResManager.getRes(e.SystemPath.getEffect_musicUrl(a),function(t){var i=o[a];if(!i){var s=new e.SoundItem(t);o[a]=s,!l||r?!s.isPlay&&s.position<=0&&s.play(0,n):s.play(0,n)}},this,e.LoadPriority.HIGH,RES.ResourceItem.TYPE_SOUND)}else!l||r?!s.isPlay&&s.position<=0&&s.play(0,n):s.play(0,n)}},t.prototype.stopSoundEffect=function(e){var t=this.getMusicName(e);if(void 0!=t&&""!=t&&this._isEffectSoundOpen){var n=this._soundPool[t];null!=n&&n.stop()}},t.prototype.loadAndPlayMusic=function(e){this._musicName=e,null!=e&&""!=e&&this._isMusicLifecycleOpen&&this._isMusicSoundOpen&&(null!=this._bgSoundItem?this._lastMusicName==e?this._bgSoundItem.position<=0&&(this._bgSoundItem.stop(),this._bgSoundItem.play(0)):(this._bgSoundItem&&this._bgSoundItem.stop(),this._bgSoundItem=this._soundPool[e],this._bgSoundItem?(this._lastMusicName=e,this._lastMusicPosition=0,t.getInstance().isMusicSoundOpen&&this._bgSoundItem.play(0)):this.loadBgMusic(e)):this.loadBgMusic(e))},t.prototype.getMusicName=function(t){var n=this.getSoundCfg(t);return n?n.soundName:(e.LogUtil.log("音效不存在。。。"+t),"")},t.prototype.getMusicIsPlaySameTime=function(t){var n=this.getSoundCfg(t);return n?n.isPlaySameTime:(e.LogUtil.log("音效不存在。。。"+t),0)},t.prototype.getSoundCfg=function(t){if(this._soundCfgDic.has(t))return this._soundCfgDic.get(t);var n=e.ConfigManagerBase.getConf(e.ConfigEnumBase.MUSIC,t);return n&&this._soundCfgDic.set(t,n),n},t.prototype.loadBgMusic=function(n){var r=this.getMusicName(n);if(void 0!=r&&""!=r){this._lastMusicName=r;var o=this;e.ResManager.getRes(e.SystemPath.bg_music+r+".mp3",function(r){var i=new e.SoundItem(r,egret.Sound.MUSIC);o._soundPool[n]=i,o._bgSoundItem&&o._bgSoundItem.stop(),o._bgSoundItem=i,o._lastMusicPosition=0,t.getInstance().isMusicSoundOpen&&o._bgSoundItem.play(0)},this,e.LoadPriority.LOW,RES.ResourceItem.TYPE_SOUND)}},t.prototype.stopMusic=function(){var e=this._bgSoundItem;null!=e&&e.isPlay&&e.stop(),this._isMusicLifecycleOpen=!1},t.prototype.reStartMusic=function(){this._isMusicLifecycleOpen||(this._isMusicLifecycleOpen=!0,this.loadAndPlayMusic(this._lastMusicName))},t}();e.SoundManager=t,__reflect(t.prototype,"qmr.SoundManager")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this.scale=1,this.eventList=[],this._running=!1,this.start()}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.start=function(){if(!this._running){for(var e=0,t=this.eventList;e<t.length;e++){var n=t[e];n&&(n.lastCount=n.updateInterval,n.lastTimeStamp=egret.getTimer())}egret.startTick(this.update,this),this._running=!0}},e.prototype.update=function(e){for(var t=0,n=this.eventList;t<n.length;t++){var r=n[t];if(r){var o=e-r.lastTimeStamp;if(o*=this.scale,o>=r.delay){var i=Math.floor(o/r.delay);for(i>4&&(i=4);i>0;)if(i--,0==r.repeatCount)r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));else{r.currentCount++;var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}r.lastTimeStamp=e,r.lastCount=r.updateInterval}else{if(r.lastCount-=1e3*this.scale,r.lastCount>0)continue;if(r.lastCount+=r.updateInterval,r.lastTimeStamp=e,r.currentCount++,0==r.repeatCount)r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));else{var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}}}}return!1},e.prototype.stop=function(){this._running&&(egret.stopTick(this.update,this),this._running=!1)},Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),e.prototype.registerTick=function(e,t,r,o,i){void 0===r&&(r=1e3),void 0===o&&(o=0),void 0===i&&(i=null);for(var a=!0,s=0,l=this.eventList;s<l.length;s++){var c=l[s];if(c.callBack==e&&c.thisObject==t){c.update(r,o),c.params=i,a=!1;break}}if(a){var u=new n(r,o);u.callBack=e,u.params=i,u.thisObject=t,this.eventList.push(u)}},e.prototype.unRegisterTick=function(e,t){for(var n=0,r=this.eventList;n<r.length;n++){var o=r[n];if(o.callBack==e&&o.thisObject==t){var i=this.eventList.indexOf(o);-1!=i&&this.eventList.splice(i,1);break}}},e.prototype.clearAllTick=function(){this.eventList.length=0},e.prototype.test=function(){console.warn("FightTicker:eventList.length...............................",this.eventList.length),console.warn(this.eventList)},e}();e.FightTimer=t,__reflect(t.prototype,"qmr.FightTimer");var n=function(){function e(e,t){void 0===t&&(t=0),this.lastTimeStamp=0,this.currentCount=0,this.update(e,t)}return e.prototype.update=function(e,t){void 0===t&&(t=0),this.currentCount=0,1>e&&(e=1),this._delay!=e&&(this._delay=e,this.lastCount=this.updateInterval=Math.round(60*e),this.lastTimeStamp=egret.getTimer(),this._repeatCount=0|+t)},Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},enumerable:!0,configurable:!0}),e}();__reflect(n.prototype,"TickParams")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this.eventList=[],this._running=!1,this.start()}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.start=function(){if(!this._running){for(var e=0,t=this.eventList;e<t.length;e++){var n=t[e];n&&(n.lastCount=n.updateInterval,n.lastTimeStamp=egret.getTimer())}egret.startTick(this.update,this),this._running=!0}},e.prototype.update=function(e){for(var t=0,n=this.eventList;t<n.length;t++){var r=n[t];if(r){var o=e-r.lastTimeStamp;if(o>=r.delay){var i=Math.floor(o/r.delay);for(i>4&&(i=4);i>0;)if(i--,0==r.repeatCount)r.callBack&&r.callBack.call(r.thisObject);else{r.currentCount++;var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&r.callBack.call(r.thisObject);var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}r.lastTimeStamp=e,r.lastCount=r.updateInterval}else{if(r.lastCount-=1e3,r.lastCount>0)continue;if(r.lastCount+=r.updateInterval,r.lastTimeStamp=e,r.currentCount++,0==r.repeatCount)r.callBack&&r.callBack.call(r.thisObject);else{var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&r.callBack.call(r.thisObject);var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}}}}return!1},e.prototype.stop=function(){this._running&&(egret.stopTick(this.update,this),this._running=!1)},Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),e.prototype.registerTick=function(e,t,r,o){void 0===r&&(r=1e3),void 0===o&&(o=0);for(var i=!0,a=this.eventList,s=0,l=a;s<l.length;s++){var c=l[s];if(c.callBack==e&&c.thisObject==t){c.update(r,o),i=!1;break}}if(i){var u=new n(r,o);u.callBack=e,u.thisObject=t,a.push(u)}},e.prototype.unRegisterTick=function(e,t){for(var n=this.eventList,r=0,o=n;r<o.length;r++){var i=o[r];if(i.callBack==e&&i.thisObject==t){var a=n.indexOf(i);-1!=a&&n.splice(a,1);break}}},e.prototype.test=function(){console.warn("Ticker info......................................................",this.eventList.length),console.warn(this.eventList)},e}();e.Ticker=t,__reflect(t.prototype,"qmr.Ticker");var n=function(){function e(e,t){void 0===t&&(t=0),this.lastTimeStamp=0,this.currentCount=0,this.update(e,t)}return e.prototype.update=function(e,t){void 0===t&&(t=0),this.currentCount=0,1>e&&(e=1),this._delay!=e&&(this._delay=e,this.lastCount=this.updateInterval=Math.round(60*e),this.lastTimeStamp=egret.getTimer(),this._repeatCount=0|+t)},Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},enumerable:!0,configurable:!0}),e}();__reflect(n.prototype,"TickParams")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.checkAvalibe=function(e,t){var n=!1;return 1==(e>>t-1&1)&&(n=!0),n},e.changeBit=function(e,t,n){var r=Math.pow(2,t-1);return e&r?n||(e-=r):n&&(e+=r),e},e.inToBytes=function(e){var t=[];return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=255&e,t},e}();e.BitUtil=t,__reflect(t.prototype,"qmr.BitUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.loadScript=function(e,t,n){var r=window.document.createElement("script");r.type="text/javascript",t?r.src=decodeURIComponent(e):r.src=e,window.document.head.appendChild(r),r.onload=function(){r.onload=null,n()}},e}();e.ChannelUtil=t,__reflect(t.prototype,"qmr.ChannelUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.getColorByQuality=function(t){switch(t){case 1:return e.ColorQualityConst.COLOR_G;case 2:return e.ColorQualityConst.COLOR_GREEN;case 3:return e.ColorQualityConst.COLOR_BLUE;case 4:return e.ColorQualityConst.COLOR_VIOLET;case 5:return e.ColorQualityConst.COLOR_CADMIUM;case 6:return e.ColorQualityConst.COLOR_RED;case 7:return e.ColorQualityConst.COLOR_DIAMOND}return e.ColorQualityConst.COLOR_G},t.getColorBySubType=function(t){switch(t){case 2:return e.ColorQualityConst.COLOR_GREEN;case 3:return e.ColorQualityConst.COLOR_BLUE;case 4:return e.ColorQualityConst.COLOR_VIOLET;case 5:return e.ColorQualityConst.COLOR_CADMIUM;case 6:return e.ColorQualityConst.COLOR_RED}return e.ColorQualityConst.COLOR_G},t.getTipColorByType=function(e){switch(e){case 0:return 16711680;case 1:return 632328}return 16777215},t}();e.ColorUtil=t,__reflect(t.prototype,"qmr.ColorUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getMsg=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();for(var r in e){var o=e[r];n=n.replace(/\{\d+\}/,o)}return n},e}();e.CommonTool=t,__reflect(t.prototype,"qmr.CommonTool")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){var t={};t[e.ActorPart.WEAPON]=e.SystemPath.weaponPath,t[e.ActorPart.WING]=e.SystemPath.wingPath,t[e.ActorPart.HORSE]=e.SystemPath.horsePath,t[e.ActorPart.HORSE_UP]=e.SystemPath.horsePath,t[e.ActorPart.DEFAULT]=e.SystemPath.defaultPath,this.partDic=t}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t}();e.ActorPartResourceDic=t,__reflect(t.prototype,"qmr.ActorPartResourceDic")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.hasDirtywords=function(t,n,r){var o=(new Date).getTime()/1e3|0,i=encodeURI(t),a=encodeURI(e.Md5Util.getInstance().hex_md5(t+o+e.GlobalConfig.loginKey)),s=e.PlatformManager.instance.platform.dirtyWordCheckUrl+"?time="+o+"&content="+i+"&sign="+a;e.LogUtil.log("url=",s),e.HttpRequest.sendGet(s,function(t){e.LogUtil.log("dirtywords",t);var o=!0;if(t){var i=JSON.parse(t);i&&1==i.ret&&(o=!1)}n&&n.call(r,o,t.content)},this)},t}();e.DirtyWordsUtils=t,__reflect(t.prototype,"qmr.DirtyWordsUtils")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getDir=function(t){return 5>=t?t:6==t?e.RIGHT_DOWN:7==t?e.RIGHT:8==t?e.RIGHT_UP:void 0},e.UP=1,e.RIGHT_UP=2,e.RIGHT=3,e.RIGHT_DOWN=4,e.DOWN=5,e.LEFT_DOWN=6,e.LEFT=7,e.LEFT_UP=8,e}();e.DirUtil=t,__reflect(t.prototype,"qmr.DirUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.removeAllChild=function(e){if(e)for(;e.numChildren;){e.removeChildAt(0)}},t.removeDisplay=function(e,t){void 0===t&&(t=null),e&&(t||(t=e.parent),t&&t.removeChild(e))},t.addDisplayToTop=function(e,t){void 0===t&&(t=null),e&&(t||(t=e.parent),t&&t.addChild(e))},t.removeClick=function(e){var t;for(var n in this.eventDic)if(t=this.eventDic[n],t.target==e){t.target.removeEventListener(t.type,t.callBack,t.thisObject),t.target.removeEventListener(t.type,t.callFunc,t.thisCall),delete this.eventDic[n];
break}},t.removeAllEvent=function(e){var t=e.hashCode;delete this.eventDic[t+egret.TouchEvent.TOUCH_BEGIN],delete this.eventDic[t+egret.TouchEvent.TOUCH_END],delete this.eventDic[t+egret.TouchEvent.TOUCH_CANCEL],delete this.eventDic[t+egret.TouchEvent.TOUCH_RELEASE_OUTSIDE]},t.addClick=function(e,t,n,r){if(void 0===r&&(r=null),e){null==this.eventDic&&(this.eventDic={}),e instanceof eui.Group&&(e.touchChildren=!1);var o={};o.target=e,o.type=egret.TouchEvent.TOUCH_BEGIN,o.thisObject=n,o.callFunc=this.onTouchBegin,o.longPressCallBack=r,o.thisCall=this,e&&!this.eventDic[e.hashCode+o.type]&&(e.addEventListener(o.type,this.onTouchBegin,this),this.eventDic[e.hashCode+o.type]=o);var i={};i.target=e,i.type=egret.TouchEvent.TOUCH_END,i.callBack=t,i.thisObject=n,i.callFunc=this.onTouchEnd,i.thisCall=this,e&&!this.eventDic[e.hashCode+i.type]&&(e.addEventListener(i.type,this.onTouchEnd,this),this.eventDic[e.hashCode+i.type]=i);var a={};a.target=e,a.type=egret.TouchEvent.TOUCH_CANCEL,a.callBack=t,a.thisObject=n,a.callFunc=this.onTouchReleaseCancel,a.thisCall=this,e&&!this.eventDic[e.hashCode+a.type]&&(e.addEventListener(a.type,this.onTouchReleaseCancel,this),this.eventDic[e.hashCode+a.type]=a);var s={};s.target=e,s.type=egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,s.thisObject=n,s.callFunc=this.onTouchReleaseOutSide,s.thisCall=this,e&&!this.eventDic[e.hashCode+s.type]&&(e.addEventListener(s.type,this.onTouchReleaseOutSide,this),this.eventDic[e.hashCode+s.type]=s)}},t.onTouchBegin=function(t){this.touchBeginTaret&&this.touchBeginTaret==t.target||egret.getTimer()-this.lastTime<300||(this.touchBeginTaret=t.target,this.lastTime=egret.getTimer(),egret.Tween.get(t.target).to({scaleX:1.1,scaleY:1.1},50),e.Ticker.getInstance().registerTick(this.longPress,this,300))},t.onTouchEnd=function(t){var n=this,r=t.target;this.touchBeginTaret==r&&(this.touchBeginTaret=null,egret.Tween.get(r).to({scaleX:1,scaleY:1},50).call(function(){for(var e in n.eventDic){var t=n.eventDic[e];t.target==r&&t.type==egret.TouchEvent.TOUCH_END&&t.callBack.call(t.thisObject)}},this),e.Ticker.getInstance().unRegisterTick(this.longPress,this))},t.onTouchReleaseCancel=function(e){this.touchBeginTaret==e.currentTarget&&(this.touchBeginTaret&&egret.Tween.removeTweens(this.touchBeginTaret),this.touchBeginTaret=null,e.currentTarget.scaleX=1,e.currentTarget.scaleY=1)},t.onTouchReleaseOutSide=function(e){this.touchBeginTaret==e.target&&(this.touchBeginTaret&&egret.Tween.removeTweens(this.touchBeginTaret),this.touchBeginTaret=null,e.target.scaleX=1,e.target.scaleY=1)},t.longPress=function(){var e=this;for(var t in e.eventDic){var n=e.eventDic[t];n.target==this.touchBeginTaret&&n.longPressCallBack&&n.longPressCallBack.call(n.thisObject)}},t.setGlow=function(t,n){n?t.filters&&0!=t.filters.length||(t.filters=[e.FilterUtil.glowFilter]):t.filters=[]},t.setGrey=function(t,n,r){return void 0===r&&(r=!0),t instanceof eui.Button&&r?void(t.enabled=!n):void(n?(t.filters&&0!=t.filters.length||(t.filters=[e.FilterUtil.grayFilter]),r&&(t.touchEnabled=!1)):(t.filters=[],r&&(t.touchEnabled=!0)))},t.setBtnGray=function(e,n,r,o){void 0===r&&(r=!0),void 0===o&&(o=1),n?r?(e.currentState="disabled",e.touchEnabled=!1):e.skinName=t.getBtnSkin(o,n):(r?e.currentState="up":e.skinName=t.getBtnSkin(o,n),e.touchEnabled=!0)},t.getBtnSkin=function(t,n){var r="ButtonYellowSkin";switch(t){case e.BtnSkinType.Type_1:r=n?"ButtonYellowDisabledSkin":"ButtonYellowSkin";break;case e.BtnSkinType.Type_2:r=n?"ButtonYellowDisabledSkin1":"ButtonYellowSkin1"}return r},t.setGreyGoup=function(e,t){var n=this;e.forEach(function(e){n.setGrey(e,t)})},t.setDisable=function(e,t){this.setGrey(e,t),e.touchEnabled=!t},t.LoadResByNameAndWH=function(e,t,n,r,o,i){return void 0===o&&(o=50),void 0===i&&(i=50),e.width=n,e.height=r,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=t.width/100*o,e.y=t.height/100*i,e},t.updateStar=function(e,t){for(var n,r=e.numChildren,o=0;r>o;o++)n=e.getChildAt(o),t>o?n.imgStar.visible=!0:n.imgStar.visible=!1},t.getGlobelPoint=function(e){return e.parent?e.parent.localToGlobal(e.x,e.y):null},t}();e.DisplayUtils=t,__reflect(t.prototype,"qmr.DisplayUtils")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.grayFilter=new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0]),e.glowFilter=new egret.GlowFilter(16773632,.8,35,35,2,3,!1,!1),e}();e.FilterUtil=t,__reflect(t.prototype,"qmr.FilterUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.getHtmlString=function(e){if(e.indexOf("\\n")>-1){var n=e.split("\\n").join("\n");return t.htmlParse.parse(n)}return t.htmlParse.parse(e)},t.getHtmlTextElement=function(e,n,r,o,i,a){void 0===r&&(r=!1);var s="<font color="+n;return o&&(s+=" href=event:"+o),r&&(s+=" u='true'"),i&&(s+=" strokecolor="+i),a&&(s+=" stroke="+a),s+=">"+e+"</font>",t.getHtmlString(s)},t.getHtmlText=function(e,t,n,r){return void 0===n&&(n=!1),r&&n?"<font color="+t+" href=event:"+r+" u='true'>"+e+"</font>":r?"<font color="+t+" href=event:"+r+">"+e+"</font>":n?"<font color="+t+" u='true'>"+e+"</font>":"<font color="+t+">"+e+"</font>"},t.getColorSize=function(e,t,n){return n?"<font color="+t+" size="+n+">"+e+"</font>":"<font color="+t+">"+e+"</font>"},t.getHtmlTexts=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.getHtmlText(e[n][1],e[n][0],e[n][2],e[n][3]));return t.join("")},t.getItemHtmlText=function(e,t){var n="";return n},t.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r="args:";for(var o in t){if(!e.PlatformConfig.isDebug||!t)return;r+=t[o]+"\n"}return r},t.htmlParse=new egret.HtmlTextParser,t}();e.HtmlUtil=t,__reflect(t.prototype,"qmr.HtmlUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.setItemIcon=function(t,n,r,o){if(void 0===o&&(o=!1),n&&""!=n){t.source=null,1==o&&(n+="_g");var i=r==e.BagType.HERO?e.SystemPath.cardHeadIcon:e.SystemPath.itemIcon;e.ResManager.getRes(i+n+".png",function(e){t&&(t.source=e)},this,e.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE)}},t.setBmpIcon=function(t,n){e.ResManager.getRes(n,function(e){t&&(t.texture=e)},this,e.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE)},t.decoratePathForGray=function(e){var t=e.split(".png");return e=t[0]+"_g.png"},t.setImageIcon=function(t,n){""!=n&&null!=n&&null!=t&&t.source!=n&&(t.source=null,e.ResManager.getRes(n,function(e){t&&(t.source=e)},this,e.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE))},t.setFilter=function(e){for(var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(t),r=0;r<e.length;r++)e[r].filters=[n]},t.setTitleIcon=function(t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),e.ResManager.getRes(e.SystemPath.titlePath+n+".png",function(e){t&&(t.texture=e,r&&r.call(o))},this,e.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE)},t.setSkillIcon=function(t,n,r){if(void 0===r&&(r=!1),t){var o=".png";1==r&&(o="_g.png"),t.source=e.SystemPath.skillIcon+n+o}},t}();e.ImageUtil=t,__reflect(t.prototype,"qmr.ImageUtil")}(qmr||(qmr={}));var qmr;!function(e){function t(e){return null==e?0:"number"==typeof e?e:parseFloat(e.toString())}function n(e){var t=e%1e4;return t}function r(e,r){var o=t(e),i=n(o);return"S"+i+"."+r}var o=function(){function e(){}return e.getNumber=function(e){return null==e||""==e||isNaN(e)?0:"number"==typeof e?e:parseFloat(e.toString())},e.getNumberArr=function(t){var n=new Array;if(t)for(var r=void 0,o=0;o<t.length;o++)r=e.getNumber(t[o]),n.push(r);return n},e}();e.Int64Util=o,__reflect(o.prototype,"qmr.Int64Util"),e.getNumber=t,e.getServerNumber=n,e.getServerNickName=r}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getQueryString=function(){for(var e=location.search.match(new RegExp("[?&][^?&]+=[^?&]+","g")),t=0;t<e.length;t++)e[t]=e[t].substring(1);return e},e.getQueryStringByName=function(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]},e.getQueryStringByIndex=function(t){if(null==t)return"";var n=e.getQueryString();if(t>=n.length)return"";var r=n[t],o=r.indexOf("=")+1;return r=r.substring(o)},e.getValueFromParams=function(e,t){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");if(t){var r=t.match(n);if(r)return decodeURIComponent(r[2])}return null},e}();e.JsUtil=t,__reflect(t.prototype,"qmr.JsUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}();e.LabelTip=t,__reflect(t.prototype,"qmr.LabelTip")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.setLabelText=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.ConfigManagerBase.getCNValue(n);r&&r.length>0&&(r.unshift(i),i=e.StringUtils.getmsg.apply(e.StringUtils,r)),t.textFlow=e.HtmlUtil.htmlParse.parser(i)},t.setLabel=function(t,n,r){if(void 0===r&&(r=!1),n){n=e.StringUtils.getSectionMsg(n);var o=e.HtmlUtil.htmlParse.parser(n);if(r)for(var i=o.length,a=0;i>a;a++){var s=o[a];s.style?s.style.textColor=7891039:s.style={textColor:7891039}}t.textFlow=o}else t.text=""},t.setLabelCount=function(t,n,r,o){void 0===o&&(o=!1);var i=r>0?e.ColorQualityConst.COLOR_GREEN:e.ColorQualityConst.COLOR_RED,a="<font color='"+i+"'>"+r+"</font>";t.textFlow=e.HtmlUtil.htmlParse.parser(o?a+n:n+a)},t.setLabelCount2=function(t,n,r,o){void 0===o&&(o=!1);var i=r>0?e.ColorQualityConst.COLOR_RED:e.ColorQualityConst.COLOR_GREEN,a="<font color='"+i+"'>"+r+"</font>";t.textFlow=e.HtmlUtil.htmlParse.parser(o?a+n:n+a)},t.addLabelEvent=function(t,n,r,o){void 0===o&&(o="");for(var i=[],a=4;a<arguments.length;a++)i[a-4]=arguments[a];var s="";if(void 0==i||0==i.length){var l="<u>"+t.text+"</u>";i=[t.hashCode,l]}""==o&&(o="CN_119"),s=e.ConfigManagerBase.getCNValue(o),i&&i.length>0&&(i.unshift(s),s=e.StringUtils.getmsg.apply(e.StringUtils,i)),t.textFlow=e.HtmlUtil.htmlParse.parser(s),t.hasEventListener(egret.TextEvent.LINK)||n&&t.addEventListener(egret.TextEvent.LINK,n,r)},t.removeLabelEvent=function(e,t,n){e&&(e.name="",e.removeEventListener(egret.TextEvent.LINK,t,n))},t.addInputListener=function(e,n){e.addEventListener(egret.FocusEvent.FOCUS_IN,t.focusInTxtHandler,n),e.addEventListener(egret.FocusEvent.FOCUS_OUT,t.focusInTxtHandler,n)},t.removeInputListener=function(e,n){e.addEventListener(egret.FocusEvent.FOCUS_IN,t.focusInTxtHandler,n),e.addEventListener(egret.FocusEvent.FOCUS_OUT,t.focusInTxtHandler,n)},t.focusInTxtHandler=function(){var e=function(){document&&document.body&&setTimeout(function(){window.scrollTo&&window.scrollTo(0,document.body.clientHeight)},400)};e()},t}();e.LabelUtil=t,__reflect(t.prototype,"qmr.LabelUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this.nodeLen=0}return e.prototype.append=function(e){var t,r=new n(e);if(this._head){for(t=this._head;t.next;)t=t.next;t.next=r}else this._head=r;this.nodeLen+=1},e.prototype.indexOf=function(e){if(!this._head)return-1;for(var t=-1,n=this._head;n;){if(t+=1,n.current===e)return t;n=n.next}return-1},e.prototype.removeAt=function(e){if(this._head&&e>-1&&e<this.size){if(0==e)this._head=this._head.next;else{var t=this.getNodeAt(e),n=this.getNodeAt(e-1);t&&n&&(n.next=t.next)}this.nodeLen-=1}},e.prototype.getNodeAt=function(e){if(!this._head)return null;for(var t=this._head,n=-1;t;){if(n+=1,n===e)return t;t=t.next}return null},Object.defineProperty(e.prototype,"head",{get:function(){return this._head},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.nodeLen},enumerable:!0,configurable:!0}),e}();e.LinkedList=t,__reflect(t.prototype,"qmr.LinkedList");var n=function(){function e(e){this.current=e}return e}();e.LinkNode=n,__reflect(n.prototype,"qmr.LinkNode")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.log=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e.PlatformConfig.isDebug&&console.log.apply(console,[t].concat(n))},t.saveLogAndShowLog=function(e,n){t.reportLogData.logKey=n,egret.log(n)},t.logF=function(t){e.GlobalConfig.isDebugF&&egret.log(t)},t.warn=function(t){e.PlatformConfig.isDebug&&egret.warn(t)},t.error=function(t){e.PlatformConfig.isDebug&&egret.error(t)},t.slowLog=function(t){e.GlobalConfig.bIsShowSlowLog&&console.log(t)},t.errorLogUrl="v1/artisan/uploadlog",t.reportLogData={},t.reportLogUrl="http://testmt.housepig.cn/xyws/",t}();e.LogUtil=t,__reflect(t.prototype,"qmr.LogUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.manhattan=function(e,t,n,r){return 100*((e>n?e-n:n-e)+(t>r?t-r:r-t))},t.distance=function(e,t){return t&&e?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):0},t.getAngle=function(e,t){var n=t.x-e.x,r=t.y-e.y;return 180*Math.atan2(r,n)/Math.PI},t.equal=function(e,t){if(e&&t)if(e.high&&t.high){if(e.high==t.high&&e.low==t.low)return!0}else if(1e3*e/1e3==1e3*t/1e3)return!0;return!1},t.randomCount=function(e,t){return e+Math.round(Math.random()*(t-e))},t.dir=function(t,n){return n?Math.abs(n.y-t.y)<10?n.x>t.x?e.DirUtil.RIGHT:e.DirUtil.LEFT:n.y<t.y?Math.abs(n.x-t.x)<10?e.DirUtil.UP:n.x>t.x?e.DirUtil.RIGHT_UP:e.DirUtil.LEFT_UP:Math.abs(n.x-t.x)<10?e.DirUtil.DOWN:n.x>t.x?e.DirUtil.RIGHT_DOWN:e.DirUtil.LEFT_DOWN:1},t.getRodomPos=function(e){var t=[[1040,1122],[997,1283],[870,1033],[1124,969],[1216,1407]],n=[[1470,1260],[1394,1068],[1432,1241],[1537,1035],[1473,1308]],r=1==e?t:n,o=Math.round(Math.random()*(r.length-1));return{x:r[o][0],y:r[o][1]}},t.getGaussianPoint=function(e,t){var n=new egret.Point;return n.x=Math.random()*(e/2)+Math.random()*(e/2),n.y=Math.random()*(t/2)+Math.random()*(t/2),n},t}();e.MathUtil=t,__reflect(t.prototype,"qmr.MathUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){this.hexcase=0,this.b64pad=""}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),n)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var n=this.rstr2binl(e);n.length>16&&(n=this.binl_md5(n,8*e.length));for(var r=Array(16),o=Array(16),i=0;16>i;i++)r[i]=909522486^n[i],o[i]=1549556828^n[i];var a=this.binl_md5(r.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(o.concat(a),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var n,r=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",i=0;i<e.length;i++)n=e.charCodeAt(i),o+=r.charAt(n>>>4&15)+r.charAt(15&n);return o},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",o=e.length,i=0;o>i;i+=3)for(var a=e.charCodeAt(i)<<16|(o>i+1?e.charCodeAt(i+1)<<8:0)|(o>i+2?e.charCodeAt(i+2):0),s=0;4>s;s++)r+=8*i+6*s>8*e.length?this.b64pad:n.charAt(a>>>6*(3-s)&63);return r},e.prototype.rstr2any=function(e,t){var n,r,o,i,a,s=t.length,l=Array(Math.ceil(e.length/2));for(n=0;n<l.length;n++)l[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var c=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),u=Array(c);for(r=0;c>r;r++){for(a=Array(),i=0,n=0;n<l.length;n++)i=(i<<16)+l[n],o=Math.floor(i/s),i-=o*s,(a.length>0||o>0)&&(a[a.length]=o);u[r]=i,l=a}var f="";for(n=u.length-1;n>=0;n--)f+=t.charAt(u[n]);return f},e.prototype.str2rstr_utf8=function(e){for(var t,n,r="",o=-1;++o<e.length;)t=e.charCodeAt(o),n=o+1<e.length?e.charCodeAt(o+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),o++),127>=t?r+=String.fromCharCode(t):2047>=t?r+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?r+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(r+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return r},e.prototype.str2rstr_utf16le=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},e.prototype.binl2rstr=function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,a=0;a<e.length;a+=16){var s=n,l=r,c=o,u=i;n=this.md5_ff(n,r,o,i,e[a+0],7,-680876936),i=this.md5_ff(i,n,r,o,e[a+1],12,-389564586),o=this.md5_ff(o,i,n,r,e[a+2],17,606105819),r=this.md5_ff(r,o,i,n,e[a+3],22,-1044525330),n=this.md5_ff(n,r,o,i,e[a+4],7,-176418897),i=this.md5_ff(i,n,r,o,e[a+5],12,1200080426),o=this.md5_ff(o,i,n,r,e[a+6],17,-1473231341),r=this.md5_ff(r,o,i,n,e[a+7],22,-45705983),n=this.md5_ff(n,r,o,i,e[a+8],7,1770035416),i=this.md5_ff(i,n,r,o,e[a+9],12,-1958414417),o=this.md5_ff(o,i,n,r,e[a+10],17,-42063),r=this.md5_ff(r,o,i,n,e[a+11],22,-1990404162),n=this.md5_ff(n,r,o,i,e[a+12],7,1804603682),i=this.md5_ff(i,n,r,o,e[a+13],12,-40341101),o=this.md5_ff(o,i,n,r,e[a+14],17,-1502002290),r=this.md5_ff(r,o,i,n,e[a+15],22,1236535329),n=this.md5_gg(n,r,o,i,e[a+1],5,-165796510),i=this.md5_gg(i,n,r,o,e[a+6],9,-1069501632),o=this.md5_gg(o,i,n,r,e[a+11],14,643717713),r=this.md5_gg(r,o,i,n,e[a+0],20,-373897302),n=this.md5_gg(n,r,o,i,e[a+5],5,-701558691),i=this.md5_gg(i,n,r,o,e[a+10],9,38016083),o=this.md5_gg(o,i,n,r,e[a+15],14,-660478335),r=this.md5_gg(r,o,i,n,e[a+4],20,-405537848),n=this.md5_gg(n,r,o,i,e[a+9],5,568446438),i=this.md5_gg(i,n,r,o,e[a+14],9,-1019803690),o=this.md5_gg(o,i,n,r,e[a+3],14,-187363961),r=this.md5_gg(r,o,i,n,e[a+8],20,1163531501),n=this.md5_gg(n,r,o,i,e[a+13],5,-1444681467),i=this.md5_gg(i,n,r,o,e[a+2],9,-51403784),o=this.md5_gg(o,i,n,r,e[a+7],14,1735328473),r=this.md5_gg(r,o,i,n,e[a+12],20,-1926607734),n=this.md5_hh(n,r,o,i,e[a+5],4,-378558),i=this.md5_hh(i,n,r,o,e[a+8],11,-2022574463),o=this.md5_hh(o,i,n,r,e[a+11],16,1839030562),r=this.md5_hh(r,o,i,n,e[a+14],23,-35309556),n=this.md5_hh(n,r,o,i,e[a+1],4,-1530992060),i=this.md5_hh(i,n,r,o,e[a+4],11,1272893353),o=this.md5_hh(o,i,n,r,e[a+7],16,-155497632),r=this.md5_hh(r,o,i,n,e[a+10],23,-1094730640),n=this.md5_hh(n,r,o,i,e[a+13],4,681279174),i=this.md5_hh(i,n,r,o,e[a+0],11,-358537222),o=this.md5_hh(o,i,n,r,e[a+3],16,-722521979),r=this.md5_hh(r,o,i,n,e[a+6],23,76029189),n=this.md5_hh(n,r,o,i,e[a+9],4,-640364487),i=this.md5_hh(i,n,r,o,e[a+12],11,-421815835),o=this.md5_hh(o,i,n,r,e[a+15],16,530742520),r=this.md5_hh(r,o,i,n,e[a+2],23,-995338651),n=this.md5_ii(n,r,o,i,e[a+0],6,-198630844),i=this.md5_ii(i,n,r,o,e[a+7],10,1126891415),o=this.md5_ii(o,i,n,r,e[a+14],15,-1416354905),r=this.md5_ii(r,o,i,n,e[a+5],21,-57434055),n=this.md5_ii(n,r,o,i,e[a+12],6,1700485571),i=this.md5_ii(i,n,r,o,e[a+3],10,-1894986606),o=this.md5_ii(o,i,n,r,e[a+10],15,-1051523),r=this.md5_ii(r,o,i,n,e[a+1],21,-2054922799),n=this.md5_ii(n,r,o,i,e[a+8],6,1873313359),i=this.md5_ii(i,n,r,o,e[a+15],10,-30611744),o=this.md5_ii(o,i,n,r,e[a+6],15,-1560198380),r=this.md5_ii(r,o,i,n,e[a+13],21,1309151649),n=this.md5_ii(n,r,o,i,e[a+4],6,-145523070),i=this.md5_ii(i,n,r,o,e[a+11],10,-1120210379),o=this.md5_ii(o,i,n,r,e[a+2],15,718787259),r=this.md5_ii(r,o,i,n,e[a+9],21,-343485551),n=this.safe_add(n,s),r=this.safe_add(r,l),o=this.safe_add(o,c),i=this.safe_add(i,u)}return[n,r,o,i]},e.prototype.md5_cmn=function(e,t,n,r,o,i){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(r,i)),o),n)},e.prototype.md5_ff=function(e,t,n,r,o,i,a){return this.md5_cmn(t&n|~t&r,e,t,o,i,a)},e.prototype.md5_gg=function(e,t,n,r,o,i,a){return this.md5_cmn(t&r|n&~r,e,t,o,i,a)},e.prototype.md5_hh=function(e,t,n,r,o,i,a){return this.md5_cmn(t^n^r,e,t,o,i,a)},e.prototype.md5_ii=function(e,t,n,r,o,i,a){return this.md5_cmn(n^(t|~r),e,t,o,i,a)},e.prototype.safe_add=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();e.Md5Util=t,__reflect(t.prototype,"qmr.Md5Util")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getPoolBySign=function(t){return e._poolDic[t]||(e._poolDic[t]=[])},e.clearBySign=function(t){e._poolDic[t]&&(e._poolDic[t].length=0)},e._getClassSign=function(e){var t=e.name;return(""==t||void 0==t)&&(e.name=t=this.getGID()+""),t},e.getItemByClass=function(e,t){if(!this._poolDic[e])return new t;var n=this.getPoolBySign(e);if(n&&n.length){var r=n.pop();r[this.POOLSIGN]=!1}else r=new t;return r},e.recover=function(e,t){t&&(t[this.POOLSIGN]||(t[this.POOLSIGN]=!0,this.getPoolBySign(e).push(t)))},e.isInPool=function(e){return e&&e[this.POOLSIGN]?!0:!1},e.getItemByCreateFun=function(e,t,n){void 0===n&&(n=null);var r=this.getPoolBySign(e),o=r.length?r.pop():t.call(n);return o[this.POOLSIGN]=!1,o},e.getItem=function(e){var t=this.getPoolBySign(e),n=t.length?t.pop():null;return n&&(n[this.POOLSIGN]=!1),n},e.getGID=function(){return this._gid++},e.POOLSIGN="__InPool",e._poolDic={},e._gid=1,e}();e.Pool=t,__reflect(t.prototype,"qmr.Pool")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.getQualityUrl=function(t,n){void 0===n&&(n=e.ActorSizeType.small);var r;switch(n){case e.ActorSizeType.small:r="S";break;case e.ActorSizeType.mid:r="M";break;case e.ActorSizeType.big:r="L";break;default:r="S",console.error("怪物配置的sizeType不存在,id:",t)}return e.SystemPath.qualityPath+r+"/"+t+".png"},t.getQualityTypeUrl=function(t,n){void 0===n&&(n=e.ActorSizeType.small);var r;switch(n){case e.ActorSizeType.small:r="S";break;case e.ActorSizeType.mid:case e.ActorSizeType.big:r="M"}return e.SystemPath.qualityPath+r+"/"+t+".png"},t.getBgUrl=function(t){return e.SystemPath.bgPath+t+".png"},t.getHeroTypeUrl=function(t){return e.SystemPath.cardTypeIcon+t+".png"},t.getHeroCardUrl=function(t){return e.SystemPath.rolePath+"png/"+t+".png"},t.getMonsterCardUrl=function(t){return e.SystemPath.monsterPath+"png/"+t+".png"},t.getHeroHeadUrl=function(t){return e.SystemPath.cardHeadIcon+t+".png"},t.getEmbattleQualityUrl=function(t){return e.SystemPath.buzhenPath+"pz_"+t+".png"},t.getMapUrl=function(t){return e.SystemPath.mapPath+t+".jpg"},t.getHangMapUrl=function(t){return e.SystemPath.hangMapPath+t},t.getItemQualityUrl=function(t){return e.SystemPath.qualityPath+"itemQ"+t+".png"},t.getEquipPosImg=function(t){return e.SystemPath.equipPosPath+"equipPos"+t+".png"},t.getForgeEquipPosPath=function(t,n){void 0===n&&(n=!1);var r=n?"y"+t:t+"";return e.SystemPath.forgeEquipPosPath+"equipPos"+r+".png"},t.getItemIconUrl=function(t){return e.SystemPath.itemIcon+t+".png"},t.getBossHeadIconUrl=function(t){return e.SystemPath.bossHeadPath+"headIcon/"+t+".png"},t.getBossRenderBgUrl=function(e){return"ui_grbs_bg"+e+"_png"},t.getShopPromotionIconUrl=function(e){return"ui_shangcheng_"+e+"_png"},t.getShopPromotionIconUrl2=function(e){return"shop"+e+"_png"},t.getBossVipMenuImgUrl=function(e){return"ui_boss_"+e+"_png"},t.getGuildBossImgUrl=function(e){return"guild_"+e+"_png"},t.getWelfareBanner=function(t){return e.SystemPath.welfarePath+t+".png"},t.monthCardPathBanner=function(t,n){return e.SystemPath.monthCardPath+t+"."+n},t.getSkillIcon=function(t,n){return void 0===n&&(n=!1),1==n&&(t+="_g"),e.SystemPath.skillIcon+t+".png"},t.getMainCityImg=function(t){return e.SystemPath.mainCityPath+t+".png"},t.getDanIcon=function(t){return e.SystemPath.danIcon+"dan_"+t+".png"},t.getFaBaoIcon=function(t){return e.SystemPath.fabao+t+".png"},t.getBossBg=function(e){return e+"_png"},t.getRankIcon=function(e){return"rank"+e+"_png"},t.getActForecastIcon=function(t){return e.SystemPath.actForecastPath+t+".png"},t.getFunOpenIcon=function(t){return e.SystemPath.funOpenPath+t+".png"},t.getChoukaHeroNameImg=function(t){return e.SystemPath.icon_heroName+"name/ui_hero_name_"+t+".png"},t.getJibanHeroNameImg=function(t){return e.SystemPath.icon_heroName+"jibanSkillName/ui_hero_skill_"+t+".png"},t.getMonsterSoulLevelImg=function(t){return e.SystemPath.monsterSoulPath+"stage"+t+".png"},t.getGemIcon=function(t){return e.SystemPath.gemIconPath+t+".png"},t.festivalcelebrationBanner=function(e){return"festival_banner"+e+"_png"},t.getHeroPuzzleUrl=function(t,n){return e.SystemPath.heroPuzzlePath+t+"/p"+n+".png"},t.getXiangmoluShowIconUrl=function(t){return e.SystemPath.xiangmoluPath+t+".png"},t}();e.ResPathUtil=t,__reflect(t.prototype,"qmr.ResPathUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.CLOCK_INTERVAL=3,this._dailyAffairsTodo=[],this._dailyAffairsDone=[],this._dayAfterServerStartAffairsTodo=[],this._dayAppointTimeAffairsTodo=[],this._dayAppointTimeStampAffairsTodo=[],this._weekAffairsTodo=[],this._weekAffairsDone=[],this.oneDayMileSeconds=864e5,this.helperDate1=new Date,this.helperDate2=new Date,this.helpTimeArr=[],this.isClockStart=!1}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.startClock=function(){this.isClockStart=!0,e.Ticker.getInstance().registerTick(this.onTimer,this,1e3*this.CLOCK_INTERVAL)},t.prototype.onTimer=function(){this.isOverDay()&&(this.onOverDay(),e.NotifyManager.sendNotification(e.NotifyConstLogin.CROSS_DAY));var t,n,r=this._weekAffairsTodo,o=this._weekAffairsDone,i=this._dailyAffairsTodo,a=this._dailyAffairsDone,s=this._dayAfterServerStartAffairsTodo,l=this._dayAppointTimeAffairsTodo,c=this._dayAppointTimeStampAffairsTodo,u=i.length;for(n=u-1;n>=0;n--)t=i[n],this.isTimeIn(t.t)&&(t.c.run(),i.splice(n,1),a.push(t));var f=s.length;for(n=f-1;n>=0;n--){t=s[n];var p=new Date(e.TimeUtil.serverTime).getDate();p==t.r&&this.checkIsStartNow(t.ta[0],t.ta[1],t.d)&&(t.c.run(),s.splice(n,1))}var g=r.length;for(n=g-1;n>=0;n--)t=r[n],this.isTimeIn(t.t)&&(t.c.run(),r.splice(n,1),o.push(t));var d=l.length;for(n=d-1;n>=0;n--)t=l[n],this.checkAppointTimeIsTimeIn(t)&&(t.c.run(),l.splice(n,1));var h=c.length;for(n=h-1;n>=0;n--)t=c[n],this.checkAppointTimeStampIsTimeIn(t)&&(t.c.run(),c.splice(n,1))},t.prototype.checkAppointTimeIsTimeIn=function(t){var n=e.TimeUtil.getTimeStamp2(t.s.month,t.s.day,t.s.hour,t.s.minute),r=e.TimeUtil.getTimeStamp2(t.e.month,t.e.day,t.e.hour,t.e.minute);return e.TimeUtil.serverTime>=n&&e.TimeUtil.serverTime<=r},t.prototype.checkAppointTimeStampIsTimeIn=function(t){var n=t.s;return e.TimeUtil.serverTime>=n},t.prototype.isTimeIn=function(t){var n=e.TimeUtil.serverTime,r=this.getDailyTimeArrByTimeStamp(n,this.helpTimeArr),o=3600*r[0]+60*r[1]+r[2],i=3600*t[0]+60*t[1]+t[2];return o>=i},t.prototype.checkIsStartNow=function(t,n,r){var o=e.TimeUtil.changeServerTimeToSeconds(e.TimeUtil.serverTime),i=3600*t+60*n,a=i+r;return o>i&&a>o},t.prototype.onOverDay=function(){var e=this;this._dailyAffairsTodo=this._dailyAffairsDone.concat(),this._dailyAffairsDone=[],this._weekAffairsTodo=this._weekAffairsDone.concat(),this._weekAffairsDone=[];var t=[];this._weekAffairsTodo.forEach(function(e){t.push(e)}),this._weekAffairsTodo=[],t.forEach(function(t){e.registerWeekAlarmClock(t.w,t.tl,t.o,t.d,t.c,t.to)})},t.prototype.registerDailyAlarmClock=function(t,n,r){var o=this.getDailyTimeArrByTimeOffset(n,r);if(this.isExist(t,t.args,o))return void e.LogUtil.warn("请不要重复注册！ -- > registerDailyAlarmClock");var i={c:t,p:t.args,t:o};this.isTimeOut(o)?this._dailyAffairsDone.push(i):this._dailyAffairsTodo.push(i)},t.prototype.registerDailyAlarmClock2=function(t,n,r,o){void 0===o&&(o=0);var i=n[0],a=n[1],s=this.getDailyTimeArrByTimeOffset(e.TimeUtil.timeToMilSeconds(i,a,0),o);if(this.isExist(t,t.args,s))return void e.LogUtil.warn("请不要重复注册！ -- > registerDailyAlarmClock");var l={c:t,p:t.args,t:s};this.checkIsStartNow(i,a,r)&&l.c.run(),this.isTimeOut(s)?this._dailyAffairsDone.push(l):this._dailyAffairsTodo.push(l)},t.prototype.registerWeekAlarmClock=function(t,n,r,o,i,a){for(var s=this,l=this.getCurDay(),c=0,u=t.length;u>c;){if(l==t[c]){var f=n[0],p=n[1],g=s.getDailyTimeArrByTimeOffset(e.TimeUtil.timeToMilSeconds(f,p,0),a),d={c:i,p:i.args,t:g,o:r,d:o,tl:n,w:t,to:a};s.checkIsStartNow(f,p,o)&&d.c.run(),s.isTimeOut(g)?s._weekAffairsDone.push(d):s._weekAffairsTodo.push(d);break}c++}},t.prototype.registerDayAfterServerStartAlarmClock=function(e,t,n,r,o,i){var a=t+(r-1)*this.oneDayMileSeconds,s=new Date(a),l=s.getDate(),c=this.getDailyTimeArrByTimeOffset(o,i),u={c:e,p:e.args,s:t,d:n,r:l,a:o,t:i,ta:c};this._dayAfterServerStartAffairsTodo.push(u)},t.prototype.registerAppointTimeAlarmClock=function(t,n,r){var o=e.TimeUtil.getTimeStamp2(r.month,r.day,r.hour,r.minute);if(e.TimeUtil.serverTime>o)return void e.LogUtil.warn("注册时间已过了,不需要再注册了 -- > registerAppointTimeAlarmClock");var i={c:t,p:t.args,s:n,e:r};this._dayAppointTimeAffairsTodo.push(i)},t.prototype.registerAppointTimeStampAlarmClock=function(t,n){if(e.TimeUtil.serverTime>n)return void e.LogUtil.warn("注册时间已过了,不需要再注册了 -- > registerAppointTimeAlarmClock");var r={c:t,p:t.args,s:n};this._dayAppointTimeStampAffairsTodo.push(r)},t.prototype.unRegisterAppointTimeStampAlarmClock=function(e){for(var t=this._dayAppointTimeStampAffairsTodo,n=t.length,r=n-1;r>=0;r--)t[r].c==e&&t.splice(r,1)},t.prototype.isExistDayAfterServerStart=function(e,t,n,r){for(var o=0,i=this._dayAfterServerStartAffairsTodo;o<i.length;o++){var a=i[o];if(a.s==e&&a.r==t&&a.a==n&&a.t==r)return!0}return!1},t.prototype.isExist=function(e,t,n){for(var r,o=this,i=o._dailyAffairsTodo,a=o._dailyAffairsDone,s=i.length,l=0;s>l;l++)if(r=i[l],r.c==e&&o.equalArray(r.p,t)&&o.equalArray(r.t,n))return!0;s=a.length;for(var c=0;s>c;c++)if(r=a[c],r.c==e&&o.equalArray(r.p,t)&&o.equalArray(r.t,n))return!0;return!1},t.prototype.equalArray=function(e,t){if(e==t)return!0;if(null==e)return!1;if(null==t)return!1;if(e.length!=t.length)return!1;for(var n=e.length,r=!0,o=0;n>o;o++)if(e[o]!=t[o]){r=!1;break}return r},t.prototype.getDailyTimeArrByTimeOffset=function(t,n,r){void 0===r&&(r=null);var o=new Date(e.TimeUtil.serverTime),i=3600*o.getHours(),a=60*o.getMinutes(),s=o.getSeconds(),l=o.getMilliseconds(),c=1e3*(i+a+s),u=e.TimeUtil.serverTime-c+l+t,f=this.getDailyTimeArrByTimeStamp(u,r),p=this.getDailyTimeArrByTimeStamp(u+n,r);return n>0?f.concat(p):p.concat(f)},t.prototype.getDailyTimeArrByTimeStamp=function(e,t){var n=this.helperDate1;return n.setTime(e),null==t&&(t=[]),t[0]=n.getHours(),t[1]=n.getMinutes(),t[2]=n.getSeconds(),t},t.prototype.isTimeOut=function(t){var n=e.TimeUtil.serverTime,r=this.getDailyTimeArrByTimeStamp(n,this.helpTimeArr),o=3600*r[0]+60*r[1]+r[2],i=3600*t[3]+60*t[4]+t[5];return o>=i},t.prototype.isOverDay=function(){var t=this,n=e.TimeUtil.serverTime;return t.helperDate1.setTime(n),t.helperDate2.setTime(n-1e3*t.CLOCK_INTERVAL),t.helperDate2.getDate()!=t.helperDate1.getDate()},t.prototype.getCurDay=function(){this.helperDate1.setTime(e.TimeUtil.serverTime);var t=this.helperDate1.getDay();return 0==t&&(t=7),t},t}();e.ServerClock=t,__reflect(t.prototype,"qmr.ServerClock")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){this.sVariantType=0;var t=egret.localStorage.getItem(e.PlatformConfig.channelId+"zgmrsetting"+e.GlobalConfig.userId);t&&"undefined"!=t&&(this.sVariantType=parseInt(t))}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.getForbidState=function(t){return e.BitUtil.checkAvalibe(this.sVariantType,t)
},t.prototype.setForbidState=function(t,n){this.sVariantType=e.BitUtil.changeBit(this.sVariantType,t,n),egret.localStorage.setItem(e.PlatformConfig.channelId+"zgmrsetting"+e.GlobalConfig.userId,this.sVariantType+"")},t}();e.SettingUtil=t,__reflect(t.prototype,"qmr.SettingUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"stageWidth",{get:function(){return t.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"stageHeight",{get:function(){return t.stage.stageHeight},enumerable:!0,configurable:!0}),t.setStageFrameRate=function(e){t.stage.frameRate=e},t.getStageFrameRate=function(){return t.stage.frameRate},t.init=function(e){t.stage=e;var n=t;n.maxStageWidth=Math.floor(n.DESIGN_HEIGHT/n.MIN_HW_RATIO),n.maxStageHeight=Math.floor(n.DESIGN_WIDTH*n.MAX_HW_RATIO),n.setStageFrameRate(n.FRAME_RATE),n.changeStageSize(),window.addEventListener("resize",n.changeStageSize)},t.changeStageSize=function(){var n=t,r=function(){var r="",o=0,i=0,a=window.innerHeight/window.innerWidth;a>=n.MAX_HW_RATIO?(r=egret.StageScaleMode.SHOW_ALL,o=n.DESIGN_WIDTH,i=n.maxStageHeight):a>=n.STANDARD_RATIO?(r=egret.StageScaleMode.FIXED_WIDTH,o=n.DESIGN_WIDTH,i=n.DESIGN_HEIGHT):a>n.MIN_HW_RATIO?(r=egret.StageScaleMode.FIXED_HEIGHT,o=n.DESIGN_WIDTH,i=n.DESIGN_HEIGHT):(r=egret.StageScaleMode.SHOW_ALL,o=n.maxStageWidth,i=n.DESIGN_HEIGHT),n.stage.scaleMode=r,n.stage.setContentSize(o,i),e.NotifyManager.sendNotification(t.STAGE_RESIZE)};r(),"IOS"==egret.Capabilities.os.toUpperCase()&&egret.setTimeout(r,this,100)},t.stageEnable=function(e){this.stage&&(this.stage.touchChildren=e)},t.isPC=function(){for(var e=navigator.userAgent.toString(),t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,r=0;r<t.length;r++)if(e.indexOf(t[r])>0){n=!1;break}return n},t.FRAME_RATE=60,t.STAGE_RESIZE="stage_resize",t.STAGE_ACTIVE="stage_active",t.STAGE_DEACTIVATE="stage_deactivate",t.DESIGN_WIDTH=750,t.DESIGN_HEIGHT=1334,t.STANDARD_RATIO=1.78,t.MAX_HW_RATIO=2.16,t.MIN_HW_RATIO=1.333,t.maxStageWidth=0,t.maxStageHeight=0,t}();e.StageUtil=t,__reflect(t.prototype,"qmr.StageUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return t.getmsg=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();for(var r in e){var o=e[r];n=n.replace(/\{\d+\}/,o)}return n},t.getmsg2=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];e=e.replace(/\{\d+\}/,r)}return e},t.getCharLength=function(e){for(var t=0,n=e.length,r=-1,o=0;n>o;o++)r=e.charCodeAt(o),t+=r>=0&&128>=r?1:2;return t},t.getChineseNumber=function(e,n){void 0===n&&(n=!1);var r="";if(0==e)return n?"零":r;var o=e+"";if(e>100){r+=t.getChineseNumber(parseInt(o.charAt(0))),r+="百";var i=parseInt(o.charAt(1));return i>0?(r+=t.getChineseNumber(i),r+="十"):r+="零",r+=t.getChineseNumber(parseInt(o.charAt(2)))}if(100==e)return r+=t.getChineseNumber(parseInt(o.charAt(0))),r+="百";if(e>19)return r+=t.getChineseNumber(parseInt(o.charAt(0))),r+="十",r+=t.getChineseNumber(parseInt(o.charAt(1)));if(e>10)return r+="十",r+=t.getChineseNumber(parseInt(o.charAt(1)));switch(e){case 1:r="一";break;case 2:r="二";break;case 3:r="三";break;case 4:r="四";break;case 5:r="五";break;case 6:r="六";break;case 7:r="七";break;case 8:r="八";break;case 9:r="九";break;case 10:r="十"}return r},t.getStepStr=function(e){return t.getLevelStr(e)+"j"},t.getFightToWanStr=function(e){return e/=1e4,e=Math.floor(100*e)/100,e.toString()},t.getLevelStr=function(e){var t;return t=""+e,0==e?t="z":10==e?t="0":e>10&&20>e?t="0"+(e-10):e>20&&e%10!=0&&(t=t.slice(0,1)+"0"+t.slice(1)),t},t.getRedOrGreenNum=function(t,n){var r=n?e.ColorQualityConst.COLOR_RED:e.ColorQualityConst.COLOR_GREEN,o=e.HtmlUtil.getHtmlTexts([[r,""+t]]);return o},t.getSectionMsg=function(e){return e.replace(/\\n/g,"\n")},t.padLeft=function(e,t){if("number"==typeof t)return Array(t+1).join(" ")+e;if("string"==typeof t)return t+e;throw new Error("Expected string or number, got '"+t+"'.")},t.copyClipBoard=function(t){if(e.PlatformConfig.platformId==e.PlatformEnum.P_WX)window.wx.setClipboardData({data:t,success:function(e){window.wx.getClipboardData({success:function(e){}})}});else if(e.PlatformConfig.platformId==e.PlatformEnum.P_XIYOU_SQQ)window.qq.setClipboardData({data:t,success:function(t){window.qq.getClipboardData({success:function(t){e.TipManagerCommon.getInstance().createCommonColorTip("复制成功！",!0)}})}});else if(e.PlatformConfig.platformId==e.PlatformEnum.P_OPPO)window.qg.setClipboardData({data:t,success:function(t){e.TipManagerCommon.getInstance().createCommonColorTip("复制成功！",!0)}});else{var n=document.createElement("input");n.value=t,document.body.appendChild(n),n.select(),n.setSelectionRange(0,n.value.length),document.execCommand("Copy"),document.body.removeChild(n),e.TipManagerCommon.getInstance().createCommonColorTip("复制成功！",!0)}},t}();e.StringUtils=t,__reflect(t.prototype,"qmr.StringUtils")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getmsg=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();for(var r in e){var o=e[r];n=n.replace(/\{\d+\}/,o)}return n},e}();e.StringUtilsBase=t,__reflect(t.prototype,"qmr.StringUtilsBase")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"mapPath",{get:function(){return e.PlatformConfig.webRoot+"map/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"hangMapPath",{get:function(){return e.PlatformConfig.webRoot+"hangMap/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"effectPath",{get:function(){return e.PlatformConfig.webRoot+"animation/effect/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"minePath",{get:function(){return e.PlatformConfig.webRoot+"animation/xianmai/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"uieffect",{get:function(){return e.PlatformConfig.webRoot+"animation/uieffect/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fabao",{get:function(){return e.PlatformConfig.webRoot+"animation/fabao/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"monsterPath",{get:function(){return e.PlatformConfig.webRoot+"animation/monster/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"rolePath",{get:function(){return e.PlatformConfig.webRoot+"animation/role/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultPath",{get:function(){return e.PlatformConfig.useCdnRes?e.PlatformConfig.webUrl+"resourceLogin/animation/":"resourceLogin/animation/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"roleUiPath",{get:function(){return e.PlatformConfig.webRoot+"animation/role/UI/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"horsePath",{get:function(){return e.PlatformConfig.webRoot+"animation/horse/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"wingPath",{get:function(){return e.PlatformConfig.webRoot+"animation/wing/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShugoPath",{get:function(){return e.PlatformConfig.webRoot+"animation/bow/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GuangHuanPath",{get:function(){return e.PlatformConfig.webRoot+"animation/guanghuan/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"tortoisePath",{get:function(){return e.PlatformConfig.webRoot+"animation/tortoise/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"weaponPath",{get:function(){return e.PlatformConfig.webRoot+"animation/weapon/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bigSkillPath",{get:function(){return e.PlatformConfig.webRoot+"animation/ultimateSkill/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"itemIcon",{get:function(){return e.PlatformConfig.webRoot+"icon/item/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"warriorIcon",{get:function(){return e.PlatformConfig.webRoot+"icon/warrior/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"qualityPath",{get:function(){return e.PlatformConfig.webRoot+"icon/quality/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"cardTypeIcon",{get:function(){return e.PlatformConfig.webRoot+"icon/hero/type/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"cardHeadIcon",{get:function(){return e.PlatformConfig.webRoot+"icon/hero/head/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"buff_icon",{get:function(){return e.PlatformConfig.webRoot+"icon/buff/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skillIcon",{get:function(){return e.PlatformConfig.webRoot+"icon/skill/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"danIcon",{get:function(){return e.PlatformConfig.webRoot+"icon/duanwei/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"jinjie_level_icon",{get:function(){return e.PlatformConfig.webRoot+"icon/jinjielevel/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"buzhenPath",{get:function(){return e.PlatformConfig.webRoot+"icon/quality/buzhen/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"equipPosPath",{get:function(){return e.PlatformConfig.webRoot+"icon/equipPos/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"forgeEquipPosPath",{get:function(){return e.PlatformConfig.webRoot+"icon/forgeEquipPos/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bossHeadPath",{get:function(){return e.PlatformConfig.webRoot+"icon/boss/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"actForecastPath",{get:function(){return e.PlatformConfig.webRoot+"icon/actForecast/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"funOpenPath",{get:function(){return e.PlatformConfig.webRoot+"icon/funOpen/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"rankPath",{get:function(){return e.PlatformConfig.webRoot+"icon/rank/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gemIconPath",{get:function(){return e.PlatformConfig.webRoot+"icon/gemIcon/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"monsterSoulPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/monsterSoul/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bg_music",{get:function(){return e.PlatformConfig.webRoot+"sound/music/"},enumerable:!0,configurable:!0}),t.getEffect_musicUrl=function(t){var n=e.PlatformConfig.webRoot+"sound/effect/";return("dianji"==t||"tanchu"==t)&&(n=e.PlatformConfig.useCdnRes?e.PlatformConfig.webUrl+"resourceLogin/sound/":"resourceLogin/sound/"),n+t+".mp3"},Object.defineProperty(t,"titlePath",{get:function(){return e.PlatformConfig.webRoot+"animation/title/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"icon_heroName",{get:function(){return e.PlatformConfig.webRoot+"icon/hero/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"heroPuzzlePath",{get:function(){return e.PlatformConfig.webRoot+"icon/heroPuzzle/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"xiangmoluPath",{get:function(){return e.PlatformConfig.webRoot+"icon/xiagnmolu/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"actHallPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/actHall/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bossPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/boss/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"unpack_battle",{get:function(){return e.PlatformConfig.webRoot+"unpack/battle/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shopPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/shop/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"welfarePath",{get:function(){return e.PlatformConfig.webRoot+"unpack/welfare/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mainCityPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/mainCity/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"monthCardPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/monthCard/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bgPath",{get:function(){return e.PlatformConfig.webRoot+"unpack/bg/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"textureMergerPath",{get:function(){return e.PlatformConfig.webRoot+"textureMerger/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"icon_headBg",{get:function(){return e.PlatformConfig.webRoot+"icon/headBg/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"icon_chatBg",{get:function(){return e.PlatformConfig.webRoot+"icon/chatBubble/"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"config",{get:function(){return e.PlatformConfig.webRoot+"config/"},enumerable:!0,configurable:!0}),t}();e.SystemPath=t,__reflect(t.prototype,"qmr.SystemPath")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.strlen=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r>=1&&126>=r||r>=65376&&65439>=r?t++:t+=2}return t},e.prototype.fixTextBox=function(e,t){if(t.textWidth>e){var n=e/t.textWidth;return t.width=Math.ceil(t.textWidth),t.scaleX=n,!0}return!1},e}();e.TextFixWidthUtil=t,__reflect(t.prototype,"qmr.TextFixWidthUtil")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function t(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),this.label=e,this.des=t,this.thisObj=n}return t.prototype.setDes=function(e){this.des=e},t.prototype.startTick=function(t,n){void 0===n&&(n=1e3),this.runing=!0,this.count=t,e.Ticker.getInstance().registerTick(this.tick,this,n),this.showMsg()},t.prototype.tick=function(){return this.count--<1?(this.stopTick(),void(this.backFun&&this.backFun.call(this.thisObj))):(this.updateFun&&this.updateFun.call(this.thisObj),void this.showMsg())},t.prototype.showMsg=function(){this.label&&this.des&&(this.label.text=e.CommonTool.getMsg(this.des,this.count)),this.btn&&this.des&&(this.btn.label=e.CommonTool.getMsg(this.des,this.count))},t.prototype.stopTick=function(){this.runing&&(this.runing=!1,e.Ticker.getInstance().unRegisterTick(this.tick,this))},t}();e.TickTool=t,__reflect(t.prototype,"qmr.TickTool")}(qmr||(qmr={}));var qmr;!function(e){var t=function(){function e(){}return e.getServerSecond=function(){return Math.floor((egret.getTimer()+this.tickOffset)/1e3)},Object.defineProperty(e,"serverTime",{get:function(){return egret.getTimer()+this.tickOffset},enumerable:!0,configurable:!0}),e.getSeverDate=function(){return new Date(1e3*this.getServerSecond())},e.getZoneOffsetSeverDate=function(){return new Date(1e3*this.getZoneOffsetSeverSecond())},e.getZoneOffsetSeverSecond=function(){return this.getServerSecond()},e.syncServerTime=function(e){this.tickOffset=e-egret.getTimer()},e.getTimeBySecond=function(e){var t="";return e>=60&&(t=this.dateStringFillZero(Math.floor(e/60))+":"),t+=this.dateStringFillZero(Math.floor(e%60))},e.getDateByTimer=function(t){e.date||(e.date=new Date),e.date.setTime(t);var n=e.date.getFullYear(),r=e.date.getMonth()+1,o=e.date.getDate(),i=e.date.getHours(),a=e.date.getMinutes(),s=e.date.getSeconds(),l=(10>r?"0"+r:r.toString(),10>o?"0"+o:o.toString(),10>i?"0"+i:i.toString()),c=10>a?"0"+a:a.toString(),u=10>s?"0"+s:s.toString();return n+"-"+r+"-"+o+" "+l+":"+c+":"+u},e.getDateByTimerSecond=function(t){return e.getDateByTimer(1e3*t)},e.getDayOverTime=function(){var e=this.getSeverDate(),t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);return(t.getTime()-e.getTime())/1e3},e.getDayTime=function(){var e=this.getSeverDate(),t=new Date(e.getFullYear(),e.getMonth(),e.getDate());return(e.getTime()-t.getTime())/1e3},e.getTimeToNow=function(e){var t=new Date(e),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());return(t.getTime()-n.getTime())/1e3},e.formatDate=function(e){var t=e.getHours(),n=e.getMinutes(),r=e.getMilliseconds(),o=10>t?"0"+t:t.toString(),i=10>n?"0"+n:n.toString(),a=10>r?"0"+r:r.toString();return o+":"+i+":"+a},e.formatTime=function(e){var t=Math.floor(e/60/60)%24,n=Math.floor(e/60)%60,r=Math.floor(e%60),o=10>t?"0"+t:t.toString(),i=10>n?"0"+n:n.toString(),a=10>r?"0"+r:r.toString();return o+":"+i+":"+a},e.formatTime1=function(e){var t=Math.floor(e/60/60),n=Math.floor(e/60)%60,r=Math.floor(e%60),o=10>t?"0"+t:t.toString(),i=10>n?"0"+n:n.toString(),a=10>r?"0"+r:r.toString();return o+":"+i+":"+a},e.formatTime4=function(e){var t=Math.floor(e/60/60)%24,n=Math.floor(e/60)%60,r=10>t?""+t:t.toString(),o=10>n?""+n:n.toString();return r+this.CN_HOUR+o+this.CN_MIN},e.formatTime5=function(e){var t=Math.floor(e/60/60)%24,n=Math.floor(e/60)%60,r=Math.floor(e%60),o=10>t?"0"+t:t.toString(),i=10>n?"0"+n:n.toString(),a=10>r?"0"+r:r.toString();return t>0?o+this.CN_HOUR+i+this.CN_MIN+a+this.CN_SEC:i+this.CN_MIN+" "+a+this.CN_SEC},e.formatTime2=function(e){var t=Math.floor(e/60)%60,n=Math.floor(e%60),r=10>t?"0"+t:t.toString(),o=10>n?"0"+n:n.toString();return r+":"+o},e.formatTime3=function(e){var t=Math.floor(e/60/60/24),n=Math.floor(e/60/60)%24+24*t,r=Math.floor(e/60)%60,o=Math.floor(e%60),i=10>n?"0"+n:n.toString(),a=10>r?"0"+r:r.toString(),s=10>o?"0"+o:o.toString();return i+":"+a+":"+s},e.formatTime6=function(e){var t=Math.floor(e/60)%60,n=Math.floor(e%60),r=10>t?"0"+t:t.toString(),o=10>n?"0"+n:n.toString();return r+"分"+o+"秒"},e.formatTime7=function(e){var t=new Date(e),n=t.getMinutes(),r=t.getHours(),o=10>r?"0"+r:r.toString(),i=10>n?"0"+n:n.toString();return o+":"+i},e.formatColumnDate=function(e){var t=(e.getMonth()+1<10?"0":"")+(e.getMonth()+1),n=(e.getDate()<10?"0":"")+e.getDate(),r="";return r+=t+"-"+n+" ",r+=(e.getHours()<10?"0":"")+e.getHours(),r+=":",r+=(e.getMinutes()<10?"0":"")+e.getMinutes()},e.formatDate1=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1<10?"0":"")+(e.getMonth()+1),r=(e.getDate()<10?"0":"")+e.getDate(),o=e.getHours()<10?"0"+e.getHours():e.getHours().toString(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes().toString();return t+"/"+n+"/"+r+" "+o+":"+i},e.formatYMD=function(e){var t=e.getFullYear()+this.CN_YEAR+(e.getMonth()+1)+this.CN_MONTH+e.getDate()+this.CN_SUN;return t},e.formatYMDForEn=function(e){var t=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear();return t},e.formatYMD1=function(e){var t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+"/";return t},e.formatRemain=function(e){var t=Math.floor(e/60/60/24),n=Math.floor(e/60/60)%24,r=Math.floor(e/60)%60,o=Math.floor(e%60);return t+this.CN_DAY+" "+n+this.CN_HOUR+" "+r+this.CN_MIN+" "+o+this.CN_SEC},e.formatRemain1=function(e){var t=Math.floor(e/60/60/24),n=Math.floor(e/60/60)%24,r=Math.floor(e/60)%60;return t+this.CN_DAY+n+this.CN_HOUR+r+this.CN_MIN},e.formatRemain3=function(e){var t=Math.floor(e/60/60)%24,n=Math.floor(e/60)%60;return t+" "+this.CN_HOUR+" "+n+" "+this.CN_MIN},e.formatRemain2=function(e){var t=Math.floor(e/60/60/24),n=Math.floor(e/60/60)%24,r=Math.floor(e/60)%60;Math.floor(e%60);return[t,n,r]},e.formatRemain4=function(t){var n="",r=e.getZeroize,o=Math.floor(t/60/60/24);0!=o&&(n+=r(o)+this.CN_DAY);var i=Math.floor(t/60/60)%24;0!=i&&(n+=r(i)+this.CN_HOUR);var a=Math.floor(t/60)%60;0!=a&&(n+=r(a)+this.CN_MIN);var s=Math.floor(t%60);return 0!=s&&(n+=r(s)+this.CN_SEC),n},e.formatRemain5=function(e){var t=Math.floor(e/60/60/24);if(0!=t)return t+"d";var n=Math.floor(e/60/60)%24;if(0!=n)return n+"h";var r=Math.floor(e/60)%60;if(0!=r)return r+"m";var o=Math.floor(e%60);return 0!=o?o+"s":""},e.formatRemain6=function(t){var n="",r=e.getZeroize,o=Math.floor(t/60/60/24);0!=o&&(n+=o+this.CN_DAY+" ");var i=Math.floor(t/60/60)%24;n+=0!=i?r(i)+":":"00:";var a=Math.floor(t/60)%60;n+=0!=a?r(a)+":":"00:";var s=Math.floor(t%60);return n+=0!=s?r(s):"00"},e.formatRemain7=function(t){var n="",r=e.getZeroize,o=Math.floor(t/60/60/24);0!=o&&(n+=o+this.CN_DAY+" ");var i=Math.floor(t/60/60)%24;0!=i&&(n+=r(i)+":");var a=Math.floor(t/60)%60;n+=0!=a?r(a)+":":"00:";var s=Math.floor(t%60);return n+=0!=s?r(s):"00"},e.formatRemain8=function(t){var n="",r=(e.getZeroize,Math.floor(t/60/60/24));0!=r&&(n+=r+this.CN_DAY);var o=Math.floor(t/60/60)%24;0!=o&&(n+=o+this.CN_HOUR);var i=Math.floor(t/60)%60;0!=i&&(n+=i+this.CN_MIN+"钟");var a=Math.floor(t%60);return 0!=a&&(n+=a+this.CN_SEC),n},e.formatRemainForEn=function(e){var t=Math.floor(e/60/60/24),n=Math.floor(e/60/60)%24,r=24*t+n,o=Math.floor(e/60)%60,i=Math.floor(e%60),a=10>r?"0"+r:r.toString(),s=10>o?"0"+o:o.toString(),l=10>i?"0"+i:i.toString();return a+":"+s+":"+l},e.getTimeDifference=function(e,t){var n=[0,0,0,0],r=t-e;return n[0]=Math.floor(r/864e5),n[1]=Math.floor(r%864e5/36e5),n[2]=Math.floor(r%864e5%36e5/6e4),n[3]=Math.floor(r%864e5%36e5%6e4/1e3),n},e.prototype.timeStrToDate=function(e){var t=e.split(" "),n=t[0].split("-"),r=t[1].split("-"),o=new Date(n[0],n[1],n[2],r[0],r[1],r[2]);return o},e.dateStringFillZero=function(e){return(e>=10?(.1*e>>0).toString():"0")+(e%10).toString()},e.gettodayTimeByHour=function(e){var t=this.getZoneOffsetSeverDate();return t.setHours(e),t.setMinutes(0),t.setSeconds(0),t.getTime()/1e3},e.changeServerTimeToSeconds=function(e){var t=new Date(e),n=3600*t.getHours()+60*t.getMinutes()+t.getSeconds();return n},e.timeToMilSeconds=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);var r=1e3*(3600*e+60*t+n);return r},e.getTimeStamp2=function(t,n,r,o,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0);var a=new Date(e.serverTime);return a.setMonth(t-1),a.setDate(n),a.setHours(r),a.setMinutes(o),a.setSeconds(i),a.setMilliseconds(0),a.getTime()},e.getTimeStamp3=function(e,t,n,r,o,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0);var a=new Date;return a.setFullYear(e),a.setMonth(t-1),a.setDate(n),a.setHours(r),a.setMinutes(o),a.setSeconds(i),a.setMilliseconds(0),a.getTime()},e.getCurDay=function(){var t=new Date(e.serverTime),n=t.getDay();return 0==n&&(n=7),n},e.getTimeStamp=function(t,n){var r=new Date(e.serverTime);return r.setHours(t),r.setMinutes(n),r.setSeconds(0),r.setMilliseconds(0),r.getTime()},e.getDayTimeStamp=function(t){var n=e.serverTime+24*t*60*60*1e3;return n},e.getTimeStampByTime=function(e,t,n){var r=new Date(e);return r.setHours(t),r.setMinutes(n),r.setSeconds(0),r.setMilliseconds(0),r.getTime()},e.getBetweenDays=function(e,t){return this.getTotalDaysByTime(e)-this.getTotalDaysByTime(t)},e.getTotalDays=function(e){var t=-8;return Math.floor(e.getTime()-60*t*60*1e3)/864e5},e.getTotalDaysByTime=function(e){var t=-8;return Math.floor((e-60*t*60*1e3)/864e5)},e.getTimeNoHourSecond=function(e){var t=new Date(e),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.getTime()},e.getZeroize=function(e){return 10>e?"0"+e:e+""},e.getTodayStartTime=function(){return e.getTimeNoHourSecond(e.serverTime)},e.getTimesplit=function(e){var t={},n=e.split(" "),r=n[0],o=n[1],i=r.split("-");t.year=parseInt(i[0]),t.month=parseInt(i[1]),t.day=parseInt(i[2]);var a=o.split(":");return t.hour=parseInt(a[0]),t.minute=parseInt(a[1]),t.second=parseInt(a[2]),t},e.fun10=function(){var e=new Date;return e.getTime()-60*e.getHours()*60*1e3-60*e.getMinutes()*1e3-1e3*e.getSeconds()-e.getMilliseconds()},e.getWeekByTime=function(e,t,n){(1==t||2==t)&&(t+=12,--e);var r=(n+2*t+Math.floor(3*(t+1)/5)+e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+1)%7;return r},e.getWeekByTimeStr=function(t,n,r){var o=e.getWeekByTime(t,n,r),i="";switch(o){case 1:i="星期一";break;case 2:i="星期二";break;case 3:i="星期三";break;case 4:i="星期四";break;case 5:i="星期五";break;case 6:i="星期六";break;case 0:i="星期日"}return i},e.DAY_MICRO_SECONDS=864e5,e.HOUR_MICRO_SECONDS=36e5,e.MINUTE_MICRO_SECONDS=6e4,e.SECOND_MICRO_SECONDS=1e3,e.CN_YEAR="年",e.CN_MONTH="月",e.CN_SUN="日",e.CN_DAY="天",e.CN_HOUR="小时",e.CN_MIN="分",e.CN_SEC="秒",e.tickOffset=0,e}();e.TimeUtil=t,__reflect(t.prototype,"qmr.TimeUtil")}(qmr||(qmr={}));var TimeUtil=qmr.TimeUtil,qmr;!function(e){var t=function(){function e(){}return e.initSysInfo=function(){this.initMd()},e.initMd=function(){console.log("运行系统:"+egret.Capabilities.os);var e=window.MobileDetect;if(e){var t=navigator.userAgent,n=new e(t),r=n.os(),o="";if("iOS"==r)o=n.mobile();else if("AndroidOS"==r){var i=t.split(";"),a=this.contains(i,"Build/");o=a>-1?i[a].substring(0,i[a].indexOf("Build/")):n.mobile()}this.model=o,this.OS=r,egret.log("md:"+JSON.stringify(n)),egret.log("操作系统:"+r),egret.log("手机型号:"+o)}},e.contains=function(e,t){for(var n in e)if(e[n].indexOf(t)>0)return Number(n);return-1},e}();e.WebBrowerUtil=t,__reflect(t.prototype,"qmr.WebBrowerUtil")}(qmr||(qmr={}));